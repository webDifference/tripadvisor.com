require(["ta/rollupAmdShim"],function(a){a.install(["servlets/homerebranded"],["ta","ta","ta","ta","ta","ta","ta/page","ta/page","page-model","ta","ta","ta","ta/page","ta/util/RecordInterruption","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"home_rebranded",files:{"js-amd":{src:{servlets:{homerebranded:1}}}},_:{baseUrl:"/"}})};
define("ta/util/Date",["vanillajs","ns-exporter"],function(e,t){var n={};return n.MS_IN_DAY=864e5,n.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],n.HOUR_CONST=12,n.THAI_BUDDHIST_YEAR_OFFSET=543,n.MAX_STAY_DURATION_DAYS=30,n.MAX_VR_DURATION_DAYS=183,n.MAX_DAYS_BEFORE_RETURN_FLIGHT=330,n.inDateSet=function(e,t){if(null==e||null==t)return!1;for(var n=t.length,r=0;r<n;r++){var a=t[r];if(a.length){var i=a[0].getTime(),u=a[1].getTime();if(i<=e.getTime()&&u>=e.getTime())return!0}else if(e.getTime()==a.getTime())return!0}return!1},n.rangesIntersect=function(e,t){return Math.max(e[0].getTime(),t[0].getTime())<=Math.min(e[1].getTime(),t[1].getTime())},n.getDaysInRange=function(e,t){return Math.round((t.getTime()-e.getTime())/n.MS_IN_DAY)+1},n.getLastDayOfMonth=function(e){var t=new Date;return e&&(t=new Date(e.getTime())),t=new Date(n.normalize(t)),t.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(0),t.getDate()},n.getDaysApart=function(e,t){var n=864e5;return e&&t?Math.round(Math.abs((e.getTime()-t.getTime())/n)):0},n.inSameMonth=function(e,t){return null!=e&&null!=t&&e.getMonth()==t.getMonth()&&e.getYear()==t.getYear()},n.normalize=function(e){return e.setHours(n.HOUR_CONST,0,0,0)},n.create=function(e,t,r){return new Date(e,t,r,n.HOUR_CONST)},t.exportTo(n,"ta.util.date"),n});
define("mixins/page-dates/Base",["vanillajs","ta","mixins/page-dates/Utils","mixins/page-dates/DateTypeStore"],function(e,t,r,n){"use strict";function a(e){return e instanceof Date&&!isNaN(e.getTime())}function i(e){if(!n[e])throw"Invalid date type: "+e}function s(e){var t=[];for(var r in n)n.hasOwnProperty(r)&&n[r].children&&n[r].children.indexOf(e)>=0&&t.push(r);return t}function o(e,t){var a=n[e],i="";if(a.children)for(var s=0,o=a.children.length;s<o;s++){if("_"===t[a.children[s]])return"_";i+=(s>0?"_":"")+r.dateToIso(t[a.children[s]])}else{if("_"===t[e])return"_";i+=r.dateToIso(t[e])}return i}function h(e,t){var r=n[e];if(r.children){for(var a=0,i=r.children.length;a<i;a++)if("_"!==t[r.children[a]])return!1;return!0}return"_"===t[e]}var f=function(e){var s={},f={};!function(){var t,i;if(e)for(i in e)t=r.fromString(e[i]),e.hasOwnProperty(i)&&n[i]&&a(t)&&(s[i]=t)}(),this.hasDates=function(e){if(i(e),n[e].children){for(var r=0,a=n[e].children.length;r<a;r++)if(!t.page.hasDates(n[e].children[r]))return!1;return!0}return!!s[e]&&"_"!==s[e]},this.hasUserSetDates=function(e){return n[e].children?n[e].children.reduce(function(e,t){return e||!!f[t]},!1):!!f[e]},this.getDates=function(e){var t=[];if(i(e),n[e].children)for(var r=0,a=n[e].children.length;r<a;r++)t.push(s[n[e].children[r]]);else t.push(s[e]);for(var r in t)"_"===t[r]&&(t[r]=null);return t},this.setDates=function(e,t){if(i(e),Array.isArray(t)||(t=[t]),t=t.map(function(e){return e instanceof Date?new Date(e.getFullYear(),e.getMonth(),e.getDate()):"_"}),n[e].children){if(n[e].children.length!==t.length)throw"Incorrect number of dates for date type "+e;for(var r=0,a=n[e].children.length;r<a;r++){var o=n[e].children[r];s[o]=t[r],f[o]=!0}}else{if(1!==t.length)throw"Incorrect number of dates for date type "+e;s[e]=t[0]}f[e]=!0},this.clearDates=function(e){if(!e)return void(s={});if(i(e),n[e].children)for(var t=0,r=n[e].children.length;t<r;t++)s[n[e].children[t]]="_";else s[e]="_"},this.datesToQueryString=function(e){var r=n[e];if(i(e),!r.queryString)throw"Cannot generate query-string for DateType "+e;return(t.page.hasDates(e)||h(e,s))&&t.page.hasUserSetDates(e)?r.queryString+"="+o(e,s):""},this.datesToQueryPath=function(e){var r=n[e];if(i(e),!r.pathString)throw"Cannot generate path-string for DateType "+e;return(t.page.hasDates(e)||h(e,s))&&t.page.hasUserSetDates(e)?r.pathString+o(e,s):""},this.datesToQueryJson=function(e){var r=n[e],a={};if(i(e),!r.queryString)throw"Cannot generate query json for DateType "+e;return(t.page.hasDates(e)||h(e,s))&&(t.page.hasUserSetDates(e)||"EATERY"===e)?(a[r.queryString]=o(e,s),a):{}}};return f.prototype.onDatesSelected=function(e,r,n){var a=s(r);if(t.page&&t.page.emit){t.page.emit("dateSelected",e,r,n);for(var i=0,o=a.length;i<o;i++)t.page.hasDates(a[i])&&t.page.emit("dateSelected",e,a[i],t.page.getDates(a[i]))}},f.prototype.usingUnifiedDates=!0,f});
define("overlays/options/repositionOnTaEvent",["vanillajs","ta/Core/TA.Event"],function(n,i){"use strict";return function(n){return function(){var t=this.emit.bind(this,"positionDirty");this.on("show",function(){i.on(n,t)}).on("hide",function(){i.off(n,t)})}}});
define("overlays/options/storeOverlayOnElement",["vanillajs","api-mod"],function(e,t){"use strict";var n=function(){this.sourceElement&&t.store(this.sourceElement,"overlay",this)};return n});
define("overlays/options/closeOnTaEvent",["vanillajs","ta/Core/TA.Event"],function(n,t){"use strict";function o(){this.hide("on-event")}return function(n){return function(){var i=o.bind(this);this.on("show",function(){t.on(n,i)}).on("hide",function(){t.off(n,i)})}}});
define("overlays/options/centerArrowOnSrcElement",["vanillajs","api-mod"],function(t,i){"use strict";var o=function(t){function o(){if(t=t||this.sourceElement,this.container&&t&&this.arrow){var o=i.getCoords(this.container),r=i.getCoords(t),e=i.hasClass(this.container,"arrow_top")||i.hasClass(this.container,"arrow_bottom");if(e){var n=r.left+r.width/2,a=i.getSize(this.arrow).x/2,s=Math.max(a,Math.min(o.width-a,n-o.left));i.setStyle(this.arrow,{"left":s+"px","right":"auto","margin":"0 0 0 -"+a+"px"})}else{var n=r.top+r.height/2,a=i.getSize(this.arrow).y/2,h=Math.max(a,Math.min(o.height-a,n-o.top));i.setStyle(this.arrow,{"top":h+"px","bottom":"auto","margin":"-"+a+"px 0 0 0"})}}}return function(){this.on("show",i.bind(o,this)),this.on("positionDirty",i.bind(o,this))}};return o});
define("overlays/options/moveIntoView",["lib/jquery-amd"],function(t){"use strict";var o=500;return function(e,n){return e="undefined"==typeof e||e,n="undefined"!=typeof n||isNaN(n)?n:0,function(){this.on("show",function(){var i,f,r=t(this.container),s=t(this.sourceElement);e?(i=Math.min(r.offset().top,s.offset().top),f=Math.max(r.offset().top+r.outerHeight(),s.offset().top+s.outerHeight())):(i=r.offset().top,f=r.offset().top+r.outerHeight());var u=window.innerHeight,a=t(window).scrollTop(),h=a+u;if(!(i>=a&&f<=h)){var p,c=f-i;p=c>u||i<a?i-n:f-u+n,t("html, body").animate({scrollTop:p},o)}})}}});
define("ta/util/I18N",["vanillajs","ns-exporter"],function(t,n){var e={};return e.isRtl=function(){return!!document.body.className.match(/\brtl\b/)},n.exportTo(e,"ta.util.i18n"),e});
define("calendars/DesktopStayDates",["vanillajs","api-mod","overlays/Overlay","overlays/styles/modal","overlays/styles/popover","overlays/position","overlays/options/closeOnDocClick","overlays/options/repositionOnEvent","overlays/options/repositionOnTaEvent","overlays/options/storeOverlayOnElement","calendars/CalendarDate","overlays/options/closeOnTaEvent","overlays/options/centerArrowOnSrcElement","overlays/options/moveIntoView","ta/util/I18N","ta/Core/TA.Dust","ta/util/Deferred","ta/util/Date","mixins/page-dates/DateTypeStore","ta/Core/TA.Record"],function(e,t,n,a,r,o,i,d,s,l,c,u,p,h,f,v,m,D,y,w){"use strict";function C(e,t){var n,a=[],r=!1,o=y.isSingleDateType(t.dateType);e.eachDayInMonth(function(e){var n=!r&&0===e.compare(t.today);r=r||n;var i=t.startDate&&0===e.compare(t.startDate);a.push({label:e.day(),date:E(e,t)?null:e.toString(),today:n,start:!o&&i,end:t.endDate&&0===e.compare(t.endDate),selected:o?i:e.inRange(t.startDate,t.endDate)})}),n=e.firstDayOfMonth()-jsGlobalDayOffset,n+=n<0?7:0;for(var i=0;i<n;i++)a.unshift({label:"&nbsp;"});var d=e.year();t.thaiOffset===!0&&(d+=L);var s=ta.i18n?ta.i18n.formatDate("date_medium_month_year",new Date(d,e.month())):jsGlobalMonths[e.month()]+" "+d;return{dayLabels:jsGlobalDaysShort,days:a,header:s}}function T(e){var t=[C(e.currentMonth,e),C(e.currentMonth.nextMonth(),e)];return{incomplete:e.incomplete,months:t,showPrices:e.showPrices,didCreateDefaultDates:e.didCreateDefaultDates,calendarPopupDirection:e.calendarPopupDirection,showClearButton:e.showClearButton,calendarTitle:e.calendarTitle}}function b(e){if(y.isChildDateType(e))for(var t=y.getParents(e),n=0;n<t.length;n++)ta.page.clearDates(t[n]);else ta.page.clearDates(e)}function M(e){var t=new c,n={availableDates:e.availableDates,excludedDates:e.excludedDates,startDate:e.startDate&&new c(e.startDate),endDate:e.endDate&&new c(e.endDate),today:t,thisMonth:t.thisMonth(),incomplete:e.incomplete,dateType:e.dateType,minEnabledDate:e.minEnabledDate||t,maxEnabledDate:e.maxEnabledDate||t.relativeDay(330),maxStayLength:e.maxStayLength||D.MAX_STAY_DURATION_DAYS,thaiOffset:e.thaiOffset,didCreateDefaultDates:e.didCreateDefaultDates,calendarPopupDirection:e.calendarPopupDirection,showClearButton:e.showClearButton||!1,className:e.className||null,calendarTitle:e.calendarTitle||null};return n.currentMonth=g(n),n.minEnabledDate&&y.isMultiCityDateType(n.dateType)&&n.currentMonth.compare(n.minEnabledDate.thisMonth())<0&&(n.currentMonth=n.minEnabledDate.thisMonth()),n}function g(e){var t;if("RETURN"===e.dateType&&e.endDate){var n=e.startDate?e.startDate.thisMonth():e.thisMonth;t=n.compare(e.endDate.previousMonth())<0?e.endDate.previousMonth():n}else e.startDate?t=e.startDate.thisMonth():e.endDate?(t=e.endDate.previousMonth(),e.thisMonth.compare(t)>0&&(t=e.thisMonth)):t=e.thisMonth;return t}function E(e,t){var n=(t.today,t.startDate),a=t.dateType,r=t.minEnabledDate,o=t.maxEnabledDate,i=t.maxStayLength,d=t.availableDates,s=t.excludedDates;if(!P(a)){if(d){for(var l=0;l<d.length;l++)if(0==new c(e.date).compare(new c(d[l])))return!1;return!0}if(s)for(var l=0;l<s.length;l++)if(0==new c(e.date).compare(new c(s[l])))return!0}return!!(r&&r.compare(e)>0)||(!!(P(a)&&n&&n.daysTo(e)>i)||!!(o&&o.compare(e)<0))}function _(e,n,a){var r=2,o=e>0?r:-1,i=n.currentMonth.relativeMonth(o),d=f.isRtl()?"dsdc-scroll-right":"dsdc-scroll-left";i.compare(n.minEnabledDate.thisMonth())<0||i.compare(n.maxEnabledDate.thisMonth())>0||(i.compare(n.today.relativeMonth(12))>0&&!I&&(I=!0,w.trackEventOnPage("DATEPICKER","viewed_year_out")),R=!0,v.renderToString(j,{month:C(i,n)}).then(function(r){var o=t.find(".dsdc-months",a),i=document.createElement("div");i.innerHTML=r,e<0?(t.addClass(o,"dsdc-no-anim"),o.insertBefore(i.firstChild,o.firstChild),t.addClass(o,d),t.forceReflow(o),t.removeClass(o,"dsdc-no-anim")):o.appendChild(i.firstChild),e<0?t.removeClass(o,d):t.addClass(o,d),setTimeout(function(){e<0?o.removeChild(o.lastChild):(t.addClass(o,"dsdc-no-anim"),o.removeChild(o.firstChild),t.removeClass(o,d),t.forceReflow(o),t.removeClass(o,"dsdc-no-anim")),R=!1},F?B:0),n.currentMonth=n.currentMonth.relativeMonth(e),x(n)}))}function x(e,n){e.currentMonth.compare(e.minEnabledDate.thisMonth())<=0?t.addClass(t.find(".dsdc-prev",n),"dsdc-inactive"):t.removeClass(t.find(".dsdc-prev",n),"dsdc-inactive"),e.currentMonth.relativeMonth(1).compare(e.maxEnabledDate.thisMonth())>=0?t.addClass(t.find(".dsdc-next",n),"dsdc-inactive"):t.removeClass(t.find(".dsdc-next",n),"dsdc-inactive")}function S(){document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}function k(e,t,n,a){if(a=a||window.event,a&&a.target&&!R){var r=a.target.className;return r.indexOf("dsdc-next")>=0?_(1,t,n):r.indexOf("dsdc-prev")>=0?_(-1,t,n):a.target.getAttribute("data-date")&&(e.resolve([c.fromString(a.target.getAttribute("data-date")).date]),A&&A.hide()),S(),!1}}function O(e){var t="no_x no_padding date_picker_modal";return t+=" "+(window.isTabletOnFullSite?"tablet":"desktop"),t+=" "+e.dateType,t+=" "+(e.className||"")}function P(e){return y.isChildDateType(e)&&!y.isStartDateType(e)&&!y.isRoundTripDateType(e)}var A,R,N="calendars/desktop_stay-dates/calendar.dust",j="calendars/desktop_stay-dates/month.dust",B=300,F=!!window.TransitionEvent,I=!1,L=543;return{open:function(e,r){A&&A.destroy();var s=m(!0),c=M(r);return v.renderToString(N,T(c)).then(function(r){var p=[a(e,"below",O(c),null,null,r),o.bottomRight(),i,l,d(window,"date_bar_docked"),d(window,"date_bar_undocked"),u("dualSearchTypeaheadOpen")];A=new n(e,p),A.on("hide",function(){s.isFulfilled()||s.reject(),A=null}),A.show(),x(c,A.container),t.addEvent(A.container,"click",k.bind(null,s,c,A.container))}),s.promise()},openInline:function(e,n,a){var r=m(!0),o=M(n),i=a.querySelector(".innerCalendarWrapper");t.destroy(i),i=document.createElement("div"),i.className="innerCalendarWrapper",a.appendChild(i),o.showPrices=!ta.page.hasDates("STAYDATES");var d=function(){i.style.display="none",r.isFulfilled()||r.reject()};return v.renderToString(N,T(o)).then(function(n){i.innerHTML=n,x(o,i),t.addEvent(i,"click",k.bind(null,r,o,i)),t.addEvent(t.find(".update_results_button",i),"click",function(){t.addClass(e,"greenFocus")}),t.addEvent(t.find(".dsdc-close-x",i),"click",d),t.addEvent(t.find(".clearDatesBox",i),"click",function(){b(o.dateType),d()})}),r.promise()},openInContainer:function(e,n,a){var r=m(!0),o=M(n),i=t.getParent(a,"calendarFlyout"),d=t.find(".innerCalendarWrapper",a),s=a.overlay;return t.destroy(d),d=document.createElement("div"),d.className="innerCalendarWrapper",a.appendChild(d),s&&s.on("hide",function(){r.isFulfilled()||r.reject()}),v.renderToString(N,T(o)).then(function(e){d.innerHTML=e,x(o,d),t.addEvent(d,"click",k.bind(null,r,o,d))}),i.deferred=r,r.promise()},closeCalendar:function(){A&&A.destroy()},openAsPopover:function(e,a){function c(e){return"function"==typeof o[e]&&"below"!=e?o[e]([0,0]):o.bottomRight([-16,-8])}function f(e){return e&&e.calendarPopupDirection&&""!=e.calendarPopupDirection?e.calendarPopupDirection:"below"}A&&A.destroy();var D=m(!0),y=M(a);return v.renderToString(N,T(y)).then(function(o){var v=f(y),m=t.find(".trip_search"),w=t.find(".ui_icon.calendar",e);m&&(v="below");var C=c(v),T=[r(e,v,O(y),null,o),C,p(w),i,l,d(window,["resize","date_bar_docked","date_bar_undocked"]),s("showingCookieConsentBanner"),s("makeTextFitResizedText"),u("dualSearchTypeaheadOpen")];a.moveIntoView&&T.push(h(!0,30)),A=new n(e,T),A.on("hide",function(){D.isFulfilled()||D.reject(),A=null}),t.addEvent(t.find(".dsdc-close-x",A.container),"click",function(){A.hide()}),t.addEvent(t.find(".dsdc-wrapper .ui_close_x",A.container),"click",function(){A.hide()}),t.addEvent(t.find(".clearDatesBox",A.container),"click",function(){b(y.dateType),A.hide()}),A.show(),x(y,A.container),t.addEvent(A.container,"click",k.bind(null,D,y,A.container))}),D.promise()}}});
define("mixins/page-dates/Validator",["vanillajs","ta","mixins/page-dates/DateTypeStore","calendars/CalendarDate","ta/util/Date"],function(e,t,a,n,r){"use strict";function i(e){if(!a[e].children||!t.page.hasDates(e))return!0;var n=a[e].children,r=t.page.getDates(e);return a.isStartDateType(n[0])&&a.isEndDateType(n[1])&&r[0]<=r[1]||a.isEndDateType(n[0])&&a.isStartDateType(n[1])&&r[1]<=r[0]}function s(e){if(!a[e].children||!t.page.hasDates(e))return!0;var n=t.page.getDates(e);return n[0].getTime()!==n[1].getTime()}function u(e){return function(n){return!a[n].children||!t.page.hasDates(n)||D.apply(null,t.page.getDates(n))<=e}}function D(e,t){var a=e instanceof n?e:new n(e),r=t instanceof n?t:new n(t);return Math.abs(a.daysTo(r))}var o=function(e){var t=e&&e.hasOwnProperty("maxStayLength")?e.maxStayLength:r.MAX_STAY_DURATION_DAYS;this.VALIDATORS={STAYDATES:[i,s,u(t)],ROUNDTRIP:[i]}};return o.prototype.validate=function(e){var t=this.VALIDATORS[e];return!t||0==t.length||!t.some(function(t){return!t(e)})},o});
define("mixins/page-dates/Desktop",["vanillajs","ta","api-mod","ta/Core/TA.Event","ta/Core/TA.Store","ta/Core/TA.LocalStorage","ta/util/Date","mixins/page-dates/Base","calendars/DesktopStayDates","calendars/CalendarDate","mixins/page-dates/Utils","mixins/page-dates/DateTypeStore","mixins/page-dates/Validator","mixins/page-dates/default-dates"],function(e,a,t,n,r,l,s,i,d,o,p,u,D,g){"use strict";function c(e,t){var n={startDate:u.getStartDate(e),dateType:e,thaiOffset:y,autoSelectDates:x,didCreateDefaultDates:P,calendarPopupDirection:I,showClearButton:M,calendarTitle:Y,popCalendarType:K,qualtricsSurveyEnabled:U,moveIntoView:R,hasMetaMarketingDefaultDates:F},r=u.getMinEnabledDate(e);return u.isHotelDateType(e)||u.isRoundTripDateType(e)?(n.endDate=u.getEndDate(e),n.incomplete=!a.page.hasDates("STAYDATES"),n.maxStayLength=b,r&&(n.minEnabledDate=r),H?n.maxEnabledDate=new o(p.fromString(H)):w&&(n.maxEnabledDate=(new o).relativeDay(parseInt(w))),t&&(n.calendarPopupDirection=t)):(n.incomplete=!a.page.hasDates(e),n.availableDates=_,n.excludedDates=k,n.minEnabledDate=r||N&&new o(p.fromString(N)),n.maxEnabledDate=H&&new o(p.fromString(H))),n}function f(e){var n,r=e.getAttribute("data-dateType"),l=void 0,s=void 0,i=e;if(null==u.getCorrespondingDateType(r))return null;if(n="[data-dateType="+u.getCorrespondingDateType(r)+"]",window&&window.pageServlet&&("HotelHighlight"==window.pageServlet||"SmartDeals"==window.pageServlet)){for(var d=0;d<3&&!s;d++){if(e=e.parentNode,!e)return null;s=e.getAttribute("data-pickerIndex")}var o=document.querySelector("[data-pickerIndex='"+s+"']");return a.find(n,o)}for(var d=0;d<3&&!l;d++){if(e=e.parentNode,!e)return null;l=t.find(n,e)}return null==l&&u.isStartDateType(r)?(i.setAttribute("data-dateType",u.getCorrespondingDateType(r)),i):l}function T(e){u.getParents(e).forEach(function(t){m.validate(t)||u[t].children.filter(function(a){return a!==e}).forEach(function(e){a.page.clearDates(e),a.page.emit("dateSelected",null,e,[null])})})}function C(){if(a.widgets.calendar&&!a.widgets.calendar.isShim){var e=a.page.getDates("CHECKIN")[0],t=a.page.getDates("CHECKOUT")[0];a.page.hasDates("CHECKIN")?a.widgets.calendar.setPageInDate(s.create(e.getFullYear(),e.getMonth(),e.getDate()),!0):a.widgets.calendar.clearPageInDate(!0),a.page.hasDates("CHECKOUT")?a.widgets.calendar.setPageOutDate(s.create(t.getFullYear(),t.getMonth(),t.getDate()),!0):a.widgets.calendar.clearPageOutDate(!0),a.widgets.calendar.syncAllDatePickers()}}function S(e,t,n){if(null!=e){var r=e.getAttribute("data-trackingContext");r||(r=e.getAttribute("data-dateType")),r+=n||!a.page.hasDates(e.getAttribute("data-dateType"))?"|PRE":"|CHANGE",a.trackEventOnPage("DATEPICKER",t,r)}}function E(e,t,n,r){var l="START";if("STAYDATES"!==n&&r&&null!=r[0]){if(("CHECKIN"===n||"CHECKOUT"===n)&&a.page.hasDates("STAYDATES")&&(l="SELECT",t)){var s;s=O?P?"default_dated_to_manually_dated":"manually_dated_to_manually_dated":"undated_to_manually_dated",a.trackEventOnPage("DATEPICKER",s),P=!1,O=!0}S(t,l,e)}}var m,h=!(!(a&&a.widgets&&a.widgets.calendar)||a.widgets.calendar.isShim),v=!1,A=d.openAsPopover,y=!1,w=null,b=s.MAX_STAY_DURATION_DAYS,x=!1,P=!1,I=null,O=!1,_=null,k=null,N=null,H=null,M=!1,Y=null,K="",U=!1,R=!1,F=!1,L=function(e,a){t.mixin(this,new i(e)),m=new D(a),a&&(y=a.thaiOffset||y,v=a.popCheckInFirst||v,b=a.maxStayLength||s.MAX_STAY_DURATION_DAYS,x=a.autoSelectDates,P=a.didCreateDefaultDates,I=a.calendarPopupDirection,_=a.availableDates,k=a.excludedDates,N=a.minEnabledDate,H=a.maxEnabledDate,w=a.maxEnabledDaysOut,M=a.showClearButton||M,Y=a.calendarTitle||Y,K=a.popCalendarType||K,U=a.qualtricsSurveyEnabled||U,R=a.moveIntoView||R,F=a.hasMetaMarketingDefaultDates||F,g.init({datesWereDefaulted:a.didCreateDefaultDates,popFromDefault:a.supportsPrePopWithDefaultDates,popFromUndated:a.supportsPrePopWithNoDates,popCalendarType:a.popCalendarType,qualtricsSurveyEnabled:U,hasMetaMarketingDefaultDates:a.hasMetaMarketingDefaultDates}))};return L.prototype.gatherDates=function(e,l,s,i,o){v&&e&&"CHECKOUT"===e.getAttribute("data-dateType")&&!a.page.hasDates("CHECKIN")&&!a.page.hasDates("CHECKOUT")&&(e.blur(),e=f(e));var p=e?e.getAttribute("data-dateType"):"UNKNOWN",u=E.bind(null,!a.page.hasDates(p));if(!e||!t.hasClass(e,"focused")){t.addClass(e,"focused"),S(e,"OPEN"),a.page.on("dateSelected",u);var D=A;l&&(D=i?d.openInline:d.openInContainer);var g=e?e.getAttribute("data-popup-direction-override"):null;return D.call(null,e,c(p,g),l).then(function(d){r.store("enteredDatesInPreDates",!a.page.hasDates("STAYDATES")),t.removeClass(e,"focused"),t.removeClass(e,"greenFocus"),a.page.pushDates(e,p,d,s),a.page.removeListener("dateSelected",u),a.page.emit("userClickedDate",p);var o=a.page.hasDates("STAYDATES");o&&!s&&n.fireEvent("onCalendarRangeSelect"),i&&o&&l.getElement(".innerCalendarWrapper").hide()},function(){t.removeClass(e,"focused"),t.removeClass(e,"greenFocus"),a.page.removeListener("dateSelected",u),i&&a.page.hasDates("STAYDATES")&&l.getElement(".innerCalendarWrapper").hide(),o&&a.page.hasDates("STAYDATES")&&a.page.onDatesSelected(e,p,a.page.getDates("STAYDATES"),s),a.page.emit("datepickerRejected")})}},L.prototype.gatherDatesNear=function(e){var t=p.findClosestDatepicker(e,"CHECKIN");t&&a.page.gatherDates(t)},L.prototype.pushDates=function(e,t,n,r){a.page.setDates(t,n),T(t),h&&C(),a.page.onDatesSelected(e,t,n,r)},L.prototype.setAvailableDates=function(e){_=e},L.prototype.setMaximumDaysOut=function(e){w=e},L.prototype.setExcludedDates=function(e){k=e},L});
define("ta/popups/SlotSet",["vanillajs","api-mod","ta/util/Error"],function(t,s,o){function i(){this.nW=525,this.nH=460,this.nXI=24,this.nYI=24,this.totalSlots=20,this.slots=[];try{screen.width>1024?(this.nW=800,this.nH=600,this.nXI=80,this.nYI=40):screen.width>800&&(this.nW=620,this.nH=500,this.nXI=60,this.nYI=30)}catch(t){this.error=t,o.record(this.error,"slot set",null,{"slot set":"general"})}this.getOpenSlot=function(t){(!t||t<0||t>this.totalSlots)&&(t=0);var s=function(t){try{var s=!1,i=!1;try{i=this.slots[t].occupied}catch(t){}if(i)try{var r=i.windowObject;r&&!r.closed||(s=!0)}catch(t){s=!0}else s=!0}catch(s){o.record(s,"get open slot - get pop slot",null,{totalSlots:this.totalSlots,slotNumber:t})}if(s){this.slots[t].occupied=null;var l=this.slots[t];return l.slotPos=t,l}return!1}.bind(this);try{var i,r;for(i=t-1;i>=0;i-=1)if(r=s(i))return r;for(i=t;i<this.slots.length;i++)if(r=s(i))return r}catch(t){o.record(t,"get open slot",null,{totalSlots:this.totalSlots})}return!1}}return i});
define("ta/popups/Slot",["vanillajs"],function(i){function t(i,t,n,s){this.x=i,this.y=t,this.w=n,this.h=s,this.occupied=null}return t});
define("ta/popups/PopupSlotSet",["vanillajs","api-mod","ta/util/Error","ta/popups/SlotSet","ta/popups/Slot"],function(t,s,i,n,e){function o(){s.mixin(this,new n),this.nX=500;var t=1160;try{screen.width<1660&&(screen.width>1024&&screen.width<1280?t=960:screen.width<=1024&&(t=740),this.nX=screen.width-t),this.nY=isNaN(window.screenTop)?isNaN(window.screenY)?0:window.screenY:window.screenTop}catch(t){this.error=t,this.nY=0,i.record(this.error,"slot set",null,{"slot set":"popup"})}for(var o=0;o<this.totalSlots;o++)this.slots[o]=new e(this.nX,this.nY,this.nW,this.nH),this.nX=this.nX+this.nXI,this.nY=this.nY+this.nYI}return o});
define("ta/popups/PopunderSlot",["vanillajs","api-mod","ta/popups/Slot"],function(t,i,n){function o(t,o,p,s,h,u,a,e){i.mixin(this,new n(t,o,p,s)),this.tx=h,this.ty=u,this.tw=a,this.th=e}return o});
define("ta/popups/PopunderSlotSet",["vanillajs","api-mod","ta/util/Error","utils/browserutils","ta/popups/PopupSlotSet","ta/popups/PopunderSlot"],function(t,i,s,h,n,e){function o(){i.mixin(this,new n);try{this.nX=window.screenLeft||window.screenX,this.nY=window.screenTop||window.screenY}catch(t){this.error=t,this.nX=200,this.nY=200}this.w=1,this.h=1,this.x=5e3,this.y=5e3,this.totalSlots=4;try{h.ie7&&(this.w=250,this.h=100),(h.safari||h.chrome)&&(this.w=85,this.h=100),"undefined"==typeof this.nX?(this.nX=0,this.nY=0,this.x=this.nX+window.screen.availWidth-this.w,this.y=this.nY+window.screen.availHeight-this.h):(this.x=this.nX+window.getWidth()-this.w,this.y=this.nY+window.getHeight()-this.h),h.ie7?(this.y=this.y-95,this.x=this.x+13):(h.safari||h.chrome)&&(this.y=this.y-16)}catch(t){this.error=t}this.error&&s.record(this.error,"slot set",null,{"slot set":"popunder"});for(var t=0;t<this.totalSlots;t++)this.slots[t]=new e(this.nX,this.nY,this.nW,this.nH,this.x,this.y,this.w,this.h),this.nX=this.nX+this.nXI,this.nY=this.nY+this.nYI}return o});
define("ta/popups/TAPopWindow",["vanillajs","api-mod","ta/util/Error","ta/Core/TA.Store","ta/util/Cookie","utils/browserutils","ta/Core/TA.Record","ta/Browser"],function(t,i,s,o,e,h,n,r){function w(t){this.options={name:"TAWin",url:"",windowHook:!1,customWidth:!1,customHeight:!1,toolbar:1,location:1,directories:1,status:1,menubar:r.isIE9orHigher()?0:1,resizable:1,copyhistory:1,scrollbars:1,alwaysRaised:!1,alwaysLowered:!1,widthOffset:8,heightOffset:164,delayLoad:!1},this.init=function(n,r){var w,l,a;if(i.merge(this.options,r),this.type=n,this.assignSlot(),this.options.customWidth&&(this.width=this.options.customWidth),this.options.customHeight&&(this.height=this.options.customHeight),null!=this.options.widthOffset&&(this.widthOffset=this.options.widthOffset),null!=this.options.heightOffset&&(this.heightOffset=this.options.heightOffset),this.options.delayLoad&&(this.delayLoad=this.options.delayLoad),this.options.windowHook)return this.windowObject=this.options.windowHook,o.has("checkrates.add_holding_windows")||this.windowObject.refresh(),!0;o.has("checkrates.chrome_dates_entry_holding")&&(this.options.scrollbars=0),this.url=this.options.url,this.assignWinArgs();try{if(this.type==t.windowType.HOLDING&&e.setPIDCookie(28962),h.chrome&&this.options.inTab){var d=Math.random().toString(36).substring(7);return this.options.popunder?(w=document.createElement("a"),w.href=this.url,w.target=d,document.body.appendChild(w),l=document.createEvent("MouseEvents"),l.initMouseEvent("click",!1,!0,window,0,0,0,0,0,!0,!1,!1,!0,0,null),w.dispatchEvent(l),w.parentNode.removeChild(w),void(this.windowObject=window.open(this.url,d))):void(this.windowObject=window.open(this.url,d))}var p=h.chrome&&h.version>31;if(p)this.windowObject=window.open("","_blank");else if(this.options.popunder)if(h.ie8||h.ie9||h.ie10||h.ie11)this.windowObject=window.open("pages/blank.html","_blank",this.winArgs),window.document.focus();else if(h.safari&&"ios"!==h.Platform.name){if(this.windowObject=window.open("","_blank",this.winArgs),this.windowObject){var c=window.open("","_blank");c.close()}window.focus()}else h.firefox?(this.windowObject=window.open("","_blank",this.winArgs),window.open("","_self",""),window.focus()):this.windowObject=window.open("","_blank",this.winArgs);else this.windowObject=window.open("","_blank",this.winArgs);a=this.windowObject,a&&this.isTAWindow()?(this.type==t.windowType.CHECK_RATE&&t.pollForPartnerLoad(a,new Date,this.options.name,t.extractSlotFromCommerceUrl(this.options.url)),this.delayLoad||t.redirectToUrl(this.windowObject,this.url)):!a&&h.ie&&this.type===t.windowType.CHECK_RATE&&this.url&&o.has("ta.ie_commerce_popup_block_fix")&&(e.setPIDCookie(38822),window.location=this.url)}catch(t){this.errorOpening=t,s.record(this.errorOpening,"pop window opening failure",null,{type:this.type,url:this.url})}try{a=this.windowObject,a&&this.isTAWindow()&&this.type==t.windowType.HOLDING&&this.moveBehindMain(a)}catch(t){this.errorMoving=t,s.record(this.errorMoving,"popunder window moving",null,{type:this.type,url:this.url})}},this.repurpose=function(i,o,e){if(this.type==t.windowType.HOLDING){this.type=t.windowType.CHECK_RATE,this.slot.occupied=!1,this.assignSlot(),this.url=i,o&&(this.width=o,this.options.widthOffset=0),e&&(this.height=e,this.options.heightOffset=0);var h=this.windowObject;if(h&&this.isTAWindow())try{this.options.inTab||(h.moveTo(0,0),h.resizeTo(this.width+this.options.widthOffset,this.height+this.options.heightOffset),h.moveTo(this.x,this.y)),this.delayLoad||this.options.keepFocus||h.focus(),this.delayLoad||(h.location=this.url)}catch(t){s.record(this.errorMoving,"repurpose popunder fail",null,{type:this.type,url:this.url})}return this}return!1},this.assignWinArgs=function(){this.winArgs="toolbar="+this.options.toolbar,this.winArgs+=",location="+this.options.location,this.winArgs+=",directories="+this.options.directories,this.winArgs+=",status="+this.options.status,this.winArgs+=",menubar="+this.options.menubar,this.winArgs+=",resizable="+this.options.resizable,this.winArgs+=",copyhistory="+this.options.copyhistory,this.winArgs+=",scrollbars="+this.options.scrollbars,this.winArgs+=",width="+this.width,this.winArgs+=",height="+this.height,this.winArgs+=",left="+this.x,this.winArgs+=",top="+this.y,this.winArgs+=",screenx="+this.x,this.winArgs+=",screeny="+this.y,this.options.alwaysRaised&&(this.winArgs+=",alwaysRaised"),this.options.alwaysLowered&&(this.winArgs+=",alwaysLowered")},this.assignSlot=function(){this.type==t.windowType.HOLDING?(this.slot=t.getPopunderSlots().getOpenSlot(),this.width=this.slot.tw,this.height=this.slot.th,this.x=this.slot.tx,this.y=this.slot.ty):(this.slot=t.getPopupSlots().getOpenSlot(),this.width=this.slot.w+this.options.widthOffset,this.height=this.slot.h+this.options.heightOffset,this.x=this.slot.x,this.y=this.slot.y),this.slot.occupied=this},this.moveBehindMain=function(e){if(o.has("checkrates.cr_popunder_by_shift_ctrl")&&h.version>23)t.openCloseTab();else if(o.has("checkrates.chrome_dates_entry_holding"))try{var r=window.open("about:blank");r&&(r.focus(),r.close())}catch(t){s.record(t,"holdingWindow - Chrome blur failed")}e.blur(),e.opener=self,e.moveTo(this.slot.x,this.slot.y),e.resizeTo(this.slot.w,this.slot.h),this.delayLoad||(e.location=this.url),window.focus(),i.hasClass(document.activeElement,"globalNav2011_reset")||n.trackEventOnPage("checkrates","no_focus_on_main",h.version,1)},this.isTAWindow=function(){var t=!0;try{var i=this.windowObject.location;this.windowObject.status="",null!==i&&""!==i||(t=!1)}catch(i){t=!1}return t}}return w});
define("ta/util/redirectToUrl",["ta/Core/TA.Store","common/trackingStreams"],function(t,e){return function(i,o){if(i){if(t.retrieve("commerce_history_injection.enabled")&&i.history&&i.history.pushState)try{i.history.pushState({fromBackClick:!0},"",window.location.href),e.trackEvent("COMMERCE_HISTORY_INJECT","history_injected","")}catch(t){e.error(t,"commerce history injection failed",null,null,"WARN")}i.location=o}else window.location=o}});
define("ta/popups/PollForPartnerLoad",["common/trackingStreams"],function(t){var e=function(n,E,r,a,o){n&&setTimeout(function(){var C=null,c=(new Date).getTime()-E.getTime();try{C=n.document}catch(t){}C?c>2e4?t.trackEvent("COMMERCE_CLICK","PROVIDER_TIMEOUT",r||"",c):n.closed?t.trackEvent("COMMERCE_CLICK","PROVIDER_CLOSED",r||"",c):e(n,E,r,a,o):t.trackEvent("COMMERCE_CLICK","PROVIDER_LOADED",(o||window.pageServlet||"")+"|"+(a||"")+"|"+(r||""),c)},100)};return e});
define("ta/popups/BeforePopTargetBlankIE",["ta/Browser","ta/util/Cookie"],function(e,t){return function(o){var n;return!o||!o.href||"_blank"!==o.target||(e.isIE10Metro()||(n=e.isIE9orHigher()?window.open(o.href,"_blank"):window.open(url,"_blank","location=yes,resizable=yes,menubar=yes,scrollbars=yes,toolbar=yes,width="+document.documentElement.clientWidth+",height="+document.documentElement.clientHeight)),!(n&&!n.closed&&"undefined"!=typeof n.closed)&&(o.target="",t.setPIDCookie(38821),!0))}});
define("ta/popups/PopUtil",["vanillajs","ns-exporter","utils/browserutils","ta/util/Cookie","ta/util/Error","ta/Core/TA.Record","ta/Browser","ta/Core/TA.Store","ta/popups/PopupSlotSet","ta/popups/PopunderSlotSet","ta/popups/TAPopWindow","ta/util/openNewTab","ta/util/redirectToUrl","ta/popups/PollForPartnerLoad","ta/popups/CookieSettingsPanel","ta/popups/BeforePopTargetBlankIE"],function(e,n,t,o,r,i,d,a,c,u,l,s,p,w,h,f){function m(e,n){n=n||{};var t=new l(y);if(t.init(e,n),!t.errorOpening&&!t.errorMoving&&t.windowObject)try{return a.has("checkrates.add_holding_windows")&&n.windowHook&&n.windowHook.location&&n.windowHook.location.href.test(/RuleBasedPopunder/)?g.unshift(t):g.push(t),n.windowHook||e!=y.windowType.HOLDING||this.trackPopunder(n.url,y.numPopundersCheck()),t}catch(e){r.record(e,"Window Popup - could not register new window")}return!1}var g=[],v=null,k=null,P=2,y={windowType:{CHECK_RATE:0,PROV_WIN:1,HOLDING:2,COMMERCE:3,VFM:4,COOKIE:5},maxPopunders:4,tryHoldingWindows:function(e,n){try{for(var t=!0,o=0;o<n;o++){var i=this.launchHoldingWindow(e);i.windowObject||(t=!1)}if(t)return!0}catch(e){r.record(e,"try two hw")}return!1},getPopunderSlots:function(){return null===v&&(v=new u),v},getPopupSlots:function(){return null===k&&(k=new c),k},createCheckRatesWindow:function(e){return m(this.windowType.CHECK_RATE,e)},createHoldingWindow:function(e){return m(this.windowType.HOLDING,e)},createVFMWindow:function(e){return m(this.windowType.VFM,e)},getHoldingWindowSet:function(){for(var e=[],n=0;n<g.length;n++){var t=g[n];if(t&&t.type==this.windowType.HOLDING){var r=t.windowObject;if(r&&"closed"in r)if(r.closed){if(a.has("checkrates.add_holding_windows")&&r.closed){var i=window.cookieDomain;i&&o.write("CommercePopunder","SuppressAll",0,i)}}else e[e.length]=t}}return e},attemptHoldingWindowWNumChecked:function(){},openCloseTab:function(){var e,n;if(a.has("popunder.popunder_by_self_closing_tab"))try{n=document.createElement("a"),n.href="http://"+window.location.hostname+"/vpages/tab.html",document.body.appendChild(n),e=document.createEvent("MouseEvents"),e.initMouseEvent("click",!1,!0,window,0,0,0,0,0,!0,!1,!1,!0,0,null),n.dispatchEvent(e),n.parentNode.removeChild(n)}catch(e){r.record(e,"self-closing tab blur method failed")}else if(a.has("checkrates.cr_popunder_by_shift_ctrl")&&t.version>23)try{n=document.createElement("a"),n.href="about:blank",n.target="popunderwindowhelper",document.body.appendChild(n),e=document.createEvent("MouseEvents");var o=!0,i=!0;e.initMouseEvent("click",o,i,window,0,0,0,0,0,!0,!1,!1,!0,0,null),n.dispatchEvent(e),n.parentNode.removeChild(n),window.open("about:blank","popunderwindowhelper").close()}catch(e){r.record(e,"shift-ctrl blur method failed")}},attemptHoldingWindow:function(e){if(!this.useShiftClick())if(a.has("checkrates.add_holding_windows")){var n=this.numPopundersCheck();n<this.maxPopunders&&this.launchHoldingWindow(e)}else P>this.getHoldingWindowSet().length&&this.launchHoldingWindow(e)},launchHoldingWindow:function(e){if(!e)return!1;var n=a.retrieve("checkrates.holdingWindowURI");if(n){a.store("checkrates.HWtracking","date");var t={url:n};return this.createHoldingWindow(t)}return!1},launchAddHoldingWindow:function(e,n){var t=n||{};return t.url=e,this.createHoldingWindow(t)},popunderReminder:function(e){var n={windowHook:e};this.createHoldingWindow(n)},numPopundersCheck:function(){try{var e=this.getHoldingWindowSet(),n=0,t=o.readRaw("CommercePopunder"),i=t?t.match(/\d+/):null;return n=t&&i?Math.max(e.length,parseInt(i[0],10)):e.length}catch(e){r.record(e,"CommercePopunder - numPopundersCheck")}},trackPopunder:function(e,n){try{if(!n||!e)return;var t="CommerceEnhancedPopunder";if(e.match(/AlsoViewedLB/))t="AlsoViewedLB";else{var o=e.match(/RuleBasedPopunder\?Rule=\d+/);if(o){var d=o[0].match(/\d+/);t="RuleBasedPopunder_"+d[0]}}var c="OpenWindow",u=a.retrieve("checkrates.HWtracking");u&&(c="OpenWindow_"+u,a.remove("checkrates.HWtracking")),i.trackEventOnPage("CommercePopunder",c,t,n,!0)}catch(e){r.record(e,"CommercePopunder - trackPopunder")}},getProviderWindowDims:function(e,n){var o=null,r=null,i=null,d=null;return"hotels.com"==e&&(o=975),screen.width>=1280&&(o=1e3,r=897,n||(i=0,d=0,t.chrome?r-=50:t.firefox?r-=87:t.ie&&(o-=12,r-=179))),{customWidth:o,customHeight:r,widthOffset:i,heightOffset:d}},useShiftClick:function(){return!1},expandSidebarWindow:function(e,n,t){i.trackEventOnPage("traffic_acquisition_sidebar","any",n,1),"true"==t&&(window.moveTo(0,0),window.resizeTo(screen.width,screen.height)),document.getElementById("SliderHolder").style.display="none",document.getElementById("PAGE").style.marginLeft="0px"},cookieSettingsPanel:function(e){return h(e)},newWindowFromExitPop:function(e,n){var t=window.open(n,"_blank","height="+screen.height+",width="+screen.width+",toolbar=yes,menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes");window.focus&&t.focus()},pollForPartnerLoad:function(e,n,t,o,r){return w(e,n,t,o,r)},extractSlotFromCommerceUrl:function(e){if(!e)return 0;var n=e.match("[&|\\?]slot=([^&]*)");return n?n[1]:0},redirectToUrl:function(e,n){return p(e,n)},beforePopTargetBlankIE:function(e){return f(e)},attemptOpenUrlNewTab:function(e){return s(e)}};return n.exportTo(y,"ta.popups.PopUtil"),y});
/*
 * hoverIntent v1.8.1 // 2014.08.11 // jQuery v1.9.1+
 * http://briancherne.github.io/jquery-hoverIntent/
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
define("lib/jquery/jquery.hoverIntent",["lib/jquery-amd"],function(d){var h={interval:100,sensitivity:6,timeout:0};var i=0;var g,f;var b=function(j){g=j.pageX;f=j.pageY};var a=function(m,k,l,j){if(Math.sqrt((l.pX-g)*(l.pX-g)+(l.pY-f)*(l.pY-f))<j.sensitivity){k.off(l.event,b);delete l.timeoutId;l.isActive=true;m.pageX=g;m.pageY=f;delete l.pX;delete l.pY;return j.over.apply(k[0],[m])}else{l.pX=g;l.pY=f;l.timeoutId=setTimeout(function(){a(m,k,l,j)},j.interval)}};var e=function(m,k,l,j){delete k.data("hoverIntent")[l.id];return j.apply(k[0],[m])};return function c(n,o,j){var m=i++;var l=d.extend({},h);if(d.isPlainObject(n)){l=d.extend(l,n);if(!d.isFunction(l.out)){l.out=l.over}}else{if(d.isFunction(o)){l=d.extend(l,{over:n,out:o,selector:j})}else{l=d.extend(l,{over:n,out:n,selector:o})}}var k=function(u){var s=d.extend({},u);var q=d(this);var p=q.data("hoverIntent");if(!p){q.data("hoverIntent",(p={}))}var t=p[m];if(!t){p[m]=t={id:m}}if(t.timeoutId){t.timeoutId=clearTimeout(t.timeoutId)}var r=t.event="mousemove.hoverIntent.hoverIntent"+m;if(u.type==="mouseenter"){if(t.isActive){return}t.pX=s.pageX;t.pY=s.pageY;q.off(r,b).on(r,b);t.timeoutId=setTimeout(function(){a(s,q,t,l)},l.interval)}else{if(!t.isActive){return}q.off(r,b);t.timeoutId=setTimeout(function(){e(s,q,t,l.out)},l.timeout)}};return this.on({"mouseenter.hoverIntent":k,"mouseleave.hoverIntent":k},l.selector)}});
define("ta/util/Element",["lib/jquery-amd","utils/ajax","ta/Core/TA.Record","ns-exporter","ta/Core/TA.Event","lib/jquery/jquery.hoverIntent","utils/throttle"],function(t,e,i,n,o,r,a){function l(e,i){var n=e.style.fontSize||t(e).css("font-size"),o=n.replace(/[\d\.]/g,""),r=c(o,parseFloat(n)*i);e.style.fontSize=r+o}function s(){function e(e,i){var r=n[e],a=t(r.e);if(a.length>0){var l=r.inView;r.inView=!1,a.each(function(){return!r.inView&&void(r.inView=o.inViewport(this,i,r.persistentElmt,r.offset))}),!l&&r.inView&&(r.cb&&r.cb(r.e),r.multiple||n.splice(e,1))}}function i(){var e=t(window),i={};return i.top=e.scrollTop(),i.left=e.scrollLeft(),i.bottom=i.top+e.height(),i.right=i.left+e.width(),i}var n=[],o=this;this.add=function(i){n.push(i),e(n.length-1),n.length>0&&t(window).on("resize scroll",r)},this.inViewport=function(e,n,o,r){if(e=t(e),!e.is(":visible"))return!1;if(r=t.extend({top:0,left:0,right:0,bottom:0},r),o){var a=o.offsetHeight;a&&(0==o.offsetTop?r.bottom-=a:r.top+=a)}var l=e.offset();return n||(n=i()),n.bottom>=Math.max(l.top+r.top,0)&&n.right>=Math.max(l.left+r.left,0)&&n.top<=Math.max(l.top+e.height()+r.bottom,0)&&n.left<=Math.max(l.left+e.width()+r.right,0)};var r=a(function(){if(n.length){for(var o=i(),a=n.length-1;a>=0;a--)e(a,o);0==n.length&&t(window).off("resize scroll",r)}},300);t(window).on("load",r)}var f={};f.replaceContent=function(i,n,o,r){if(n=t(n),!n.find(".progresstab")){var a=o+(o.indexOf("?")==-1?"?":"&")+"xhr=true";n.append('<div class="progresstab"></div>'),e({url:a,success:function(t){n.html(t),window.behavior&&window.behavior.apply(n),r&&r(n.get(0))},evalScripts:!0}).get()}},f.spinner=function(e,i){t(i).parents(".spinnerReplaceable").children().each(function(t,e){e.toggle(e.hasClass("spinner"))})},f.limitLength=function(t,e,i){return!(e.value.length>=i)||(e.value=e.value.substr(0,i),!1)},f.updateValue=function(e,i){if(e=t(e),e.length>0&&e.val()!=i){e.val(i);var n=document.createEvent("HTMLEvents");n.initEvent("change",!1,!1),e[0].dispatchEvent(n)}},f.keepInWindow=function(e,i){function n(t,e){var i=parseInt(t.get(0).style[e]);return i||0===i}if(e){e=t(e),i||(i={top:!0,right:!0,bottom:!0,left:!0});var o=2,r=e.offset();r.right=r.left+e.width(),r.bottom=r.top+e.height();var a=t(window),l=a.width(),s=a.height(),f=a.scrollTop(),c=a.scrollLeft();i.right&&n(e,"right")?r.left<c+o?e.css("right",l+c-e.width()-o):r.right>l-c-o&&e.css("right",o):i.left&&n(e,"left")&&(r.left<c+o?e.css("left",o):r.right>l-c-o&&e.setStyle("left",l+c-r.width-o)),i.bottom&&n(e,"bottom")?r.top<f+o?e.setStyle("bottom",s+f-r.height-o):r.bottom>s-f-o&&e.setStyle("bottom",o):i.top&&n(e,"top")&&(r.top<f+o?e.setStyle("top",o):r.bottom>s-f-o&&e.setStyle("top",s+f-r.height-o))}};var c=function(t,e){var i=e;return"px"==t?i=8:"em"==t?i=.5:"pt"==t?i=6:"%"==t&&(i=50),Math.max(e,i)};f.makeTextFit=function(e,i,n,r,a){a=a||1,r=r||8;var l=!1;if(t(e).each(function(e,o){o=t(o);var a=o.find(i);if(a){var s;if("number"==typeof n)s=n;else if(s=o.find(n).outerHeight(),void 0===s)return;var f=a.height();if(s<f){var c=a.css("font-size");if(c){var u=function(t,e){return"px"==e&&t>=r||"em"==e&&t>=.5||"pt"==e&&t>6||"%"==e&&t>=50},h=c.replace(/[\d\.]/g,""),d=parseFloat(c)*Math.sqrt(s/f);"px"==h&&(d=Math.max(parseInt(d),r)),u(d,h)&&(a.css("font-size",d+h),l=!0)}}}}),l>0&&a<4){o.fireEvent("makeTextFitResizedText");var s=this;setTimeout(function(){s.makeTextFit(e,i,n,r,a+1)},1)}},function(){function e(t){var e=!1;if(!t||t.clientWidth&&t.clientWidth<=0)return!1;for(var i=t.clientWidth,n=(parseFloat(t.style.paddingLeft)||0)+(parseFloat(t.style.paddingRight)||0),o=0;o<a&&t.scrollWidth>i;o++){var r=(i-n)/(t.scrollWidth-n);l(t,r),e=!0}return t.scrollWidth>i&&(l(t,s),e=!0),e}function i(t,e){var i=t.getAttribute("data-sizegroup"),n=parseFloat(t.style.fontSize);i&&(e[i]=Math.min(e[i]||Number.MAX_VALUE,n))}function n(t){for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],o=[];n.forEach(function(t){o.push([t.scrollWidth,t])}),o.sort(function(t,e){return e[0]-t[0]});for(var r=0;r<o.length&&e(o[r][1]);r++);}}function r(t){var i;for(var n in t)t.hasOwnProperty(n)&&(i={},t[n].forEach(function(t){var n=t.innerHTML,o=i[n];void 0!==o?0!=o&&(t.style.fontSize=o):e(t)?i[n]=t.style.fontSize||0:i[n]=0}))}var a=4,s=.9;f.makeTextFitOneLine=function(i,n){var o=t(i);if(o.each(function(t,i){e(i)}),n){var r;o.each(function(e,i){var n=t(i).css("font-size");(!r||parseFloat(n)<parseFloat(r))&&(r=n)}),r&&o.css("font-size",r)}},f.autoResizeTextInNode=function(o){o=t(o);var a=t(".autoResize",o),l={},s={width:{},text:{}};a.filter(":visible").removeClass("autoResize").each(function(t,n){var o,r,a=n.getAttribute("data-resizeWidthGroup"),f=n.getAttribute("data-resizeTextGroup");a?(o=s.width,r=a):f&&(o=s.text,r=f),o?(o[r]||(o[r]=[]),o[r].push(n)):(e(n),i(n,l))}),n(s.width),r(s.text),a.each(function(t,e){var i=e.getAttribute("data-sizegroup");i&&(e.style.fontSize=l[i]+"px")})},o.on("refreshedDOMContent",function(t){f.autoResizeTextInNode(t)}),o.queueForLoad(function(){document.body&&f.autoResizeTextInNode(document.body)},"autoResize all targets on load")}(),f.makeSameWidth=function(e){var i=0;t(e).each(function(t,e){var n=Math.round(parseFloat(e.style.width));n&&n>i&&(i=n)}).css("width",i)},f.fitToContentsHorizontally=function(e,i,n,o){if(o=o||1,!(o<=0||i>n)){var r=function(t){return t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight};t(e).each(function(t,e){e.style.width=i;for(var a=i;a<n&&r(e);a+=o)e.style.width=a;r(e)&&(e.style.width=n)})}},f.scrollIntoView=function(e,i,n,o){if(e){e=t(e);var r=e.offset().top+(i||0);if(n){for(var a=t("html, body"),l=e.parent();l.length&&!l.is(a)&&"auto"!=l.css("overflow");)l=l.parent();!l.length||l.is(a)||"auto"!=l.css("overflow")?l=a:r=l.offset().top+l.scrollTop()+(i||0),l.animate({scrollTop:r},{duration:300,complete:function(){o&&o()}})}else window.scrollTo(0,r),o&&o()}};var u=f.scrollTrackers=new s;return f.isScrolledIntoView=function(t,e,i){return u.inViewport(t,null,e,i)},f.doIfElementIsVisible=function(t,e,i,n){t&&u.add({e:t,cb:function(){return e.apply(null,i),!0},offset:n})},f.trackWhenScrolledIntoView=function(t,e,n){if(t&&e){var o=function(){i.trackEventOnPage.apply(i,e)};u.add({e:t,cb:o,multiple:n})}},f.getTotalWidth=function(e){return t(e).outerWidth(!0)||0},f.getTotalHeight=function(e){return t(e).outerHeight(!0)||0},f.hoverIntent=function(e,i){r.bind(t(e),i)()},n.exportTo(f,"ta.util.element"),f});
define("mixins/page-guests/Guests",["vanillajs","ta/Core/TA.FireEvent"],function(t,r){"use strict";function s(t){this.guests=new o(t)}var e=4,n={adults:2,rooms:1,child_rm_ages:""},o=function(t){function s(t,r){var s=!1,e=!1;for(var n in t)t.hasOwnProperty(n)&&n in a&&a[n]!=t[n]&&(a[n]=t[n],o(n)&&(e=!0),s=!0);return s&&!r&&setTimeout(d,1),s}function o(t){if("adults"==t){if(i())return a.rooms=Math.ceil(a.adults/e),!0;if(u())return a.rooms=a.adults,!0}else if("rooms"==t){if(i())return a.adults=a.rooms*e,!0;if(u())return a.adults=a.rooms,!0}return!1}function i(){return a.adults/Math.max(a.rooms,1)>e}function u(){return a.adults<a.rooms}t=t||{};var a={rooms:t.rooms||n.rooms,adults:t.adults||n.adults,child_rm_ages:t.child_rm_ages||n.child_rm_ages};this.getRooms=function(){return a.rooms},this.getAdults=function(){return a.adults},this.getChildRoomAges=function(){return a.child_rm_ages},this.set=function(t){return s(t)},this.clear=function(){return s(n)},this.toJson=function(){var t={};for(var r in a)t[r]=a[r];return t},this.toQueryJson=function(){var t=[a.rooms,a.adults];return a.child_rm_ages&&t.push(a.child_rm_ages),{uguests:t.join("_")}};var d=function(t){window.ta&&ta.page&&ta.page.emit&&ta.page.emit("guestsSelected",this.toJson(),t)}.bind(this);r.on("onLegacyGuestsChanged",function(t){if(t){var r={rooms:t.rooms,adults:t.guests,child_rm_ages:t.child_rm_ages};s(r,!0)&&d(!0)}});var c=!1;r.on("receivedGuestData",function(t){var r={};for(var e in{adults:1,rooms:1,child_rm_ages:1}){var n=t.getAttribute("data-"+e);n&&(r[e]=n)}!s(r,!0)&&c||d(!0),c=!0})};return s});
define("overlays/options/closeOnSourceClick",["vanillajs","api-mod"],function(t,e){"use strict";function n(t){e.containsElement(this.sourceElement,t.target)&&this.hide("source-click")}function i(t){return function(){var i=n.bind(this),o=function(t){setTimeout(t.bind(this),1)}.bind(this);this.on("show",o.bind(void 0,function(){e.addEvent(this.sourceElement,"click",i),t&&e.addEvent(this.sourceElement,"touchstart",i)})).on("hide",o.bind(void 0,function(){e.removeEvent(this.sourceElement,"click",i),t&&e.removeEvent(this.sourceElement,"touchstart",i)}))}}var o=i(!0);return o.withoutTouchEvents=i(!1),o});
define("overlays/options/closeOnChildClick",["vanillajs","api-mod"],function(t,n){"use strict";function i(t){n.containsElement(this.container,t.target)&&this.hide("child-click")}function e(t){return function(){var e=n.bind(i,this);this.on("show",function(){n.addEvent(this.domParent,"click",e),t&&n.addEvent(this.domParent,"touchstart",e)}).on("hide",function(){n.removeEvent(this.domParent,"click",e),t&&n.removeEvent(this.domParent,"touchstart",e)})}}var o=e(!0);return o.withoutTouchEvents=e(!1),o});
define("overlays/options/minWidth",["vanillajs"],function(i){"use strict";var n=function(i){function n(){this.container.style.minWidth=i+"px",this.emit("positionDirty")}return function(){this.on("show",n.bind(this))}};return n});
define("overlays/options/keepInDom",["vanillajs","api-mod"],function(i,n){var t="";return function(){this.show=function(){return n.inDocument(this.container)?(this.container.style.display=t,n.removeClass(this.container,"hidden")):this.domParent.appendChild(this.container),this.emit("show"),this},this.hide=function(i){return n.inDocument(this.container)&&"none"!=this.container.style.display&&("none"!=this.container.style.display&&(t=this.container.style.display||"",this.container.style.display="none"),n.hasClass(this.container,"hidden")||n.addClass(this.container,"hidden"),this.emit("hide",{trigger:i})),this}}});
define("forms/select",["vanillajs","api-mod","overlays/Overlay","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnSourceClick","overlays/options/closeOnChildClick","overlays/options/repositionOnEvent","overlays/options/minWidth","overlays/options/keepInDom","overlays/styles/dropdown","mixins/Events"],function(e,n,t,i,o,s,c,l,a,r,u,d){function h(){function e(){n.removeClass(p,"open"),C.emit("close")}function h(){E.show(),n.addClass(p,"open"),C.emit("open")}function v(e,t,i){if(e){if(y!=e){k.innerHTML=e.innerHTML;var o=e.getAttribute("data-value");w&&(w.value=o),y&&n.removeClass(y,"ui_icon checkmark"),n.addClass(e,"ui_icon checkmark"),y=e,C.emit("change",o,e.innerHTML,i)}}else y&&(n.removeClass(y,"ui_icon checkmark"),y=null);return t&&E.hide(),!!e}function f(e){v(this,!0)}var p,m,k,w,y,E,C=this;n.mixin(this,new d("open","close","change")),this.init=function(d,h){return m=n.find(".options",d),y=n.find(".option.ui_icon.checkmark",m),E=new t(d,u(d,"below",[],m),i.below([0,-d.offsetHeight]),a(d.offsetWidth),o.withoutTouchEvents,c.withoutTouchEvents,s.withoutTouchEvents,l(window,"resize"),l(window,"scroll"),r),n.removeClass(m,"hidden"),E.on("hide",e),d.onclick=function(){},n.select(".option",m).forEach(function(e){n.addEvent(e,"click",f)}),this.attach(d,!h),this.init=function(){},this},this.attach=function(e,t){p!==e&&(p&&n.removeEvent(k,"click",h),p=e,k=n.find(".closed_text,.select-label",p),w=n.find(p.getAttribute("data-input"),p),E.sourceElement=p,n.addEvent(k,"click",h),t&&h())},this.destroy=function(){E&&(n.select(".option",m).forEach(function(e){n.removeEvent(e,"click",f)}),n.removeEvent(k,"click",h),E.destroy(),E=null)},this.revealValue=function(e){n.removeClass(n.find('.option[data-value="'+e+'"]',m),"hidden")},this.selectValue=function(e){return v(n.find('.option[data-value="'+e+'"]',m),!1,!0)},this.selectValueAndClose=function(e){return v(n.find('.option[data-value="'+e+'"]',m),!0,!0)},this.getValue=function(){return y?y.getAttribute("data-value"):""}}return{Select:h}});
define("mixins/page-guests/GuestsSelector",["vanillajs","ta","forms/select"],function(t,e,n){"use strict";function s(t,s,i){function a(e,n){if(!f){var i={};i[t]=parseInt(e,10),c.set(i)&&s()}}function u(e,n){o&&(f=n,o.selectValue(e[t]),f=!1,n&&i&&i(e))}var o,f;this.init=function(t){t&&(e.page.off("guestsSelected",u).on("guestsSelected",u),o||(o=new n.Select,o.on("change",a),o.init(t,!0)))},this.attach=function(t){o.attach(t)}}function i(t){c=t,this.GuestsSelector=s}var c;return i});
define("ta/util/LegacyDateShim",["vanillajs","api-mod","ns-exporter","ta/util/Error","ta/Core/TA.Event","utils/ajax","ta/Core/TA.Store","ta/util/Date"],function(e,t,a,r,n,s,o,l){function i(){return ta.page&&ta.page.hasDates&&ta.page.hasDates("STAYDATES")}function u(e){var t=ta.page.datesToQueryJson(e||"STAYDATES");if(o.has("guests_rooms_picker.enabled")){var a=ta.page.guests.toJson();for(var r in a)t[r]=a[r]}else t.adults=D();return t}function d(){var e=ta.page.guests.toJson();return e.guests=e.adults,delete e.adults,e}function c(){return ta.page&&ta.page.getDates&&ta.page.getDates("CHECKIN")[0]||void 0}function g(){return ta.page&&ta.page.getDates&&ta.page.getDates("CHECKOUT")[0]||void 0}function p(){if(!i())return!1;var e=ta.widgets.calendar.getPageInDate(),t=ta.widgets.calendar.getPageOutDate(),a=Math.round(Math.abs((e.getTime()-t.getTime())/l.MS_IN_DAY));return a>=1&&a<=l.MAX_STAY_DURATION_DAYS}function D(){var e=2;return ta.page.guests?e=ta.page.guests.getAdults():o.has("multiDP.adultsCount")&&(e=o.retrieve("multiDP.adultsCount"),o.store("date.picker.adultsCount",e)),e}function f(e){return"classic"===e&&"undefined"!=typeof DATE_PICKER_CLASSIC_FORMAT?DATE_PICKER_CLASSIC_FORMAT:"short"===e&&"undefined"!=typeof DATE_PICKER_SHORT_FORMAT?DATE_PICKER_SHORT_FORMAT:"undefined"!=typeof DATE_PICKER_META_FORMAT?DATE_PICKER_META_FORMAT:("string"!=typeof e&&(e="not_a_string"),"")}function v(){var e="no dates";try{var t=f("classic");i()&&(e=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),t),e=e+" - "+ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageOutDate(),t))}catch(e){}return e}function h(e,t){var a,r,n,s,i,u,d,c,g;return e&&e.getDate&&t?t==f("classic")?(a=new Date(e),o.retrieve("thai_buddhist_era_year")&&a.setFullYear(a.getFullYear()+l.THAI_BUDDHIST_YEAR_OFFSET),r="MM",n="yyyy",s="dd",c=a.getDate()+"",t.indexOf("dd")!=-1?c&&1===c.length&&(c="0"+c):s="d",g=a.getMonth()+1+"",t.indexOf("MM")!=-1?g&&1===g.length&&(g="0"+g):r="M",t=t.replace(r,g).replace(s,c).replace(n,a.getFullYear()).replace(/'/g,"")):t==f("short")?(a=new Date(e),r="MM",s="dd",c=a.getDate()+"",c&&1==c.length&&(c="0"+c),g=a.getMonth()+1+"",g&&1==g.length&&(g="0"+g),t=t.replace(r,g).replace(s,c).replace(/'/g,"")):(i=o.retrieve("multiDP.abbrevMonthList"),u=e.getDay(),o.retrieve("multiDP.isMondayFirstDayOfWeek")&&(u-=1),u==-1&&(u=6),d="EEE",r="MMM","EEEE d MMMM"==t&&(d="EEEE",r="MMMM"),t=t.replace(d,jsGlobalDaysAbbrev[u]).replace(r,i[e.getMonth()]).replace(/\bd\b/,e.getDate()).replace(/'/g,"")):""}function E(){try{var e=c(),t=g(),a=D();if(!e||!t||!a)return null;var n=e.getDate(),s=e.getMonth()+1,o=e.getFullYear(),l=t.getDate(),i=t.getMonth()+1,u=t.getFullYear(),d={"inDay":n,"inMonth":s+" "+o,"outDay":l,"outMonth":i+" "+u,"adults":a};return d}catch(e){return r.record(e,"Unable to create calendar date args object"),null}}function T(){ta.page&&ta.page.processNewTravelInfo&&ta.page.processNewTravelInfo()}function y(e,t,a){return t&&!i()?void(e&&"function"==typeof e&&e()):(s({url:"/UpdateSessionDatesAjax",data:u(),method:"post",async:a!==!0,success:function(){"function"==typeof e&&e(),n.fireEvent("hotels.sessionDatesUpdated")}}),!0)}function C(e){ta.page.gatherDatesNear(e),!window.event||window.event.target!==e&&window.event.currentTarget!==e||t.stopEvent(window.event)}function M(e){if(e){e=JSON.decode(e);var t=e.url;o.retrieve("is_from_sdprospect")&&t.contains("Hotels")&&(t=t.replace("Hotels","SmartDeals")),window.location=t}else window.location="/Hotels"}function _(){var e,t,a,r=null;if(ta.page.hasDates("CHECKIN")){e=document.querySelectorAll(".meta_date_field.first .date_picker.date"),a=null;for(var n=0;n<e.length;++n)t=e[n].firstChild,t&&3==t.nodeType&&(r=r||f("classic"),a=a||h(ta.page.getDates("CHECKIN")[0],r),t.nodeValue=a)}if(ta.page.hasDates("CHECKOUT")){e=document.querySelectorAll(".meta_date_field .out_date .date_picker.date"),a=null;for(var n=0;n<e.length;++n)t=e[n].firstChild,t&&3==t.nodeType&&(r=r||f("classic"),a=a||h(ta.page.getDates("CHECKOUT")[0],r),t.nodeValue=a)}}function m(e,t,a){var r="date.picker.calendarflyout",n=o.retrieve(r);n||(n=[]);var s={};s.elmt=e,s.overlay=t,s.overlaySrc=a,n.push(s),o.store(r,n),o.remove("date.picker.calendarflyout.allCleared")}function A(){var e="date.picker.calendarflyout",t=o.retrieve(e);t&&(t.forEach(function(e){var t=e.elmt,a=e.overlay,r=e.overlaySrc;t&&a&&r&&(t.removeEventListener("mouseenter",a.showWithDelay),t.removeEventListener("mouseleave",a.hideWithDelay),t.removeEventListener("mouseenter",a.show),t.removeEventListener("mouseleave",a.hide),t.removeEventListener("click",a._pin),t.appendChild(r))}),o.store("date.picker.calendarflyout.allCleared",!0))}function w(){t.select(".roomsButton .grp-rooms-value").forEach(function(e){e.innerHTML=ta.page.guests.getRooms()}),t.select(".guestsButton .grp-guests-value").forEach(function(e){e.innerHTML=ta.page.guests.getAdults()}),ta.widgets.calendar.syncAllDatePickers()}function S(){}if(ta.widgets&&ta.widgets.calendar&&ta.widgets.calendar.hasPageDates)return ta.widgets.calendar;var P={hasPageDates:i,datesExist:i,datesInRange:p,getCheckRatesData:u,getDateArgsObject:E,getGuestsRoomsPickerData:d,updateGuestsRoomsPickerDataFromCookie:S,updateGuestsRoomsPickerUI:S,getPageInDate:c,getPageOutDate:g,getPageAdultsCount:D,getDatePickerFormat:f,getErrorDates:v,dateToString:h,checkDatesMakeHacCallHR:T,justUpdateSessionDates:y,setErrorStyling:C,redirectToHotelOverview:M,updateLegacyDatePickers:_,trackCalendarEvent:S,closeCalendarWidgets:S,handleNewDates:S,syncAllDatePickers:S,trackCRButtonClick:S,clearCalendarFlyouts:A,trackCalendarFlyout:m,removeMetaCalendarFromSync:S,updateAllGuestsRoomsButtons:w,isShim:!0};return a.exportTo(P,"ta.widgets.calendar"),P});
define("mixins/flight-traveler-info/FlightTravelerInfo",["vanillajs"],function(e){"use strict";function t(e){this.travelerInfo=new l(e)}var i=1,s=0,n={},r=0,a="travelerInfoChanged",l=function(e){e=e||{};var t={adults:e.adults||i,seniors:e.seniors||s,childAges:e.childAges||n,classOfService:e.classOfService||r};this.getAdults=function(){return t.adults},this.getSeniors=function(){return t.seniors},this.getChildAges=function(){return t.childAges},this.getNumChildren=function(){return t.childAges.length},this.getTotalTravelers=function(){return this.getAdults()+this.getSeniors()+this.getNumChildren()},this.getClassOfService=function(){return t.classOfService},this.setAdults=function(e){e!==t.adults&&(t.adults=e,ta.page.emit(a,t))},this.addAdults=function(e){0!==e&&(t.adults+=e,ta.page.emit(a,t))},this.setSeniors=function(e){e!==t.seniors&&(t.seniors=e,ta.page.emit(a,t))},this.addSeniors=function(e){0!==e&&(t.seniors+=e,ta.page.emit(a,t))},this.addChildAge=function(e){t.childAges.push(e),ta.page.emit(a,t)},this.removeLastChild=function(){t.childAges.pop(),ta.page.emit(a,t)},this.changeChildAge=function(e,i){i!==t.childAges[e]&&(t.childAges[e]=i,ta.page.emit(a,t))},this.setClassOfService=function(e){"number"==typeof e&&e!==this.getClassOfService()&&(t.classOfService=e,ta.page.emit(a,t))}};return t});
define("mixins/page-dates/MultiCity",["vanillajs","ta","ta/util/SessionStorage","mixins/page-dates/Utils"],function(t,e,a,i){function n(){this.multiCityDates=new r}var s="ONEWAYFLIGHT",o=["LEG_1","LEG_2","LEG_3"],r=function(){var t=a.canUseSessionStore();t&&o.forEach(function(t){var a=i.fromString(window.sessionStorage.getItem("multiCity-"+t+"-date"));a&&!isNaN(a.getTime())&&e.page.setDates(t,[a])});var n=function(e,a,n){n[0]&&t&&o.indexOf(a)>=0&&window.sessionStorage.setItem("multiCity-"+a+"-date",i.dateToIso(n[0]))};e.page.on("dateSelected",n),this.clearInvalidDates=function(){var t=e.page.getDates(s)[0];o.forEach(function(a){var i=e.page.getDates(a)[0];i&&(!t||i>=t?t=i:e.page.pushDates(null,a,[null],!0))})}};return n});
define("utils/decoder",["utils/errorutils"],function(r){function e(e){if(e=e.replace(/\-/g,"+").replace(/\_/g,"/"),e.length%4!==0)for(var n=4-e.length%4,t=0;t<n;t++)e+="=";for(var i,a,o,d,f,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g="",h="",l="",s=0;s<e.length;s+=4){if(o=c.indexOf(e.charAt(s)),d=c.indexOf(e.charAt(s+1)),f=c.indexOf(e.charAt(s+2)),l=c.indexOf(e.charAt(s+3)),o==-1||d==-1||f==-1&&l==-1)return void r.record({"string":e},"string contains invalid base64 letter");i=o<<2|d>>4,a=(15&d)<<4|f>>2,h=(3&f)<<6|l,g+=String.fromCharCode(i),64!=f&&(g+=String.fromCharCode(a)),64!=l&&(g+=String.fromCharCode(h)),i=a=h="",o=d=f=l=""}return unescape(g)}return{base64Decoder:e}});
define("utils/urlDecoder",["utils/decoder"],function(t){function e(e){if(!e)return null;var r=4;return e=t.base64Decoder(e),e=e.substring(r,e.length-r)}function r(t){return t.getAttribute("href")||e(t.getAttribute("data-params"))}function n(t,r){new Event(t).preventDefault();var n=r.getAttribute("data-params");return!!n&&(!!(n=e(n))&&(window.location=n,!1))}return{decodeUrl:e,getUrl:r,goToLink:n}});
define("servlets/homerebranded",["ta","vanillajs","mixins/mixin","mixins/page-dates/DateEvents","mixins/page-dates/Desktop","ta/Core/TA.Event","ta/popups/PopUtil","ta/util/Element","ta/Core/TA.Store","ta/util/Error","mixins/page-guests/Guests","mixins/page-guests/GuestsSelector","ta/util/LegacyDateShim","mixins/page-dates/DateTypeStore","utils/ajax","common/pixels-loader","mixins/flight-traveler-info/FlightTravelerInfo","mixins/page-dates/MultiCity","mixins/Events","utils/urlDecoder"],function(e,t,n,a,i,r,s,o,l,c,u,d,f,g,h,p,m,v,_,b){"use strict";function S(e){e&&Object.keys(e).forEach(function(t){l.store(t,e[t])})}function w(t){G||(n(this,a),_.extend("travelerInfoChanged"),n(this,new i(t.pageDates,t.calendar)),n(this,new u(t.pageGuests)),n(this,new d(this.guests)),n(this,new m(t.travelerInfo)),n(this,new v),k(),p.init(t.remarketingOptions),G=!0),S(t.itemsToStore);var r=this.onDatesSelected;this.onDatesSelected=function(e,t,n){r(e,t,n),A(g.isChildDateType(t)?g.getParents(t):[t],function(){l.store("datesChanged",!0)})};var s=this.clearDates;return this.clearDates=function(t){s(t),this.onDatesSelected(null,t,e.page.getDates(t)),x()},this.on("travelerInfoChanged",function(e){D(e)}),this.processNewTravelInfo=function(){y()},O={rooms:new this.GuestsSelector("rooms",y.bind({},!0)),adults:new this.GuestsSelector("adults",y.bind({},!0))},E(),this}function A(t,a){var i=t.map(e.page.datesToQueryJson).reduce(function(e,t){return n(e,t)},{});0!==Object.keys(i).length&&h({url:"/UpdateSessionDatesAjax",data:i,method:"post",async:!0,success:function(){"function"==typeof a&&a()}})}function x(){h({url:"/UpdateSessionDatesAjax",data:{clear:!0},method:"post",async:!0})}function D(t){for(var n=e.page.travelerInfo.getAdults()+"_"+e.page.travelerInfo.getSeniors()+"_"+e.page.travelerInfo.getClassOfService(),a=0;a<e.page.travelerInfo.getNumChildren();a++){var i=e.page.travelerInfo.getChildAges()[a];i>=0&&(n+="_"+i)}h({url:"/UpdateSessionDatesAjax",data:{travelerinfo:n},method:"post",async:!1,success:function(){"function"==typeof t&&t()}})}function y(t){t&&(l.store("hotels.datesChanged",!0),l.store("meta.isFromDatesChange",!0)),e.page.emit("newPageTravelInfo")}function k(){try{var e=[],t=["#taplc_brand_messaging_0",".shelf_container","#taplc_attractions_near_you_link_0","#taplc_global_footer_0"];t.forEach(function(t){for(var n=document.querySelectorAll(t),a=0;a<n.length;a++)n[a].className.indexOf("featured_destinations")==-1&&e.push(n[a])}),e.forEach(function(e){var t=C(e),n=I(e);if(t&&n){var a=["Home","shelf_in_view",t],i=T(e);if(i&&a.push(i),e.getAttribute&&e.getAttribute("data-brand-shelf")){var r=window.location.pathname,s=r.length<=1?"servletname_Home":"servletname_"+r.substring(1);o.trackWhenScrolledIntoView(n,["pcb_campaign_trending_view","view",s])}o.trackWhenScrolledIntoView(n,a)}})}catch(e){c.record(e,"homepage _setupScrollTracking error")}}function I(e){var t=null;if(e.id)t="#"+e.id;else{var n="."+e.className.split(" ").join("."),a=document.querySelectorAll(n);1===a.length?t=n:c.record(null,"ambiguous selector for scroll tracking: "+n)}return t}function C(e){var t=e.getAttribute("data-rownumber");return t?""+t:e.getAttribute("data-placement-name")}function T(e){return e.getAttribute("data-shelf-id")}function E(){e.on("shelf_item_click_event",function(e,t){j(e,t),window.open(b.getUrl(t),"_blank")}),e.on("track_shelf_item_click_event",function(e,t){j(e,t)})}function j(t,n){var a=n.getAttribute("data-tpp"),i=n.getAttribute("data-tpact"),r=n.getAttribute("data-tpatt"),s=n.getAttribute("data-tpid");e.trackEventOnPage(a,i,r,s)}var O,G=!1;return{init:w}});
define("overlays/options/closeOnTargetChildClick",["vanillajs","api-mod"],function(i,n){"use strict";return function(i){return function(){var t,c=n.bind(function(){this.hide("target-child-click")},this);this.on("show",function(){t=n.find(i),t&&n.addEvent(t,"click",c)}).on("hide",function(){t&&n.removeEvent(t,"click",c)})}}});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"candy_bar_links","handlers",["handlers"]);n(["placement","lib/jquery-amd","api-mod","ta/Core/TA.Record","common/Radio","overlays/Overlay","overlays/position","overlays/styles/popover","overlays/styles/modal","overlays/styles/windowshade","overlays/options/closeOnDocClick","overlays/options/closeOnSourceClick","overlays/options/closeOnTargetChildClick","overlays/options/centerArrowOnSrcElement","overlays/options/ajax"],function(e,n,o,a,i,l,r,s,t,c,k,v,d,h,y){"use strict";var u=n("#"+e.id),p=i("global-nav"),b=null,w=n("#quick-link-more-horizontal"),f=n(".candy-bar-links"),m=n("#quick-link-HelpDesk");p.on("hide-overlays",function(){b&&b.hide("replace-el")}),w.on("click",function(){b&&b.hide("new-overlay");var e=!1,o="above";n(window).scrollTop()>u.height()&&(e=!0,o="below");var i=new l(this,[s(this,o,"candy-bar-flyout candy-bar-menu no_x","",f[0]),e?r.below([0,-55]):r.above(),c("dark"),k,v,d(m),h(w)]);i.show(),b=i,a.trackEventOnPage("QuickLinksMore","open","click")}),m.on("click",function(){b&&b.hide("new-overlay");var n=this;e.require(["trcss!src/build/required/help_center_overlay"],function(){var e=new l(n,[t(this,"","help_center"),r.cssCentered(),k,y("/uvpages/helpCenterOverlay.html")]);e.show(),b=e})}),u.on("click","a.quick-link[data-tracking-label]",function(){var e=n(this).data("trackingLabel");/\/#\s*$/.test(this.href)||"_blank"==this.target?a.trackEventOnPage("QuickLinks","click",e):a.setEvtCookie("QuickLinks","click",e,0,this.href)})})});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"common_form_submit","handlers",["handlers"]);t(["widget","lib/jquery-amd","page-model","common/Radio","ta/Core/TA.Store","common/trackingStreams"],function(e,t,r,a,i,s){"use strict";function o(e){if(!v.requestAny("is-valid",!1)){var r=v.request("url:require");r?(g?v.trigger("loading",!0):v.trigger("disabled",!0),t.when(r).done(function(t){t?(t=n(t),require(["trjs!ta/Core/TA.Record"],function(r){r.setEvtCookie("tripsearch","submit",e.substr(1),0,e),window.location=t.replace("/Tourism",e)})):(v.trigger("loading",!1),s.trackEvent("tripsearch","submit_error",e.substr(1)))})):s.trackEvent("tripsearch","submit_error",e.substr(1))}}function n(e){var t=window.location.pathname,a={hotels:"Hotels"===r.session.pageServlet,restaurants:"Restaurants"===r.session.pageServlet};if(a.hotels||a.restaurants){var i=new RegExp("-g[0-9]+-");if(!t.match(i)){var s=new RegExp("-([a-z]+)([0-9]+)-"),o=s.exec(t);if(o){var n=o[1],c=o[2];if(n&&c){var l=e.indexOf("?")>-1?"&":"?",u=e+l;return"26"===c&&"zff"===n&&a.hotels&&(u+="c=3&"),u+n+"="+c}}}}return e}function c(r){if(r&&"click"==r.type){var a="formsubmit";t(e.element).parents(".persistent_trip_search_fixed").length&&(a+="_persistent"),s.trackEvent(a,"click","update")}}function l(e,r){!1!==v.request("is-valid")&&(s.trackEvent("GuestSelector-tripsearch","update_results_click",f,"1",!1),c(e),ta.servlet&&ta.servlet.HACSearch?ta.servlet.HACSearch.doMetaDateSearch(i.retrieve("page.location"),r):ta.page.processNewTravelInfo(),t(r).addClass("disabled"),t(".ui_overlay .ui_close_x").click())}function u(e,r){!1!==v.request("is-valid")&&(ta.page&&ta.page.onDatesSelected(),t(".ui_overlay .ui_close_x").click())}function p(e,r){var a=!1,i=t(".ui_overlay.rooms_guests_children .age-picker.error").is(":visible");i&&(a=!0),t(".ui_overlay .ui_close_x").click(),ta&&ta.page&&ta.page.processNewTravelInfo&&"function"==typeof ta.page.processNewTravelInfo&&ta.page.processNewTravelInfo(e,r)}function d(e,r){t(".ui_overlay .ui_close_x").click(),ta&&ta.page&&ta.page.processNewTravelInfo&&"function"==typeof ta.page.processNewTravelInfo&&ta.page.processNewTravelInfo(e,r)}var g=!0,v=a("search"),f="",m=i.retrieve("tracking.impression.key"),_=i.retrieve("page.location");return m&&(f="IK:"+m),_&&(f+="/L:"+_),v.on("loading",function(r){t(e.element).toggleClass("loading",r),t(e.element).closest(".trip_search.rounded_lockup").toggleClass("loading",r)}).on("disabled",function(e){t("button").toggleClass("disabled",e)}).on("submit",function(r){g=r,t("button",e.element).click()}),{run:o,updateHotels:l,updateSemPage:u,updateAttractionProducts:p,apdAvailabilityCheck:d}})});

require(["ta/prwidgets"],function(n){var e=n.define.bind(n,"common_progress_bar","handlers",["handlers"]);e(["widget","lib/jquery-amd","ta/page","ta/Core/TA.Event"],function(n,e,o,a){"use strict";function i(){t.removeClass("loading"),setTimeout(function(){t.addClass("loading"),t.one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",r)},0)}function r(){t.removeClass("loading")}var t=e(".progress_bar",n.element);return o.on("newPageTravelInfo",i),a.on("page-polling-complete",r),a.on("page-repoll-failed",r),{}})});
define("overlays/styles/tooltip",["vanillajs","api-mod","overlays/utils"],function(t,e,i){"use strict";function n(t,n,r){this.container=e.createElement(r||"span",{"class":"ui_overlay ui_tooltip arrow_"+i.getArrowDir(t,this.sourceElement,this.domParent)+" "+n}),this.arrow=e.createElement("div",{"class":"arrow"}),this.container.appendChild(this.arrow),this.inner=e.createElement("div",{"class":"body_text"}),this.container.appendChild(this.inner),this.contentElement=this.inner}var r=function(t,e,i,r,a){return t&&(i=i||t.getAttribute("data-tooltip"),a=a||t.getAttribute("data-elementtype")),function(){n.call(this,e,i,a),this.updateContent(r)}};return r});
define("overlays/options/matchWidth",["vanillajs","api-mod"],function(t,i){"use strict";var n=function(t){function n(){this.container&&t&&(i.setStyle(this.container,"width",i.getSize(t).x+"px"),this.emit("positionDirty"))}return function(){this.on("show",i.bind(n,this))}};return n});
define("overlays/options/closeOnLegacyOverlay",["vanillajs","ta/Core/TA.Event"],function(n,e){"use strict";return function(){e.on("onOverlayShow",this.hide.bind(this))}});
define("overlays/options/closeOnTargetEvent",["vanillajs","api-mod"],function(n,t){"use strict";function i(){this.hide("on-event")}return function(n,o){return function(){var e=o.splice?o:[o],c=i.bind(this);this.on("show",function(){e.forEach(function(i){t.addEvent(n,i,c)})}).on("hide",function(){e.forEach(function(i){t.removeEvent(n,i,c)})})}}});
define("overlays/options/highlightElement",["api-mod"],function(i){"use strict";var n=function(n){function t(n){this.on("show",function(){i.addClass(n,"highlight")}).on("hide",function(){i.removeClass(n,"highlight")})}return arguments.length?function(){t.call(this,n)}:void t.call(this,this.sourceElement)};return n});
require(["ta/prwidgets"],function(e){var n=e.define.bind(e,"flights_cos_passenger_picker","handlers",["handlers"]);n(["widget","ta","ta/page","lib/jquery-amd","api-mod","forms/select","overlays/uiOverlay","overlays/Overlay","overlays/styles/dropdown","overlays/styles/tooltip","overlays/position","overlays/options/matchWidth","overlays/options/closeOnDocClick","overlays/options/closeOnLegacyOverlay","overlays/options/closeOnTargetEvent","overlays/options/autoReposition","overlays/options/highlightElement","ta/Core/TA.Store","utils/browserutils","mixins/flight-traveler-info/FlightTravelerInfo","ta/Core/TA.Record"],function(e,n,r,t,o,i,a,l,s,c,d,f,u,v,h,g,p,C,m,w,y){"use strict";function I(e){e.addClass(Ve)}function k(e){return t(Ke).find(".localizationMessages").attr(e)}function b(e){var n=k(e),r=Ze.find(".alertMsgContainer");r.find(".alertMsg").text(n),r.removeClass("hidden")}function _(e){var n=k(e),r=Ze.find(".errorMsgContainer");r.find(".errorMsg").text(n),r.removeClass("hidden")}function A(e){var n=Ze.find("."+e);n.addClass("hidden")}function S(e){e.removeClass(Ve)}function x(e){return e.constructor==={}.constructor}function E(e){return Ke.querySelector(e)}function R(e){switch(e){case be:return De;case _e:return ze;case Ae:return je}}function O(e){switch(e){case be:return qe;case _e:return Ne;case Ae:return Fe}}function P(e){switch(e){case be:return Te;case _e:return Le;case Ae:return Me}}function T(){var e,n;r.travelerInfo.getSeniors()>Le?Te=0:1!==Te&&(Te=1),e=Ze.find(Se),n=parseInt(e.text()),V(n,be)}function L(e){switch(e){case be:return Re;case _e:return Oe;case Ae:return Pe}}function M(e){if("number"==typeof e){var n=e;if(n<1||n>5)return!1;e=Ze.find(".childrenAgeElt_"+n)}return parseInt(e.val())}function q(e){var n=M(e);return n>=0&&n<=2}function D(){return parseInt(Ze.find(".childrenRow .children .travelerCount").text())}function N(e,n){"number"==typeof e&&(e=Ze.find(".flightsAgeContainer_"+e+" .childLabel")),n?e.addClass(We):e.removeClass(We)}function z(){on=0;for(var e=1;e<=D();e++)q(e)?(on++,N(e,!0)):N(e,!1);$()}function F(e){var n=parseInt(e.val());return n<0}function j(e,n){var r,t,o,i;if(Ee===e){for(r=1;r<6;r++)Ze.find(".flightsAgeContainer_"+r).css("display","none");for(rn=0,r=1;r<=n;r++)t=Ze.find(".flightsAgeContainer_"+r),t.removeAttr("style"),t.removeClass("hidden"),o=t.find(".childrenAgeElt_"+r),i=t.find(".childLabel"),F(o)&&(I(i),rn++)}}function B(){var e=0;Ze.find(".travelerRow .travelerCount").each(function(n){var r=parseInt(t(this).text());e+=r}),e<=Je?(an.html(Xe[e]),A("errorMsgContainer"),me()||S(an)):(an.html(Xe[7]),_("data-over-max-travelers"),I(an))}function H(e,n,t){var o,i;switch(e){case be:r.travelerInfo.setAdults(n);break;case _e:r.travelerInfo.setSeniors(n);break;case Ae:return void(t?r.travelerInfo.addChildAge(M(n)):r.travelerInfo.removeLastChild())}o=Ze.find(".travelerRow .adults"),i=Ze.find(".travelerRow .seniors"),0===r.travelerInfo.getAdults()&&0===r.travelerInfo.getSeniors()?(I(o),I(i),tn=!0):(S(o),S(i),tn=!1)}function U(e,n,r){Ze.find(e).removeClass(r),Ze.find(e).addClass(n)}function V(e,n){var r=R(n),t=O(n);e<=P(n)?(U(r,He,Be),U(t,Be,He)):e===L(n)?(U(t,He,Be),U(r,Be,He)):(U(t,Be,He),U(r,Be,He))}function W(e,n,r){e.html(sn[r][n])}function G(e,n){var r=Ze.find(e),t=parseInt(r.text());t>=L(n)||(t++,r.html(t),H(n,t,!0),j(e,t),B(),W(r.siblings(".travelerLabel"),t,n),n===_e?T():n===Ae&&q(t)&&(on++,$()),V(t,n))}function J(e,n){var r=Ze.find(e),t=parseInt(r.text());t<=P(n)||(t--,r.html(t),H(n,t,!1),j(e,t),B(),W(r.siblings(".travelerLabel"),t,n),n===_e?T():n===Ae&&q(t+1)&&(on--,$()),V(t,n))}function K(){for(var e=E(".localizationPeopleStrings"),n=e.getAttribute("data-people-0"),r=1;n;)Xe.push(n),n=e.getAttribute("data-people-"+r++)}function Q(){var e,n=t(en).find(".localizationCosStrings"),r=n[0]?n[0].attributes:null;if(r&&r.length){for(e=1;e<r.length;e++)nn[r[e].nodeValue]=Ge[e-1];sn[be]=C.retrieve("fltTraveler.nAdults"),sn[_e]=C.retrieve("fltTraveler.nSeniors"),sn[Ae]=C.retrieve("fltTraveler.nChildren")}}function X(){r&&r.travelerInfo&&(B(),T(),V(r.travelerInfo.getAdults(),be),V(r.travelerInfo.getSeniors(),_e),V(r.travelerInfo.getNumChildren(),Ae))}function Y(e,n){var r=Ze.find(e),t=r.val();setInterval(function(){r.val()!=t&&(t=r.val(),n(r))},100)}function Z(e){if(e&&0!==e.length){var n=e[0].classList,o=t.grep(n,function(e,n){return e.match(/childrenAgeElt/g)})[0],i=parseInt(o[o.length-1])-1,a=parseInt(e.val()),l=e.closest(".ageContainer").find(".childLabel"),s=F(e),c=q(e);r.travelerInfo.changeChildAge(i,a),s&&!l.hasClass(Ve)?(I(l),rn++):!s&&l.hasClass(Ve)&&(S(l),rn--),c&&!l.hasClass(We)?(on++,N(l,!0)):!c&&l.hasClass(We)&&(on--,N(l,!1)),$(),me()||S(an),Ce()}}function $(){on<=0?A("alertMsgContainer"):b("data-no-infant-in-lap")}function ee(e){var n;if(e&&e.isOpen)n=!e.isOpen();else{var r=t(".picker-dropdown",e);n=r.hasClass("hidden")}ne(n,e)}function ne(e,n){var r=t(".picker-dropdown:not(.hidden)",Qe);if(n.isOpen)r.addClass("hidden"),e?n.show():n.hide();else{var o=t(".picker-dropdown",n);r.is(o)||r.addClass("hidden"),o.toggleClass("hidden",!e)}}function re(e,n){return n||(n=te(e)),ee(n),n}function te(e){var n=null,r=o.find(".picker-dropdown",e);o.removeClass(r,"hidden");var t=o.getSize(e);return n=new l(e,s(e,"below",[Qe.className],r,null,"div"),d.below([0,-(t.y||36)]),f&&f(e),u,v,h(window,["date_bar_docked","date_bar_undocked"]),g),o.removeClass(n.contentElement,"hidden"),n.container.onclick=function(){ee(n)},n}function oe(){ie(en,nn,"cos")}function ie(e,n,r){var i,a,l,s,c=o.find(" .picker-dropdown .options-container",e),d=x(n);t(c).empty();for(l in n)s=d?l:n[l],i=t('<li class="option">'+s+"</li>"),a={},a[r]=d?n[l]:l,ae(i.get(0),a),c.appendChild(i.get(0))}function ae(e,n){o.addEvent(e,"click",function(){le(n)})}function le(e){var n,t=r.travelerInfo.getClassOfService(),o=e.hasOwnProperty("cos")?e.cos:t;if(n=o,n!==t){r.travelerInfo.setClassOfService(n),se(n),Ce();var i=document.createEvent("CustomEvent");ln?i.initCustomEvent("lb_cosChange",!0,!0,{cos:n}):i.initCustomEvent("cosChange",!0,!0,{cos:n}),document.dispatchEvent(i)}}function se(e){var n,r="";for(n in nn)if(nn[n]===e){r=n;break}r&&(t(".picker-inner .picker-label",en).html(r),t(".picker-dropdown .picker-label",ke?ke.container:en).html(r),$e.find(".selectedCos").text(r))}function ce(e){rn>0||tn||t(".ui_close_x",Ie).click()}function de(e,n,r){return function(t){e(n,r),Ce()}}function fe(){var e,n={};if(Ze){n[De]=[J,Se,be],n[qe]=[G,Se,be],n[ze]=[J,xe,_e],n[Ne]=[G,xe,_e],n[je]=[J,Ee,Ae],n[Fe]=[G,Ee,Ae];for(e in n)Ze.find(e).on("click",de.apply(this,n[e]));Ze.find(".cosDropdown").on("click",function(e){ke=re(en,ke)}),Ze.find(".closeText").on("click",ce);for(var r=1;r<=Pe;r++)Y(".childrenAgeElt_"+r,Z)}}function ue(){var e=document.querySelector(".ui_overlay.date_picker_modal");if(e){var n=e.querySelector(".ui_close_x");n.click()}}function ve(e){ue(),t(Ye).on("focus",ue),y.trackEventOnPage("PaxSelector-home","menu_open","class_and_pax_picker_open"),a(e,Ye),Ie=Ze.closest(".ui_overlay"),t(".ui_close_x",Ie).hide()}function he(e,n){(m.Platform.ios||m.Platform.android||m.ie&&m.version<11)&&ve(e)}function ge(e,n){e&&e.target===n&&Ye.focus()}function pe(e,n){m.Platform.ios||m.Platform.android||ve(e)}function Ce(){t("body").trigger(Ue,we())}function me(){return rn>0||tn||r.travelerInfo.getTotalTravelers()>Je}function we(){return{adult:r.travelerInfo.getAdults(),senior:r.travelerInfo.getSeniors(),children:r.travelerInfo.getNumChildren(),childrenAge:r.travelerInfo.getChildAges(),cos:r.travelerInfo.getClassOfService(),hasError:me()}}function ye(){e&&e.element&&(Q(),fe(Ze),oe(),K(),X(),Ce(),z())}var Ie,ke,be="ADULTS",_e="SENIORS",Ae="CHILDREN",Se=".travelerRow .adults .travelerCount",xe=".travelerRow .seniors .travelerCount",Ee=".travelerRow .children .travelerCount",Re=6,Oe=6,Pe=5,Te=1,Le=0,Me=0,qe=".travelerRow .adultCounter .plus-circle",De=".travelerRow .adultCounter .minus-circle",Ne=".travelerRow .seniorCounter .plus-circle",ze=".travelerRow .seniorCounter .minus-circle",Fe=".travelerRow .childrenCounter .plus-circle",je=".travelerRow .childrenCounter .minus-circle",Be="enabled",He="disabled",Ue="cosPax:getDetails",Ve="error",We="containsInfant",Ge=[0,3,1,2],Je=6,Ke=e.element,Qe=e.element,Xe=[],Ye=Ke.querySelector(".cosPassengerPicker"),Ze=t(Ke).find(".popoverContents"),$e=t(Ke).find(".summaryContainer"),en=Ke.getElementsByClassName("cosDropdown")[0],nn={},rn=0,tn=!1,on=0,an=t($e).find(".flightsTotalTravelers"),ln=Ke.classList.contains("inLightbox"),sn=[];return ye(),{containerClick:ge,cosPassengerPickerClick:he,cosPassengerPickerFocus:pe}})});
define("utils/string/InputLength",[],function(){"use strict";return function(t){for(var n=0,r=t.length-1;r>=0;r--){n++;var e=t.charCodeAt(r);(e>=19968&&e<=40959||e>=12352&&e<=12543||e>=44032&&e<=55295)&&n++}return n}});
define("typeahead/TypeAhead",["Logging","api-mod","mixins/mixin","mixins/Events","utils/string/InputLength","lib/jquery-amd","page-model"],function(e,t,i,s,n,r,a){"use strict";var c=9,o=13,h=20,u=27,p=37,l=38,m=39,f=40,y=91,v=16,d=17,I={minChars:3,searchDelay:250,jpFfInterval:500},k=function(e,t){i(this,s.create(Array.prototype.concat(k.inputEvents,k.emitEvents))),this.options=r.extend({},I,e),this.resultElements=null,this.selectedIndex=-1,t&&Array.isArray(t)||(t=Array.prototype.slice.call(arguments,1));for(var n=0;n<t.length;n++)t[n]&&t[n].call(this);k.inputEvents.forEach(function(e){"function"==typeof this[e]&&this.on(e,this[e])},this)};return k.emitEvents=["emptyInput","insufficientInput","search","results","changeSelection","updateSelection","escape","enter","tab","selected","resultHover","resultUnhover","resultClick","show","hide","searchResults","inputChanged"],k.inputEvents=["focus","blur","keydown","keyup"],k.prototype.keydown=function(e,i){if(i)switch(e.keyCode){case o:t.stopEvent(e),this.emit("enter",i);break;case f:t.stopEvent(e),this.emit("changeSelection",i,1);break;case l:t.stopEvent(e),this.emit("changeSelection",i,-1);break;case u:t.stopEvent(e),this.emit("escape",i);break;case c:this.emit("tab",i)}},k.prototype.keyup=function(e,t){if(t&&e.keyCode!==o){switch(clearTimeout(this.searchTimer),e.keyCode){case f:case l:case u:case c:case h:case p:case m:case y:case v:case d:return}var i=this;this.emit("inputChanged",t),this.searchTimer=setTimeout(function(){i.runSearch(t)},this.options.searchDelay)}},a.session.jpFfIME&&(k.prototype.keyupAction=function(e,t){if(t){clearTimeout(this.searchTimer);var i=this;this.searchTimer=setTimeout(function(){i.runSearch(t)},this.options.searchDelay)}},k.prototype.focus=function(e,t){if(document.activeElement==t){var i=function(){this.keyupAction.call(this,e,t),this.imeTimer&&clearTimeout(this.imeTimer),this.imeTimer=setTimeout(i.bind(this),this.options.jpFfInterval)};i.call(this)}}),k.prototype.runSearch=function(e){if(!this.lastQuery||this.lastQuery!=e.value)if(/^\s*$/.test(e.value))this.emptyInput=!0,this.insufficientInput=!1,this.emit("emptyInput",e);else if(n(e.value)<this.options.minChars){if(this.insufficientInput)return;this.emptyInput=!1,this.insufficientInput=!0,this.emit("insufficientInput",e)}else this.emptyInput=!1,this.insufficientInput=!1,this.lastQuery=e.value,this.emit("search",e)},k.prototype.onResults=function(e,t,i){var s=!(t&&t.length||i.indexOf("prefill",0)!=-1);return s?void this.emit("noResults",e):void this.emit("results",e,t,i)},k});
define("typeahead/query/remote",["utils/ajax","utils/objutils"],function(t,e){"use strict";var n=function(n,r,a){return function(o){return function(){var i,u=r?{}:void 0,s=function(t,e){u&&e&&e.length&&e.length>0&&(u[t]=e)},c=function(t){return u&&u[t]},f=function(t,r,a){var i="function"==typeof o?o():o;return{type:"GET",url:"/TypeAheadJson",data:e.extend({action:"API",types:n,filter:"nobroad",legacy_format:!0,urlList:!1,strictParent:!0,query:t,max:25},i),dataType:"json",xhrFields:{withCredentials:!0},success:r,error:a}},l=function(){if(a&&i&&4!=i.readyState&&"function"==typeof i.abort)try{i.abort()}catch(t){}};this.on("search",function(e){var n=this,r=e.value;l();var a=c(r);a?(n.onResults(e,a,r),n.emit("searchResults",a)):i=t(f(r,function(t){s(r,t),n.onResults(e,t,r),n.emit("searchResults",t)},function(t,e,r){n.emit("error","search",e,r)}))})}}},r={};return r.Geo=n("geo"),r.Geo_Caching=n("geo",!0,!0),r.POI=n("eat,attr,hotel"),r.POI_Caching=n("eat,attr,hotel",!0,!0),r});
define("flights/typeahead/views/default",["lib/jquery-amd","api-mod"],function(e,t){"use strict";var i="ui_icon flights",n=new RegExp(/^(.*) [\u002d\u2013\u2014] (.*)$|^(.*)\((.{4,})\)$/),r=function(i,n,s){if(1==arguments.length&&"string"==typeof i){var a=i.split(",");i=r[a[0]],n=r[a[1]]}return i||(i=r.LIST_TEMPLATE),n||(n=r.ITEM_TEMPLATE()),s="undefined"!=typeof s&&s,function(){this.container=document.createElement("div"),this.container.className="ui_typeahead_results",this.on("results",function(t,r){this.offsetParent=e(t).offsetParent()[0],this.container.innerHTML="",this.results=r.reduce(function(e,t){return e.push(t),t.children&&Array.isArray(t.children)?e.concat(t.children):e},[]),this.resultElements=this.results.map(function(e,t){var i=n(e);return i.resultIdx=t,i}),e(this.container).append(i(this.resultElements)),this.emit("show")}),this.on("show",function(){this.offsetParent&&this.results&&this.results.length&&this.offsetParent.appendChild(this.container)}),s||(this.on("hide",function(){t.inDocument(this.container)&&this.offsetParent&&this.offsetParent.removeChild(this.container)}),this.on("hideResults",function(){t.inDocument(this.container)&&this.offsetParent&&this.offsetParent.removeChild(this.container)}))}},s=function(e,t){if(t.error&&t.sectionTitle)return e.innerHTML="<div class='error'>"+t.sectionTitle+"</div>",e;var i,r,s=t.details&&t.details.name?t.details.name:t.name,a=s.match(n);return a?(a=a.filter(function(e){return void 0!=e}),i=a[1]||s,r=a.length>2?a[2]:t.airportCode):t.children&&t.children.length>0?(i=t.name,r=""):(i=t.details&&t.details.geo_name?t.details.geo_name:t.name,r=s),r.indexOf(t.airportCode)<0&&(r+=" "+t.airportCode),t.isChild?e.innerHTML="<div>"+r+"</div>":e.innerHTML="<div><div>"+i+"</div>"+r+"</div>",e};return r.ITEM_TEMPLATE=function(){return function(e){var t=document.createElement("li");return e.selected&&(t.className="selected"),e.children&&e.children.length>0&&t.classList.add("map-pin-fill"),e.isChild&&t.classList.add("childAirport"),e.type&&(t.className+=" "+i),t=s(t,e)}},r.LIST_TEMPLATE=function(t){var i=document.createElement("ul");return e(i).append(t),i},r});
define("utils/string",["utils/errorutils"],function(errorutils){"use strict";function parseLiteral(t){return/^-?\d+(?:\.\d+)?$/.test(t[1])?+t[1]:/^fn:/.test(t[1])?utils.fn(t[1].slice(3)):!!RE_TRUE.test(t[1])||!RE_FALSE.test(t[1])&&void 0}var RE_TRUE=/^(true|1|on|yes)$/i,RE_FALSE=/^(false|0|off|no)$/i,utils={};return utils.fn=function(fn){switch(typeof fn){case"function":return fn;case"string":var f=!1;try{f=eval(fn)}catch(t){errorutils.record(t,"error evaling function")}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join(".")),f=ns&&ns._magic&&ns._magic.partial(n)}catch(t){errorutils.record(t,"function un-parseable")}}if(f&&"function"==typeof f)return f}return null},utils.parseBoolean=function(t){return RE_TRUE.test(t)},utils.parseJSLN=function(t){return(t||"").split(",").reduce(function(t,n){var r=n.split(":");t[r[0].trim()]=parseLiteral(r[1].trim())},{})},utils});
define("typeahead/ux/selectResult",["Logging","lib/jquery-amd","utils/string"],function(e,t,s,i){"use strict";var l=function(e,n,h,u){if(1==arguments.length&&"string"==typeof e){var r=e.split(",");e=l[r[0]],n=l[r[1]],h=s.parseBoolean(r[2])}return n||(n=l.TOGGLE_CLASS()),function(){var s=function(){for(var e=this.results.length,t=0;t<e;t++)if(!this.results[t].skip){this.selectedIndex=t;break}};this.on("results",function(t,i){this.selectedIndex=-1,i.length&&e!=l.MODE_NONE&&(e==l.MODE_AUTO?s.call(this):e==l.MODE_SINGLE?1==i.length&&s.call(this):e==l.MODE_SUFFICIENT&&!this.emptyInput&&!this.insufficientInput&&t.value.trim().length&&s.call(this),this.selectedIndex>=0&&this.emit("updateSelection",t,-1))}),this.on("changeSelection",function(e,t){if(this.results){this.selectedIndex===i&&(this.selectedIndex=-1);for(var s=this.selectedIndex,l=this.selectedIndex+t;l>0&&l<this.results.length&&this.results[l].skip;)l+=t;h&&(l<0&&(l=this.results.length-1),l>=this.results.length&&(l=0)),l=Math.min(Math.max(l,0),this.results.length-1),this.selectedIndex!=l&&(this.results[l]&&this.results[l].skip||(this.selectedIndex=l,this.emit("updateSelection",this.resultElements[l],s)))}}),this.on("updateSelection",function(e,s,i){if(s>=0&&n(this.resultElements[s],!1),!i){var l=t(e).offsetParent()[0];if(l){var h=t(e).position(),u=t(l).height();h.top+e.offsetHeight>u?l.scrollTop=Math.max(0,h.top):h.top<0&&(l.scrollTop=l.scrollTop+h.top)}}!this.results||this.selectedIndex<0||this.selectedIndex>=this.results.length||this.results[this.selectedIndex].selectable!==!1&&n(this.resultElements[this.selectedIndex],!0)}),this.on("enter",function(e){!this.results||this.selectedIndex<0||this.selectedIndex>=this.results.length||this.results[this.selectedIndex].selectable!==!1&&this.emit("selected",this.results[this.selectedIndex],"enter")}),this.on("escape",function(e){this.selectedIndex=-1,this.emit("hide")}),this.on("resultHover",function(e,t){if(this.results&&this.results[t.resultIdx]&&!this.results[t.resultIdx].skip){var s=this.selectedIndex;this.selectedIndex=t.resultIdx,this.emit("updateSelection",t,s,!0)}}),u&&this.on("resultUnhover",function(e,t){if(this.results){var i=this.selectedIndex;s.call(this),this.emit("updateSelection",t,i,!0)}}),this.on("resultClick",function(e,t){this.results&&this.results[t.resultIdx]&&!this.results[t.resultIdx].skip&&this.results[t.resultIdx].selectable!==!1&&this.emit("selected",this.results[t.resultIdx],"click")}),this.on("selected",function(e){this.selectedIndex=-1,e.navi||this.emit("hide")}),this.on("inputChanged",function(e){var t=this.selectedIndex;this.selectedIndex=-1,this.emit("updateSelection",e,t)})}};return l.TOGGLE_CLASS=function(e){return e||(e="selected"),function(s,i){t(s).toggleClass(e,i)}},l.MODE_NONE=0,l.MODE_AUTO=1,l.MODE_SINGLE=2,l.MODE_SUFFICIENT=3,l});
define("typeahead/support/bindToElement",["lib/jquery-amd","typeahead/TypeAhead"],function(t,n){"use strict";return function(e){return function(){var o=this,i=t(e);n.inputEvents.forEach(function(t){i.on(t,function(n){o.emit(t,n,e)})},this),o.on("show",function(){o.resultElements&&o.resultElements.map(function(n){t(n).on("mousedown",function(t){t.stopPropagation(),t.preventDefault(),o.emit("resultClick",t,this)}),t(n).on("mouseenter",function(t){o.emit("resultHover",t,this)}),t(n).on("mouseleave",function(t){o.emit("resultUnhover",t,this)}),t(n).on("touchstart",function(t){o.emit("touchUnfocus",t,this)})})})}}});
define("typeahead/options/showResultsOnFocus",[],function(){"use strict";return function(){return function(){this.on("focus",function(t,i){this.blurTimer&&clearTimeout(this.blurTimer),i.value||this.emit("emptyInput",i),this.emit("show")})}}});
define("typeahead/options/noInputNoResults",[],function(){"use strict";return function(){return function(){function t(){delete this.results,delete this.resultElements,delete this.selectedIndex,this.emit("hideResults")}this.on("emptyInput",t),this.on("insufficientInput",t)}}});
define("typeahead/options/blur",[],function(){"use strict";var e=function(e,t){return e=e!==!1,function(){this.on("blur",function(s,i){e&&(this.blurTimer=setTimeout(function(){this.emit("hide")}.bind(this),250));var u=this.results&&this.results[0]&&this.results[0].query&&this.results[0].query===i.value;t&&this.results&&this.selectedIndex>=0&&this.selectedIndex<this.results.length&&this.results[this.selectedIndex].selectable!==!1&&u&&this.emit("selected",this.results[this.selectedIndex],"blur")})}};return e.Select=function(){return e(!0,!0)},e});
define("typeahead/query/noResults",[],function(){"use strict";return function(n){return function(){this.on("noResults",function(t){this.onResults(t,"function"==typeof n?n(this):n)})}}});
define("babel/babel-helpers",[],function(){var e={};return e["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.jsx=function(){var e="function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103;return function(r,t,n,o){var i=r&&r.defaultProps,u=arguments.length-3;if(t||0===u||(t={}),t&&i)for(var a in i)void 0===t[a]&&(t[a]=i[a]);else t||(t=i||{});if(1===u)t.children=o;else if(u>1){for(var f=Array(u),l=0;l<u;l++)f[l]=arguments[l+3];t.children=f}return{$$typeof:e,type:r,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}}(),e.asyncIterator=function(e){if("function"==typeof Symbol){if(Symbol.asyncIterator){var r=e[Symbol.asyncIterator];if(null!=r)return r.call(e)}if(Symbol.iterator)return e[Symbol.iterator]()}throw new TypeError("Object is not async iterable")},e.asyncGenerator=function(){function e(e){this.value=e}function r(r){function t(e,r){return new Promise(function(t,o){var a={key:e,arg:r,resolve:t,reject:o,next:null};u?u=u.next=a:(i=u=a,n(e,r))})}function n(t,i){try{var u=r[t](i),a=u.value;a instanceof e?Promise.resolve(a.value).then(function(e){n("next",e)},function(e){n("throw",e)}):o(u.done?"return":"normal",u.value)}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":i.resolve({value:r,done:!0});break;case"throw":i.reject(r);break;default:i.resolve({value:r,done:!1})}i=i.next,i?n(i.key,i.arg):u=null}var i,u;this._invoke=t,"function"!=typeof r["return"]&&(this["return"]=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(e){return this._invoke("next",e)},r.prototype["throw"]=function(e){return this._invoke("throw",e)},r.prototype["return"]=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new r(e.apply(this,arguments))}},"await":function(r){return new e(r)}}}(),e.asyncGeneratorDelegate=function(e,r){function t(t,n){return o=!0,n=new Promise(function(r){r(e[t](n))}),{done:!1,value:r(n)}}var n={},o=!1;return"function"==typeof Symbol&&Symbol.iterator&&(n[Symbol.iterator]=function(){return this}),n.next=function(e){return o?(o=!1,e):t("next",e)},"function"==typeof e["throw"]&&(n["throw"]=function(e){if(o)throw o=!1,e;return t("throw",e)}),"function"==typeof e["return"]&&(n["return"]=function(e){return t("return",e)}),n},e.asyncToGenerator=function(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(o,i){try{var u=r[o](i),a=u.value}catch(e){return void t(e)}return u.done?void e(a):Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}},e.classCallCheck=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},e.createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),e.defineEnumerableProperties=function(e,r){for(var t in r){var n=r[t];n.configurable=n.enumerable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t,n)}return e},e.defaults=function(e,r){for(var t=Object.getOwnPropertyNames(r),n=0;n<t.length;n++){var o=t[n],i=Object.getOwnPropertyDescriptor(r,o);i&&i.configurable&&void 0===e[o]&&Object.defineProperty(e,o,i)}return e},e.defineProperty=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},e["extends"]=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},e.get=function e(r,t,n){null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,t);if(void 0===o){var i=Object.getPrototypeOf(r);return null===i?void 0:e(i,t,n)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(n)},e.inherits=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},e["instanceof"]=function(e,r){return null!=r&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](e):e instanceof r},e.interopRequireDefault=function(e){return e&&e.__esModule?e:{"default":e}},e.interopRequireWildcard=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r["default"]=e,r},e.newArrowCheck=function(e,r){if(e!==r)throw new TypeError("Cannot instantiate an arrow function")},e.objectDestructuringEmpty=function(e){if(null==e)throw new TypeError("Cannot destructure undefined")},e.objectWithoutProperties=function(e,r){var t={};for(var n in e)r.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},e.possibleConstructorReturn=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r},e.selfGlobal="undefined"==typeof global?self:global,e.set=function e(r,t,n,o){var i=Object.getOwnPropertyDescriptor(r,t);if(void 0===i){var u=Object.getPrototypeOf(r);null!==u&&e(u,t,n,o)}else if("value"in i&&i.writable)i.value=n;else{var a=i.set;void 0!==a&&a.call(o,n)}return n},e.slicedToArray=function(){function e(e,r){var t=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&a["return"]&&a["return"]()}finally{if(o)throw i}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e.slicedToArrayLoose=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){for(var t,n=[],o=e[Symbol.iterator]();!(t=o.next()).done&&(n.push(t.value),!r||n.length!==r););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},e.taggedTemplateLiteral=function(e,r){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))},e.taggedTemplateLiteralLoose=function(e,r){return e.raw=r,e},e.temporalRef=function(e,r,t){if(e===t)throw new ReferenceError(r+" is not defined - temporal dead zone");return e},e.temporalUndefined={},e.toArray=function(e){return Array.isArray(e)?e:Array.from(e)},e.toConsumableArray=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)},e});
define("flights/typeahead/query/nearestAirports",["babel/babel-helpers","utils/ajax","lib/jquery-amd"],function(t,e,i){"use strict";function n(){f||(f=!0,require(["babel/babel-helpers","trjs!utils/geolocation"],function(t,e){return e.canRequestLocation()?void e.requestLocation(function(t){u=t},function(){a=!0}):void(a=!0)}))}var o="prefill-nearbyAirports",r="/TypeAheadJson",s=void 0,u=void 0,a=!1,f=!1;return function(f){return function(){function l(n){var l=this;if(a)return this.off("emptyInput",h),void this.off("insufficientInput",h);if(!u)return c&&clearTimeout(c),void(c=setTimeout(function(){return h(n)},500));if(!(s instanceof Promise)){var d=this.results?this.results:[];if(s)s.length&&(d=[].concat(t.toConsumableArray(d),t.toConsumableArray(s)));else{var p=[u.latitude,u.longitude].join(","),b=i.extend({isNearby:!0,position:p},f);s=e(r,{data:b}).then(function(t){return s=t.results}).then(function(){l.results=[],l.emit("emptyInput",n)})}this.onResults(n,d,o)}}var c=void 0,h=l.bind(this);this.on("focus",n),this.on("emptyInput",h),this.on("insufficientInput",h)}}});
define("flights/AirportSearchTypeAhead",["typeahead/TypeAhead","typeahead/query/remote","flights/typeahead/views/default","typeahead/ux/selectResult","typeahead/support/bindToElement","typeahead/options/showResultsOnFocus","typeahead/options/noInputNoResults","typeahead/options/blur","typeahead/query/noResults","flights/typeahead/query/nearestAirports"],function(e,t,s,o,i,n,r,a,l,u){"use strict";return function(p,d,y,h){h="undefined"!=typeof h?h:{},h.isMobileWeb="undefined"!=typeof h.isMobileWeb&&h.isMobileWeb,h.showNearbyAirports="undefined"!=typeof h.showNearbyAirports&&h.showNearbyAirports;var b=y&&y.noResults?y.noResults:"No results",f={action:"AIRPORT",name_depth:1,details:!0,types:"geos,air",rebrand2017:"y",max:6,limit:6,includeChildAirports:!0},c=new e({},i(p),s(null,s.ITEM_TEMPLATE(),h.isMobileWeb),o(o.MODE_AUTO,null,null,!0),r(),h.showNearbyAirports?u(f):function(){},t.Geo(function(){return f}),n(),l([{sectionTitle:b,skip:!0,selectable:!1,error:!0}]),a.Select());return c.on("selected",function(e){d(e)}),c}});
define("overlays/options/disablePageScroll",["vanillajs"],function(o){"use strict";return function(){function o(){document.body.style.position="absolute",document.body.style.overflow="hidden",document.body.style.width="100%"}function t(){document.body.style.position="relative",document.body.style.overflow="auto",document.body.style.width="auto"}this.on("show",o),this.on("hide",t)}});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"flights_trip_search_typeahead","handlers",["handlers"]);t(["widget","api-mod","ta/Core/TA.Record","flights/AirportSearchTypeAhead","overlays/Overlay","overlays/styles/modal","overlays/options/disablePageScroll","lib/jquery-amd"],function(e,t,n,a,r,i,l,o){var u,s,c=e.element,d=c.querySelector(".data_holder"),v=!!d&&d.getAttribute("data-isMobileWeb"),p=c.classList.contains("inLightbox"),f=o(c).find(".orig.ui_typeahead .query"),h=o(c).find(".dest.ui_typeahead .query"),m="origin_focus",y="destination_focus",g="origin_select",_="destination_select",b="data-clickedalready",C=function(e){return function(){var t=this;setTimeout(function(){t.value&&t.setSelectionRange(0,t.value.length)}),L(o(this),e)}},w=function(){var e=f.parent().find(".value").val(),t=h.parent().find(".value").val();e!==t&&(e&&f.parent().removeClass("error"),t&&h.parent().removeClass("error"))},E=function(e,t){return function(a){if(e){var r=e.parent().find(".value");null==a?r.val(""):(e.val(a.details&&a.details.name?a.details.name:a.name),r.val(a.airportCode),w()),A(r),n.trackEventOnPage("TripSearch",t,M())}}},A=function(e){var t=e.attr("name"),n=document.createEvent("CustomEvent");p?n.initCustomEvent("lb_odChange",!0,!0,{ind:t,iata:e.val()}):n.initCustomEvent("odChange",!0,!0,{ind:t,iata:e.val()}),document.dispatchEvent(n)},k=function(e,t){return function(){var n=e.parent().find(".value");t&&(""===n.val()&&t.results&&t.results.length>0&&t.results[0].airportCode&&t.emit("selected",t.results[0]),w())}},O=function(e,t){return function(){var n=e.parent().find(".value");n.val(""),t.lastQuery="",A(n)}},R=d?d.getAttribute("data-noresultsmessage"):"";if(!v&&f&&f.length>0&&h&&h.length>0){u=a(f[0],E(f,g),{noResults:R}),s=a(h[0],E(h,_),{noResults:R});var S=function(e){return function(){e.focus()}};f.on("mouseup",S(f)),h.on("mouseup",S(h));var q=function(e){return function(t){t.target===this&&e.focus()}};f.parent().on("mouseup",q(f)),h.parent().on("mouseup",q(h))}else{var T=t.createElement("input",{"type":"text","class":"mw_input","placeholder":f.attr("placeholder"),"autocorrect":"off","spellcheck":"false"}),N=t.createElement("input",{"type":"text","class":"mw_input","placeholder":h.attr("placeholder"),"autocorrect":"off","spellcheck":"false"});u=a(T,E(f,g),{noResults:R},{isMobileWeb:!0,showNearbyAirports:!0}),s=a(N,E(h,_),{noResults:R},{isMobileWeb:!0,showNearbyAirports:!1});var P=function(e){var n=t.createElement("div",{"class":"mw_overlay ui_typeahead"}),a=t.createElement("div",{"class":"mw_input_container"});return a.appendChild(e),n.appendChild(a),n},x=function(e,t,n,a){return function(){if(e&&!e.searchOverlay){var o=P(t),u="mw no_padding typeahead_overlay ui_typeahead "+c.classList;e.searchOverlay=new r(c,i(null,null,u,null,null,o,"div"),null,l),e.on("selected",function(){e.searchOverlay.hide()}),e.emit("emptyInput",t)}t.value="",e.searchOverlay.show(),t.focus(),L(a,n)}};f.on("click",x(u,T,m,f)),h.on("click",x(s,N,y,h))}var L=function(e,t){e&&"false"===e.attr(b)&&(n.trackEventOnPage("TripSearch",t,M()),e.attr(b,"true"))},M=function(){var e="N/A",t="N/A",n=f.parent().find(".value").val();n&&3===n.length&&(e=n);var a=h.parent().find(".value").val();return a&&3===a.length&&(t=a),"/AP:"+e+"_"+t};return v||(f.on("focusin",C(m)),h.on("focusin",C(y)),f.on("focusout",k(f,u)),h.on("focusout",k(h,s)),f.on("input",O(f,u)),h.on("input",O(h,s))),{}})});
define("flights/flight_search_results/FlightSearchForm",["ta/Core/TA.Event","ta/util/Date","lib/jquery-amd","ta/Core/TA.Store","ta/Core/TA.LocalStorage"],function(e,r,t,a,n){"use strict";var i={FLIGHTS_ADULTS_NUMBERS:"FLIGHTS_ADULTS_NUMBERS",FLIGHTS_SENIORS_NUMBERS:"FLIGHTS_SENIORS_NUMBERS",FLIGHTS_CHILDREN_NUMBERS:"FLIGHTS_CHILDREN_NUMBERS",FLIGHTS_ADULTS_NUMBERS_LABEL:"FLIGHTS_ADULTS_NUMBERS_LABEL",FLIGHTS_SENIORS_NUMBERS_LABEL:"FLIGHTS_SENIORS_NUMBERS_LABEL",FLIGHTS_CHILDREN_NUMBERS_LABEL:"FLIGHTS_CHILDREN_NUMBERS_LABEL",FLIGHTS_TOTAL_TRAVELERS:"FLIGHTS_TOTAL_TRAVELERS"},l={FLIGHTS_ADULTS_NUMBERS:6,FLIGHTS_SENIORS_NUMBERS:6,FLIGHTS_CHILDREN_NUMBERS:5},o={ROUND_TRIP:"roundTrip",ONE_WAY:"oneWay",MULTI_CITY:"multiCity"},s=function(){this.peopleStrings=[],this.messages,this.metaLang,this.errors={},this.travelerPopup=!1,this.hideErrors=!1,this.lastDate=null;var s=this,u=function(){return n.enabled},S=function(e){return s.widget.element.querySelector(e)},c=function(e){return t(s.widget.element).find(e)},_=function(){window.calendar&&window.calendar.flyout&&window.calendar.flyout.hide(!1)},L=function(r,a,n,i){var l=[],s=t(a);if(s.hasClass("ghostText")&&(a.value="",s.removeClass("ghostText")),_(),i===o.MULTI_CITY){var u=parseInt(a.id.split("_")[1]);""===S("#mc_"+u+"_airportFromCode").value&&""!==S("#mc_"+(u-1)+"_airportToCode").value&&(S("#mc_"+u+"_airportFrom").value=S("#mc_"+(u-1)+"_airportTo").value,S("#mc_"+u+"_airportFromCode").value=S("#mc_"+(u-1)+"_airportToCode").value)}var c=function(e,r){l.forEach(function(e){e.choices===r&&e.fx.start(0)})},L={onShow:function(){},onHide:c};e.call("ta.widgets.typeahead.factory.ne",r,a,void 0,n,L,l)},d=function(){var e=!1;t(s.widgetElement).find(".singleChildAge").removeClass("ageError"),c("#FLIGHTS_CHILDREN_AGE_DISCLAIMER").removeClass("error");for(var r=parseInt(S("#"+i.FLIGHTS_CHILDREN_NUMBERS_LABEL).innerHTML,10),a=1;a<=r;a++){var n=S("#FLIGHTS_CHILD_AGE_"+a).innerHTML;"&lt; 1"===n&&(n=0),n=parseInt(n,10),isNaN(n)&&(c("#FLIGHTS_AGE_SELECTOR_"+a).addClass("ageError"),e=!0)}return e&&c("#FLIGHTS_CHILDREN_AGE_DISCLAIMER").addClass("error"),!e},E=function(e){var r=t(e);if(0!==r.children("select").length&&0!==r.children(".selectValue").length&&0!==r.children(".selectValueHidden").length){var a=r.children("select")[0],n=r.children(".selectValue")[0],i=r.children(".selectValueHidden")[0];n.innerHTML=a.options[a.selectedIndex].text,i&&(i.value=a.options[a.selectedIndex].text,d())}},T=function(){S("#CHECK_FARES_BUTTON").addEventListener("click",s.searchCallback)},I=function(){S("#CHECK_FARES_BUTTON").removeEventListener("click",s.searchCallback)},v=function(){var e=S("#FLIGHTS_MESSAGE_BOX");e&&(e.removeAttribute("class"),t(e).hide())},h=function(e){var r=c("#FLIGHTS_MESSAGE_BOX");r&&(r.html(e.message),r.addClass(e.type),r.show())},R=function(){for(var e=parseInt(S("#"+i.FLIGHTS_CHILDREN_NUMBERS_LABEL).innerHTML,10),r=1;r<=e;r++){var t=S("#FLIGHTS_CHILD_AGE_"+r).innerHTML;if("&lt; 1"===t&&(t=0),t=parseInt(t,10),!isNaN(t)&&t<=3)return!0}return!1},H=function(){var e=!1,r=parseInt(S("#"+i.FLIGHTS_ADULTS_NUMBERS_LABEL).innerHTML,10),a=parseInt(S("#"+i.FLIGHTS_SENIORS_NUMBERS_LABEL).innerHTML,10),n=parseInt(S("#"+i.FLIGHTS_CHILDREN_NUMBERS_LABEL).innerHTML,10);v();var l=t(s.widgetElement);return l.find(".totalTravelers").removeClass("totalTravelersError"),l.find(".adultLabel").removeClass("travelerLabelError"),l.find(".adultCounter").removeClass("counterContainerError"),r+a+n===0?(l.find(".totalTravelers").addClass("totalTravelersError"),e=!0):r+a===0&&n>0?(h(s.messages.zeroAdults),l.find(".adultLabel").addClass("travelerLabelError"),l.find(".adultCounter").addClass("counterContainerError"),e=!0):r+a+n>6?(h(s.messages.overMaxTravelers),l.find(".totalTravelers").addClass("totalTravelersError"),e=!0):r+a>0&&n>0&&R()&&h(s.messages.noInfantInLap),!e},A=function(){var e=H(),r=d();return e&&r?(T(),!0):(I(),!1)},g=function(e,r){return t(e).parents("."+r).length>0},f=function(e){g(e.target,"travelersLander")||g(e.target,"travelersPopup")||m()},m=function(){if(A()&&s.travelerPopup){document.removeEventListener("click",f);var e=S("#FLIGHTS_TRAVELERS_POPUP");e.hide(),e.removeEventListener("click",H),c("#FLIGHTS_TRAVELERS_LANDER").css("border-bottom",""),s.travelerPopup=!1,T()}},p=function(){if(s.travelerPopup)m();else{var e=S("#FLIGHTS_TRAVELERS_POPUP");e.show(),e.addEventListener("click",H),c("#FLIGHTS_TRAVELERS_LANDER").css("border-bottom","0"),s.travelerPopup=!0,I(),document.addEventListener("click",f)}},F=function(e,r){if(e===i.FLIGHTS_CHILDREN_NUMBERS){for(var t=1;t<=5;t++)c("#FLIGHTS_AGE_CONTAINER_"+t).css("display","none");for(t=1;t<=r;t++)S("#FLIGHTS_AGE_CONTAINER_"+t).erase("style");0===r?c("#FLIGHTS_CHILDREN_AGE_DISCLAIMER").css("display","none"):c("#FLIGHTS_CHILDREN_AGE_DISCLAIMER").attr("style","")}},N=function(){var e=0,r=S("#FLIGHTS_TRAVELERS_SELECTOR").querySelectorAll(".hiddenTravelerNumber");Array.prototype.forEach.call(r,function(r){e+=r.value.toInt()}),e<7?S("#"+i.FLIGHTS_TOTAL_TRAVELERS).innerHTML=s.peopleStrings[e]:S("#"+i.FLIGHTS_TOTAL_TRAVELERS).innerHTML=s.peopleStrings[7]},M=function(e){var r=S("#"+e);r.value<l[e]&&r.value++,S("#"+e+"_LABEL").innerHTML=r.value,F(e,r.value),N()},G=function(e){var r=S("#"+e);r.value>0&&r.value--,S("#"+e+"_LABEL").innerHTML=r.value,F(e,r.value),N()},C=function(){c("#FLIGHTS_SEARCH_FORM").find("input.error").removeClass("error"),c("#FLIGHTS_ERROR .msg").html(""),c("#FLIGHTS_ERROR").hide(),s.errors={}},D=function(e,r){if(t(e).addClass("error"),!s.errors[r]&&(s.errors[r]=!0,s.metaLang[r])){r=s.metaLang[r];var a=S("#FLIGHTS_ERROR .msg").innerHTML;""!==a&&(a+="<br />"),a+=r,c("#FLIGHTS_ERROR").show(),S("#FLIGHTS_ERROR .msg").innerHTML=a}},B=function(){var e=S("#FLIGHTS_TRAVELERS_POPUP");if(u()&&e)try{localStorage.setItem("travelerInfoTimestamp",(new Date).getTime()),localStorage.setItem("adultsNumbers",S("#"+i.FLIGHTS_ADULTS_NUMBERS).value),localStorage.setItem("seniorsNumbers",S("#"+i.FLIGHTS_SENIORS_NUMBERS).value),localStorage.setItem("childrenNumbers",S("#"+i.FLIGHTS_CHILDREN_NUMBERS).value);for(var r=e.querySelectorAll(".ageContainer"),t=0;t<r.length;t++)localStorage.setItem("childAgeSelectIndex"+t,r[t].querySelector("select").selectedIndex),localStorage.setItem("childAgeValue"+t,r[t].querySelector(".childAgeValue").innerHTML),localStorage.setItem("childAgeValueHidden"+t,r[t].querySelector(".childAgeValueHidden").value)}catch(e){}},U=function(){var e=localStorage.getItem("adultsNumbers");S("#"+i.FLIGHTS_ADULTS_NUMBERS).value=e,S("#"+i.FLIGHTS_ADULTS_NUMBERS_LABEL).innerHTML=e},O=function(){var e=localStorage.getItem("seniorsNumbers");S("#"+i.FLIGHTS_SENIORS_NUMBERS).value=e,S("#"+i.FLIGHTS_SENIORS_NUMBERS_LABEL).innerHTML=e},b=function(e){var r=localStorage.getItem("childrenNumbers");S("#"+i.FLIGHTS_CHILDREN_NUMBERS).value=r,S("#"+i.FLIGHTS_CHILDREN_NUMBERS_LABEL).innerHTML=r;for(var t=e.querySelectorAll(".ageContainer"),a=0;a<t.length;a++)t[a].querySelector("select").selectedIndex=localStorage.getItem("childAgeSelectIndex"+a),t[a].querySelector(".childAgeValue").innerHTML=localStorage.getItem("childAgeValue"+a),t[a].querySelector(".childAgeValueHidden").value=localStorage.getItem("childAgeValueHidden"+a)},y=function(){var e=S("#FLIGHTS_TRAVELERS_POPUP");if(u()&&e)try{null!==localStorage.getItem("adultsNumbers")&&U(),null!==localStorage.getItem("seniorsNumbers")&&O(),null!==localStorage.getItem("childrenNumbers")&&b(e),N()}catch(e){}},w=function(e){return(1e4*e.getFullYear()+(100*(e.getMonth()+1)+e.getDate())).toString()},P=function(e){return a.retrieve("thai_buddhist_era_year")&&e>=(new Date).getFullYear()+r.THAI_BUDDHIST_YEAR_OFFSET&&(e-=r.THAI_BUDDHIST_YEAR_OFFSET),e},V=function(e){return a.retrieve("thai_buddhist_era_year")&&(P(e),e+=r.THAI_BUDDHIST_YEAR_OFFSET),e},x=function(e,t){var a=/[\/]/,n=S("#"+e).value.split(a);return n[1]=P(n[1]),r.create(n[1],n[0]-1,S("#"+t).value)},k=function(){for(var e={},r=0,t=parseInt(S("#"+i.FLIGHTS_ADULTS_NUMBERS_LABEL).innerHTML,10),a=parseInt(S("#"+i.FLIGHTS_SENIORS_NUMBERS_LABEL).innerHTML,10),n=parseInt(S("#"+i.FLIGHTS_CHILDREN_NUMBERS_LABEL).innerHTML,10),l=0;l<t;l++)e["pax"+r]="a",r++;for(l=0;l<a;l++)e["pax"+r]="s",r++;for(l=1;l<=n;l++){var o=S("#FLIGHTS_CHILD_AGE_"+l).innerHTML;"&lt; 1"===o&&(o=0),e["pax"+r]=o,r++}return e.travelers=r,e},q=function(){if(!s.lastDate){var e=new Date;if(r.normalize(e),e.setTime(e.getTime()+28512e6),a.retrieve("thai_buddhist_era_year")){var t=e.getDate(),n=e.getMonth(),i=V(e.getFullYear());e=new Date(i,n,t)}s.lastDate=e}return s.lastDate},Y=function(e,r){var a=e,n=!0;return t.each(r,function(e,r){n?n=!1:a+="&",a+=e+"="+r}),a},z=function(){for(var e=s.widgetElement.querySelector(".localizationPeopleStrings"),r=e.getAttribute("data-people-0"),t=1;r;)s.peopleStrings.push(r),r=e.getAttribute("data-people-"+t),t++},K=function(){var e=s.widgetElement.querySelector(".localizationMessages"),r=e.getAttribute("data-no-infant-in-lap"),t=e.getAttribute("data-zero-adults"),a=e.getAttribute("data-over-max-travelers");s.messages={"noInfantInLap":{"message":r,"type":"info"},"zeroAdults":{"message":t,"type":"error"},"overMaxTravelers":{"message":a,"type":"error"}}},W=function(){var e=s.widgetElement.querySelector(".localizationMetaLang");s.metaLang={dateFuture:e.getAttribute("data-date-future"),dateRelative:e.getAttribute("data-date-relative"),dateFar:e.getAttribute("data-date-far"),dateMissing:e.getAttribute("data-date-missing"),airport:e.getAttribute("data-airport"),airportsSame:e.getAttribute("data-airports-same"),checkEmail:e.getAttribute("data-enter-valid-email")}},X=function(e,t,a,n){t=S("#"+t);var i,l=t.innerHTML,o=l.match(DATE_FORMAT.pattern);if(o){var u=parseInt(o[DATE_FORMAT.date].replace(/^0/,""),10),c=parseInt(o[DATE_FORMAT.month].replace(/^0/,""),10),_=parseInt(o[DATE_FORMAT.year].replace(/^0/,""),10);u>0&&u<32&&c>0&&c<13&&(u<10&&(u="0"+u),c<10&&(c="0"+c),_<100&&(_+=2e3),S("#"+n).value=u,S("#"+a).value=c+"/"+_,i=r.create(_,c-1,u))}else{if(!t.innerHTML||null===DATE_FORMAT.pattern.exec(t.value))return s.hideErrors||D(t,"dateMissing"),void(e.valid=!1);i=x(a,n)}i<e.today?(s.hideErrors||D(t,"dateFuture"),e.valid=!1):e.prev&&e.prev>i?(s.hideErrors||D(t,"dateRelative"),e.valid=!1):i>q()&&(s.hideErrors||D(t,"dateFar"),e.valid=!1),e.prev=i},j=function(e,r,t){var a=S("#"+t).value;a&&3===a.length||(s.hideErrors||D(S("#"+r),"airport"),e.valid=!1)},Q=function(e,r,t,a,n){var i=S("#"+t).value,l=S("#"+n).value;i&&l&&i===l&&(s.hideErrors||(D(S("#"+r),"airportsSame"),D(S("#"+a),"airportsSame")),e.valid=!1)},J=function(e){var r=S("#airwatchCheckboxEmail"),t=r?r.value:"";t||(e.valid=!1);var a=t.indexOf("@"),n=t.lastIndexOf(".");return e.valid=a>1&&n>a+2&&n+2<t.length,e.valid},Z=function(){var e=parseInt(S("#"+i.FLIGHTS_ADULTS_NUMBERS).value),r=parseInt(S("#"+i.FLIGHTS_SENIORS_NUMBERS).value);return e+r},$=function(){C();var e=new Date;return r.normalize(e),{prev:null,today:e,valid:d()}},ee=function(){var e=t(".card_searchForm");e.each(function(e,r){var a=e+1;t(".locationInfo input",r).each(function(e,r){var t=r.id.split("_"),n=a+""+t[1].slice(-1);r.id=t[0]+"_"+n+"_"+t[2]}),t(".dateInfo span",r).each(function(e,r){var t=r.id.split("_"),n=a+""+t[3].slice(-1);r.id="date_picker_"+t[2]+"_"+n});var n=t(".searchForm",r);n&&n.addClass("cardSearchForm")})};this.init=function(e,r){s.widget=e,s.widgetElement=e.element,s.searchCallback=r,z(),K(),W()},this.canUseLocalStore=u,this.typeahead=L,this.getAdultsAndSeniors=Z,this.buildQueryString=Y,this.showError=D,this.validateInput=$,this.checkDate=X,this.checkAirport=j,this.checkEmail=J,this.checkAirportsSame=Q,this.formatDateMetaUrl=w,this.addThaiCalendarOffsetIfNecessary=V,this.buildDate=x,this.getTravelersUrlParams=k,this.keepTravelerParams=B,this.restoreTravelerParams=y,this.handleSelectChange=E,this.showTravelerPopup=p,this.hideTravelerPopup=m,this.increaseTravelerNumber=M,this.decreaseTravelerNumber=G,this.initCardsSearchForms=ee};return{IDS:i,TRIP_TYPES:o,FlightSearchFormController:s}});
define("flights/FlightsUtils",["ta"],function(e){"use strict";function n(n){r(n)&&e.log.error(null,"flight localize: cannot find translation without valid key");var t=e.retrieve(n);return r(t)&&e.log.error(null,"flight localize: missing translation for key=$("+n+")"),t}var t=function(e){return null!==e&&"undefined"!=typeof e},r=function(e){return null===e||"undefined"==typeof e},i=function(e,n,t){for(var r=0,i=function(){return"number"!=typeof t||r++<t};(e=e.parentElement)&&i();)if(e.className===n)return e;return null},l=function(e){for(var n="",t=1,r=e.childNodes,i=0;i<r.length;i++)if(8==r[i].nodeType){var o=r[i].nodeValue;if(o.match(/^trk(.*)/)){var a=o.match(/^trk(.*)/)[1];n+="/"+a,t=a.match(/\//g)?a.match(/\//g).length+1:1}else if(o.match(/^etk$/)){for(var u=0;u<t;u++)n+="\\";t=1}}else 1==r[i].nodeType&&(n+=l(r[i]));return n},o=function(e){return e=e.split("\\/").join("\\"),e=e.replace(/^\/+/,""),e=e.replace(/\\+$/,"")},a=function(e){return o(l(e))},u=function(){var e=/g(\d+)/.exec(window.location);return e?e[1]:1};return{localize:n,isDefinedNotNull:t,isUndefinedOrNull:r,findParentWithClass:i,extractTrackingTree:a,getUrlGeoCode:u}});
define("flights/landers/FlightsTripSearchForm",["ta","lib/jquery-amd","flights/flight_search_results/FlightSearchForm","flights/FlightsUtils"],function(e,r,t,a){var n=t.TRIP_TYPES,o=new t.FlightSearchFormController,i=function(){var e=!1;return r.ajax({url:"/AuthCheck",data:{},async:!1,type:"GET",success:function(r){"string"==typeof r&&"true"===r.trim()&&(e=!0)}}),e},f=function(e){if(!e)return"";var r={};return e.forEach(function(e,t){r["airport"+t]=e}),r},s=function(e,r,t){for(var a={},n=0,o=0;o<e;o++)a["pax"+n]="a",n++;for(o=0;o<r;o++)a["pax"+n]="s",n++;for(o=0;o<t.length;o++)a["pax"+n]=t[o],n++;return a.travelers=n,a},u=function(r){var t={};if(r===n.ONE_WAY){var a=e.page.getDates("ONEWAYFLIGHT");if("undefined"==typeof a)return t;t.date0=o.formatDateMetaUrl(new Date(a))}else if(r===n.ROUND_TRIP){var i=e.page.getDates("DEPARTURE"),f=e.page.getDates("RETURN");if("undefined"==typeof i||"undefined"==typeof f)return t;t.date0=o.formatDateMetaUrl(new Date(i)),t.date1=o.formatDateMetaUrl(new Date(f))}return t},l=function(e,t){var a=e,n=!0;return r.each(t,function(e,r){n?n=!1:a+="&",a+=e+"="+r}),a},g=function(){r(".ui_overlay:has(.cosPassengerPopover)").detach()};return{isLoggedIn:i,getGeoCode:a.getUrlGeoCode,getAirportUrlParams:f,getTravelersUrlParams:s,buildQueryString:l,getDatesUrlParams:u,flightSearchForm:o,closeCosPassengerFlyout:g}});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"datepickers_flight_search_dates","handlers",["handlers"]);t(["widget","vanillajs","lib/jquery-amd","api-mod","ta/Core/TA.Event","mixins/page-dates/picker-autopopper","flights/landers/FlightsTripSearchForm","utils/browserutils"],function(e,t,a,n,i,r,l,s){"use strict";function d(e,t){var a,i=e.getAttribute("data-dateFormat");a=t?ta.i18n.formatDate(i,t):e.getAttribute("data-emptyText"),n.find(".picker-inner .picker-label",e).firstChild.nodeValue=a}function o(t,a,i){if(!n.inDocument(e.element))return ta.page.removeListener("dateSelected",o),D=null,void(b=null);if(a===m){if(d(D,i[0]),!i[0])return;if(ta.page.hasDates(f)&&ta.page.getDates(f)[0].getTime()===i[0].getTime())return;ta.page.setDates(f,i[0]),ta.page.emit("dateSelected",null,f,i)}else a===h&&d(b,i[0])}function g(t){for(var a=t.target,n=0;n<5&&(a&&a!==D&&a!==b&&a!==e.element);n++)a=a.parentElement;u(a)}function p(e,t){g(e,t),e.stopPropagation()}function u(e){var t=e===b?b:D;ta.page.gatherDates(t,null,!0,!1)}function c(){if(v){var e=D.getAttribute("data-lb"),t=b.getAttribute("data-lb");ta.page.setDates(m,[new Date(e)]),ta.page.setDates(h,[new Date(t)]),d(D,ta.page.getDates(m)[0]),d(b,ta.page.getDates(h)[0])}}var f="ONEWAYFLIGHT",m="DEPARTURE",h="RETURN",D=n.find("[data-datetype="+m+"]",e.element),b=n.find("[data-datetype="+h+"]",e.element),v=e.element.classList.contains("inLightbox");return i.queueForLoad(function(){ta.page.on("dateSelected",o),r.apply(e.element),c(),ta.store("allowLongTrips",!0)},"datepicker widget handlers"),{handleClick:g,handleFocus:p}})});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"datepickers_flights_single_date_datepicker","handlers",["handlers"]);t(["widget","api-mod","ta/Core/TA.Event","ta/Core/TA.Store","ta","flights/landers/FlightsTripSearchForm"],function(e,t,a,n,i,r){"use strict";function s(e,t){var a,n=e.getAttribute("data-dateFormat");a=t?i.i18n.formatDate(n,t):e.getAttribute("data-emptyText"),e.querySelector(".picker-inner .picker-label").innerHTML=a}function l(a,n,r){if(!t.inDocument(e.element))return i.page.removeListener("dateSelected",l),void(v=null);if(n===L){if(!r||!r[0])return void s(v,null);if(s(v,r[0]),n!=p)return;if(i.page.hasDates(m)&&i.page.getDates(m)[0].getTime()===r[0].getTime())return;if(i.page.setDates(m,r),i.page.emit("dateSelected",null,m,r),!i.page.hasDates(f)||i.page.getDates(f)[0].getTime()<r[0].getTime()){var c=new Date(Math.min(r[0].getTime()+A,o().getTime()+E));i.page.setDates(f,c),i.page.emit("dateSelected",null,f,[c])}}}function o(){var e=new Date;return e.setHours(23,0,0,0),e}function c(){g()}function u(e){g(),e.stopPropagation()}function g(){r.closeCosPassengerFlyout(),i.page.gatherDates(v)}function d(){if(e.element.classList.contains("leg1"))L=D;else if(e.element.classList.contains("leg2"))L=T;else{if(!e.element.classList.contains("leg3"))return;L=h}v.setAttribute("data-datetype",L),v.setAttribute("data-emptytext",""),s(v,null)}var p="ONEWAYFLIGHT",m="DEPARTURE",f="RETURN",D="LEG_1",T="LEG_2",h="LEG_3",L=p,v=e.element.querySelector("[data-datetype="+p+"]"),A=6048e5,E=2851e7;return a.queueForLoad(function(){e.element.classList.contains("mcDatePicker")&&(d(),l(null,L,i.page.getDates(L))),i.page.on("dateSelected",l)},"datepicker widget handlers"),{handleClick:c,handleFocus:u}})});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"flights_trip_search_form","handlers",["handlers"]);t(["widget","ta","ta/util/ajax","lib/jquery-amd","flights/flight_search_results/FlightSearchForm","flights/landers/FlightsTripSearchForm","ta/Core/TA.LocalStorage","ta/Core/TA.Store","utils/urlutils","utils/browserutils","ta/Core/TA.Record","mixins/page-dates/MultiCity","flights/FlightsUtils","ta/Core/TA.FireEvent","ta/util/Error"],function(e,t,r,a,i,n,o,s,l,c,u,d,v,h,g){"use strict";function f(){K.addClass("is-multiline"),X.addClass("is-12")}function p(){K.removeClass("is-multiline"),X.removeClass("is-12")}function m(){return J.matches&&q!=A.MULTI_CITY?void f():void p()}var C,w,y,S=e.element,T=4831,_="lander_trip_type_selection",b="data-clickedalready",E=(window.matchMedia("(max-width: 767px)"),a(".searchFormData")[0]),I=E&&"true"===E.getAttribute("data-is-mobile"),k=E&&E.getAttribute("data-servlet-name"),P=I?39913:40064,D=E&&"true"===E.getAttribute("data-new-results-enabled"),x=I&&D?"/CheapFlightsSearchResults?":"/CheapFlights?",L=n.isLoggedIn(),O=0,A=i.TRIP_TYPES,q=A.ROUND_TRIP,R={orig:"",dest:""},F=O,U=[],N=1,M=0,Y=!0,W=4,j=20,V=0,H=a("#aw-checkbox"),B=a(".aw-email"),G=t.util.sessionStorage&&t.util.sessionStorage.canUseSessionStore(),Q="768px",z="1023px",J=window.matchMedia("(min-width: "+Q+")and (max-width: "+z+")"),K=a(S).find(".trip_search"),X=a(S).find(".submit_wrap"),Z=S.querySelector(".tabContent.roundTrip"),$=S.querySelector(".tabContent.oneWay"),ee=G&&sessionStorage.getItem(_)||A.ROUND_TRIP;m(),a(window).resize(m);var te=function(e,t){var r=a(".tabContent.active .orig",S),i=a(".tabContent.active .dest",S),n=a(".value",r).val(),o=a(".query",r).val(),s=a(".query",r).attr(b),l=a(".value",i).val(),c=a(".query",i).val(),u=a(".query",i).attr(b);r=a(".tabContent:not(.active) .orig",S),i=a(".tabContent:not(.active) .dest",S),a(".value",r).val(n),a(".query",r).val(o),a(".query",r).attr(b,s),a(".value",i).val(l),a(".query",i).val(c),a(".query",i).attr(b,u),a(e,S).each(function(e){a(this).hasClass(t)?a(this).addClass("active"):a(this).removeClass("active")})},re=function(){a(".providers",S).find("input").each(function(e){if(!a(this).is(":checked")){var t=a("label[for='"+this.id+"']");t.click()}})},ae=function(e,r){q===A.MULTI_CITY&&C&&ue(),r&&r.preventDefault&&r.preventDefault(),q=e,G&&sessionStorage.setItem(_,e),te(".ui_tab",e),te(".tabContent",e),q===A.ONE_WAY?(a(".airwatch").hide(),a(".aw-email").hide(),a(".additionalOptions").addClass("oneWay").removeClass("hidden"),fe($).clearError()):q===A.ROUND_TRIP?(a(".airwatch").show(),L||a(".aw-email").show(),a(".additionalOptions").removeClass("oneWay hidden"),fe(Z).clearError()):q===A.MULTI_CITY&&(C||ie(),t.page.multiCityDates.clearInvalidDates(),C.forEach(function(e){e.restoreAirportInputs()}),a(".additionalOptions").addClass("hidden"));var r=document.createEvent("CustomEvent");r.initCustomEvent("triptypeChange",!0,!0,{tt:e}),u.trackEventOnPage("TripSearch","SELECT","FL_TS_"+e.toLocaleUpperCase(),1,!1),m(),document.dispatchEvent(r)},ie=function(){C=[],w=e.element.querySelector(".addFlight"),y=e.element.querySelector(".removeFlight"),w.onclick=se,y.onclick=le;for(var t=0;t<W;t++){var r=e.element.querySelector("#multiCityRow"+(t+1)),a=new ne(r,t);C.push(a),r.classList.contains("hidden")||V++,t>0&&a.clear()}oe(e.element.querySelector(".mcBottomRow .cosPassengerPicker"),W-1)},ne=function(e,r){var a,i,n,o,s=e.querySelector(".orig.ui_typeahead .value"),l=e.querySelector(".orig.ui_typeahead .query"),c=e.querySelector(".dest.ui_typeahead .value"),u=e.querySelector(".dest.ui_typeahead .query"),d=e.querySelector(".mcDatePicker .unified-picker"),v=d.getAttribute("data-datetype"),h=t.page.hasDates(v)?t.page.getDates(v)[0]:null;t.page.on("dateSelected",function(e,t,r){t===v&&(h=r[0],p())});var g=function(e,t){var r=window.sessionStorage.getItem(e);if(r){var a=r.split("|");2==a.length&&t(a[0],a[1])}},f=function(){s.value="",c.value="",l.value="",u.value="",m()},p=function(){d.parentNode.classList.remove("error")},m=function(){a=s.value,i=l.value,n=c.value,o=u.value},w=function(){m(),r>0&&G&&(window.sessionStorage.setItem("multiCity-from-row-"+r,a+"|"+i),window.sessionStorage.setItem("multiCity-to-row-"+r,n+"|"+o))},y=function(){e.classList.add("hidden")},S=function(){r>0&&G&&(g("multiCity-from-row-"+r,function(e,t){a=e,i=t}),g("multiCity-to-row-"+r,function(e,t){n=e,o=t})),s.value=a,c.value=n,l.value=i,u.value=o},T=function(){e.classList.remove("hidden")},_=function(){d.parentNode.classList.add("error")};if(m(),oe(l,r),oe(u,r),oe(d,r),r>0){var b=C[r-1];l.onfocus=function(){l.value&&l.value.trim()||!b.destValInput.value||(s.value=b.destValInput.value,l.value=b.destTextInput.value,l.setSelectionRange(0,l.value.length),l.parentNode.classList.remove("error"))}}return{clear:f,clearErrorStatus:p,collectAndStoreValues:w,destValInput:c,destTextInput:u,getOrigCode:function(){return a},getDate:function(){return h},getDestCode:function(){return n},getRowElement:function(){return e},hide:y,restoreAirportInputs:S,show:T,showDateError:_}},oe=function(e,t){var r=parseInt(e.getAttribute("tabindex"));r||(r=0),e.setAttribute("tabindex",j+r+3*t)},se=function(){V!==W&&(1===V?y.classList.remove("disabled"):V+1===W&&w.classList.add("disabled"),C[V++].show())},le=function(){1!==V&&(2===V?y.classList.add("disabled"):V===W&&w.classList.remove("disabled"),C[--V].hide())},ce=function(){var e,t;for(e=V-1;e>0&&(t=C[e],!t.getOrigCode()&&!t.getDestCode());e--);for(var r=!1,a={},i={},o=0;o<=e;o++){if(t=C[o],ge(t.getOrigCode(),t.getDestCode(),t.getRowElement())){var s=2*o,l=s+1;a["airport"+s]=t.getOrigCode(),a["airport"+l]=t.getDestCode()}else r=!0;var c=t.getDate();!c||"undefined"==typeof c||o>0&&c<C[o-1].getDate()?(t.showDateError(),r=!0):i["date"+o]=n.flightSearchForm.formatDateMetaUrl(new Date(c))}return r?null:{airports:a,dates:i}},ue=function(){C.forEach(function(e){e.collectAndStoreValues()})},de=function(e,t){var r=a(".submit");r&&r.attr("onclick",""),t?(h.fireEvent("lcbPop"),window.open(e),window.location.href=t):window.location.assign(e)},ve=function(e){var t="",r=0;return a(".providers").find("input").each(function(e){a(this).is(":checked")&&(t+=this.name.replace("cb_","&provider"+r+"="),r++)}),0===r?null:n.buildQueryString("/FlightsComparePartners?",e)+t},he=function(e,t){L&&(e+="&aw=true&pid="+P,de(e,t));var r=a(".airwatch"),i=r.attr("data-awSecurityToken"),n={to:R.dest,from:R.orig,pid:P,token:i,email_SIGNIN:a(".aw-email").val()};a.ajax({url:l.https("/AirWatchSubscriptionAjax"),data:n,async:!1,dataType:"json",success:function(r){var a=r.status;"success"===a&&(u.trackEventOnPage("TripSearch","pricedrop_update_search","/AP:"+R.orig+"_"+R.dest),e+="&forceAwConf=true",o.enabled&&r.tamgsubsHtml&&(o.set("airwatch_signup."+R.orig+R.dest,"true"),o.set("aw-checkbox-cross-sub-placement",r.tamgsubsHtml.replace(/(\r|\n)/g,""))),de(e,t))},failure:function(){de(e,t)},error:function(){de(e,t)}})},ge=function(e,t,r){var a=fe(r);return a.clearError(),e===t?(a.origs.addClass("error"),a.dests.addClass("error"),!1):!(!e||!t)||(e||a.origs.addClass("error"),t||a.dests.addClass("error"),!1)},fe=function(e){var t=e.querySelector("[data-prwidget-name=flights_trip_search_typeahead]"),r=a(".orig",t),i=a(".dest",t);return{origs:r,dests:i,clearError:function(){r.removeClass("error"),i.removeClass("error")}}},pe=function(){var e=q==A.ONE_WAY?$:Z,t=ge(R.orig,R.dest,e),r=me(),a=n.getDatesUrlParams(q),i=q===A.ONE_WAY||parseInt(a.date1)>=parseInt(a.date0);return t&&r&&i&&Y},me=function(){var e=N+M+U.length;return N+M>0&&e<7},Ce=function(e){var t=e?e.value:"";if(!t)return!1;var r=t.indexOf("@"),a=t.lastIndexOf(".");return r>1&&a>r+2&&a+2<t.length},we=function(){var e={origin:{code:R.orig},destination:{code:R.dest},dates:{departDate:t.page.hasDates("DEPARTURE")?t.page.getDates("DEPARTURE")[0]:void 0,returnDate:t.page.hasDates("RETURN")?t.page.getDates("RETURN")[0]:void 0},cos:F,travelers:N+M+U};window&&window.localStorage&&t.util.localstorage.canUseLocalStore()&&window.localStorage.setItem("landerState",JSON.stringify(e))},ye=function(){if(!Y)return a(".cosPassengerPicker .summaryContainer .flightsTotalTravelers",S).addClass("error"),void u.trackEventOnPage("PaxSelector-tripsearch","SELECT","age_validation_error");var e,t,r,i={geo:n.getGeoCode(),cos:F,nonstop:a("#nonStopOnly").is(":checked")?"yes":"no"};if(q===A.MULTI_CITY){if(!me())return;C.forEach(function(e){e.clearErrorStatus()}),ue();var o=ce();if(!o)return;e=o.airports,t="no",r=o.dates}else{if(!pe())return;e=n.getAirportUrlParams(Ie(R)),t=a("#includeNearby").is(":checked")?"yes":"no",r=n.getDatesUrlParams(q)}a.extend(i,e,i);for(var s=Object.keys(e).length,l={},d=0;d<s;d++)l["nearby"+d]=t;a.extend(i,l,i),a.extend(i,r,i);var h=n.getTravelersUrlParams(N,M,U);a.extend(i,h,i),U&&U.length>0&&u.trackEventOnPage("PaxSelector-tripsearch","SELECT","kids_update_search_click");var f=n.buildQueryString(x,i);if(!I&&q!=A.MULTI_CITY&&a(".providers",S).length>0){var p=document.createElement("div"),m=v.extractTrackingTree(a(".providers",S)[0]);p.className="impressionTrackingTree",p.innerHTML="<!--"+m+"-->",Se(p)||g.record("Invalid tracking tree:"+m,"trip_search_form/handlers.js",null,null,"WARN"),u.trkImpTree(p)}var w="";if(a(".providers").is(":visible")){var y=a.extend({from:k},i);delete y.geo,w=ve(y)}(c.Platform.ios||c.Platform.android)&&we();var T=a("#aw-checkbox").is(":checked");if(F===O&&q===A.ROUND_TRIP&&T){if(!L){var _=a(".aw-email");if(!Ce(_[0]))return _.addClass("error"),void u.trackEventOnPage("TripSearch","email_validation_error","/L:TODO no loc ID yet");_.removeClass("error")}u.trackEventOnPage("TripSearch","FL_SubCheckboxFL:NC_AirWatchCheckBox::CLI","FL_SubCheckboxFL",P,!1),u.trackEventOnPage("TripSearch","submit","Flights"),he(f,w)}else u.trackEventOnPage("TripSearch","submit","Flights"),de(f,w)},Se=function(e){if(!e||!e.className||!e.firstChild)return!1;var t=new RegExp("\\bimpressionTrackingTree\\b"),r=e.firstChild.nodeType,a=e.firstChild.nodeValue;return t.test(e.className)&&8===r&&""!==a},Te=function(e){e.detail.iata!==R[e.detail.ind]&&(R[e.detail.ind]=e.detail.iata)},_e=function(e,t){F=t.cos,N=t.adult,M=t.senior,U=t.childrenAge,Y=!t.hasError},be=function(){setPID(T),sessionStorage&&G&&sessionStorage.setItem(_,"multiCity"),u.trackEventOnPage("TripSearch","SELECT","FL_TS_MULTICITY",1,!1),window.location.assign("/CheapFlightsHome")},Ee=function(){a("#aw-checkbox").prop("checked",!0)},Ie=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t},ke=function(){n.closeCosPassengerFlyout()};a("body").on("cosPax:getDetails",_e),a(document).on("odChange",Te),L||(B.show(),H.change(function(){!H.is(":checked")&&B.hasClass("error")&&(B.removeClass("error"),B.val(""))}));var Pe=a("[data-prwidget-name=flights_trip_search_typeahead]");if(Pe.length){var De=Pe[0],xe=De.querySelector(".orig.ui_typeahead .value"),Le=De.querySelector(".dest.ui_typeahead .value");R.orig=xe.value,R.dest=Le.value}return B.on("input",function(){var e=a(S).find(".input_highlight");e.html(B.val())}),ae(ee),a(document).on("regOverlay:success",function(){a(".aw-email").hide();var e=a(".airwatch > .label > label"),t=e.attr("data-loggedIn-label");e.text(t)}),{doSearch:ye,setSearchType:ae,selectAll:re,onMultiCityClick:be,onAwInputClick:Ee,closeCosPassengerOverlays:ke}})});
define("utils/responsive",["vanillajs"],function(){"use strict";function t(t){return function(){return document.documentElement.clientWidth>=t}}function e(t){return function(){return document.documentElement.clientWidth<=t}}function n(n,o){return function(){return t(n)()&&e(o)()}}var o={largeMonitor:1600,widescreen:1280,desktop:1024,tablet:768,mobile:767},i=Object.keys(o).sort(function(t,e){return o[e]-o[t]}),r={breakpoints:i,widths:o,atLeast:t,atMost:e,between:n,largeMonitor:t(o.largeMonitor),widescreen:t(o.widescreen),desktop:t(o.desktop),tablet:t(o.tablet),mobile:e(o.mobile),desktopOnly:n(o.desktop,o.widescreen-1),tabletOnly:n(o.tablet,o.desktop-1),landscape:function(){return document.documentElement.clientWidth>document.documentElement.clientHeight},portrait:function(){return document.documentElement.clientHeight>document.documentElement.clientWidth},currentBreakpoints:function(){return i.filter(function(t){return"function"==typeof r[t]&&r[t]()})},is:function(t,e,n){var o="function"!=typeof t&&r[t]?r[t]:t;return function(t,i){return o()?"undefined"!=typeof t?t:e:"undefined"!=typeof i?i:n}}};return r});
define("utils/ResponsiveEvents",["mixins/Events","utils/responsive","utils/throttle","vanillajs"],function(n,e,t){"use strict";function r(n,e,t){var r=n.filter(function(n){return e.indexOf(n)<0}),i=e.filter(function(e){return n.indexOf(e)<0});return t?r.reverse().concat(i.reverse()):r.concat(i)}function i(){var n=document.body.clientWidth;if(n!=o){var t=n>o,i=e.currentBreakpoints(),f=r(u,i,t);f.forEach(function(n){var e=t?"over-":"under-";c.emit(e+n)}),f.length&&c.emit("breakpoint",i[0]),u=i,o=n}}var o=document.documentElement.clientWidth,u=e.currentBreakpoints(),f=["breakpoint"];e.breakpoints.forEach(function(n){f.push("over-"+n,"under-"+n)});var c=n.create(f);return c.onOver=function(n,e){c.on("over-"+n,e)},c.onUnder=function(n,e){c.on("under-"+n,e)},c.offOver=function(n,e){c.off("over-"+n,e)},c.offUnder=function(n,e){c.off("under-"+n,e)},window.addEventListener("resize",t(i,100)),c});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"trip_search","handlers",["handlers"]);t(["placement","api-mod","lib/jquery-amd","utils/throttle","ta/Core/TA.Event","ta/Core/TA.Store","common/trackingStreams","common/Radio","utils/responsive","utils/ResponsiveEvents"],function(e,t,s,i,n,o,r,a,d,c){function f(){function e(){m.css("height",x.height()||""),s(window).on("resize",c),x.addClass("fixed persistent_trip_search_fixed"),u(),t.fireEvent(window,"date_bar_undocked"),n.fireEvent("scrollingTabs_updateTabBar",{"height":x.height()})}function o(){m.css("height",""),s(window).off("resize",c),x.removeClass("fixed persistent_trip_search_fixed"),u(),t.fireEvent(window,"date_bar_docked")}if(x){var r=s(window).scrollTop(),a=t.find(".date_picker_modal",w),c=i(function(){m&&x&&x.hasClass("fixed")&&m.css("height",x.height()||"")},100);d.mobile()?x.hasClass("fixed")&&o():!x.hasClass("fixed")&&l(a,r)?e():x.hasClass("fixed")&&h(a,r)&&o()}}function l(e,t){return e?t>e.offset().top:t>m.offset().top}function h(e,t){return e?t<=e.offset().top:t<=m.offset().top}function _(){b.addClass("disabled")}function u(){p()}function p(){setTimeout(function(){if(w){var e=s(".change_dates_text",w);e&&(e.removeAttr("style"),e.addClass("autoResize"),t.fireEvent("refreshedDOMContent",w))}},1)}function v(e){a("trip_search").trigger("clear_dates",e)}function g(){var i=s("#h"),n=s("#"+e.id);t.toggleClass(n,"hidden",!t.hasClass(i,"selected"))}var m=s("#"+e.id),w=s(".datepicker_box",m),C=s(".title",m),b=s("#UPDATE_RESULTS",m),x=s("#PERSISTENT_TRIP_SEARCH_BAR",m),E=x.hasClass("noAutoHac");return _(),n.on("hotels.sessionDatesUpdated",_),n.on("show_hide_tripsearch",g),m.find(".traveler_info_container").length&&o.store("guests_rooms_picker.enabled",!0),E&&(o.store("priceFinder.noAutoRefresh",!0),n.on("onHACUpdate",ta.hac.filters.dimUpdateBtn)),s(window).one("date_bar_undocked",function(){r.trackEvent("persistentheader","in_view")}),s(window).on("scroll",i(f,100)),c.onUnder("tablet",f),c.onOver("tablet",f),n.queueForLoad(f),C&&o.store("hotels_left_filters_redesign_searching_text",C.outerHTML+'<div class="content">'+o.retrieve("hotels_left_filters_redesign_searching_text")+"</div>"),{clearDates:v}})});
define("mixins/page-dates/picker-autopop-post-checkin",["ta","mixins/page-dates/DateTypeStore","vanillajs"],function(e,t){"use strict";function a(e,t){for(;t;){if(e===t)return!0;t=t.parentNode}return!1}function r(r){e.page.on("dateSelected",function i(o,p,u){try{if(!a(document,r))return void e.page.off("dateSelected",i)}catch(e){require(["trjs!ta/util/Error"],function(t){t.record(e,"autopopper dateSelected - inDocument")})}try{if(!a(r,o))return}catch(e){require(["trjs!ta/util/Error"],function(t){t.record(e,"autopopper dateSelected - parentElement.contains")})}var c=t.getCorrespondingDateType(p);if(c){var s="CHECKIN"===p&&!n;if(!e.page.hasDates(c)||s){if(!e.page.hasDates(c)&&"CHECKIN"===p&&Array.isArray(u)){var d=new Date(u[0].getFullYear(),u[0].getMonth(),u[0].getDate()+1);e.page.pushDates(r.querySelector('[data-datetype="'+c+'"]'),c,[d],!0)}if(!e.page.hasDates(c)&&"CHECKOUT"===p&&Array.isArray(u)){var g=new Date(u[0].getFullYear(),u[0].getMonth(),u[0].getDate()-1);e.page.pushDates(r.querySelector('[data-datetype="'+c+'"]'),c,[g],!0)}var l="CHECKOUT"===c;n="CHECKOUT"===p,setTimeout(e.page.gatherDates.bind(e.page,r.querySelector('[data-datetype="'+c+'"]'),null,!1,!1,l))}}})}var n=!1;return{apply:r}});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"datepickers_trip_search_dates","handlers",["handlers"]);t(["widget","lib/jquery-amd","api-mod","ta/Core/TA.Event","common/trackingStreams","mixins/page-dates/picker-autopopper","mixins/page-dates/picker-autopop-post-checkin","common/Radio","mixins/page-dates/default-dates"],function(e,t,r,a,n,i,c,o,l){"use strict";function s(e,r){var a,n=e.attr("data-dateFormat");try{a=r?ta.i18n.formatDate(n,r):e.attr("data-emptyText");var i=e.find(".picker-label.target");i.removeClass("ghost_text"),t(".picker-inner .picker-label",e).html(a)}catch(e){require(["trjs!ta/util/Error"],function(t){t.record(e,"handlers dateSelected - parentElement.contains")})}}function d(t,a,n){try{if(!r.inDocument(e.element))return ta.page.removeListener("dateSelected",d),f=null,void(h=null)}catch(e){require(["trjs!ta/util/Error"],function(t){t.record(e,"handlers _onDateSelected - inDocument")})}try{"CHECKIN"===a?s(f,n[0]):"CHECKOUT"===a?s(h,n[0]):"STAYDATES"===a&&(s(f,n[0]),s(h,n[1]))}catch(e){require(["trjs!ta/util/Error"],function(t){t.record(e,"handlers _onDateSelected - dateType")})}}function u(e,r,a,n){if(r){e&&"click"==e.type&&(e.stopPropagation(),p(e));var i=t(".ui_overlay.rooms_guests_children");if(i){var c=t(".ui_overlay.rooms_guests_children .ui_close_x");c.click()}return ta.page.gatherDates(r,null,a,!1,n),!1}}function p(e){if(e){var t="datepicker";r.getParent(g,"persistent_trip_search_fixed")&&(t+="_persistent");var a="module";e.target&&(e.target==f[0]||r.containsElement(f[0],e.target)?a="checkin":e.target==h[0]||r.containsElement(h[0],e.target)?a="checkout":e.target.className.indexOf("caret-down")>=0&&(a="caret")),n.trackEvent(t,"click",a)}}var g=e.element,m=t(".ui_picker .unified-picker",g),f=t("[data-datetype=CHECKIN]",g),h=t("[data-datetype=CHECKOUT]",g),_=!!t("#HOTEL_DATEPICKER_IMPROVEMENTS",g).length;return m.on("focus",function(e){u(e,this,!_)}),o("search").on("loading",function(r){t(e.element).toggleClass("loading",r)}).on("popDatePicker",function(){u(null,f[0],!1)}),a.queueForLoad(function(){require(["ta/page"],function(t){t.on("dateSelected",d),ta.store&&ta.store("interact_through_progress_bar",!0),_?c.apply(e.element):i.apply(e.element),l.apply(e.element)})},"datepicker widget handlers"),t(g).on("click",function(e){return e.target===h[0]||r.containsElement(h[0],e.target)?u(e,h[0],_):u(e,f[0],_)}),{onDatePickerClick:u}})});
define("hotels/ChildAgesSerialization",["vanillajs"],function(){function n(n){return null==n||0===n.length?[]:n.split(t).map(function(n){return parseInt(n,10)}).filter(function(n){return!isNaN(n)})}function e(n,e){if(null==e||0===e.length)return"";for(var t=Math.floor(e.length/n),l=e.length-t*n,a=[],u=0,o=0;o<n;++o){var f=0;if(f=o<l?t+1:t){var h=Math.min(u+f,e.length),s=e.slice(u,h);u=h,a.push(s.join(i))}}return a.join(r)}var i=",",r=":",t=new RegExp(i+"|"+r);return{deserialize:n,serialize:e}});
define("hotels/RoomsGuests",["hotels/ChildAgesSerialization","api-mod","ta/Core/TA.Store","utils/objutils","mixins/Events","vanillajs"],function(e,n,t,i,r,s){"use strict";function l(e){for(var n=new Array(e),t=0;t<e;++t)n[t]=u;return n}var u=-1,a=1,o=2,h=0,c=4,d=10,A={ROOMS_CHANGED:"roomsChanged",ADULTS_CHANGED:"adultsChanged",CHILDREN_CHANGED:"childrenChanged"},g={MIN_ROOMS:1,MAX_ROOMS:8,MIN_ADULTS:1,MAX_ADULTS:8*c,MIN_CHILDREN:0,MAX_CHILDREN:20,MAX_CHILD_AGE:17,MAX_ADULTS_PER_ROOM:4,MAX_CHILDREN_PER_ROOM:10},m=function(s){function m(e,n,t){return isNaN(e)||e%1!==0?null:Math.min(t,Math.max(n,e))}function f(e){return m(e,g.MIN_ROOMS,g.MAX_ROOMS)}function C(e){return m(e,g.MIN_ADULTS,g.MAX_ADULTS)}function _(e){return m(e,g.MIN_CHILDREN,g.MAX_CHILDREN)}function M(e){return m(e,u,g.MAX_CHILD_AGE)}function N(e){return e.map(function(e){return M(e)})}function E(t){D=f(t.nRooms)||a,R=C(t.nAdults)||o;var i;t.childrenAges?(H=N(n.isArray(t.childrenAges)?t.childrenAges:e.deserialize(t.childrenAges)),i=_(H.length),H=H.slice(0,i)):(i=_(t.nChildren)||h,H=l(i))}var D,R,H,S=s||{},b=S.roomChangedCallback||function(){},O=S.adultsChangedCallback||function(){},I=S.childrenChangedCallback||function(){},L=new(r.bind.apply(r,Object.keys(A).map(function(e){return A[e]})));if(S.initialValues)E(S.initialValues);else if(S.initialValuesHolder){var v={nRooms:Number(S.initialValuesHolder.getAttribute("numRooms")),nAdults:Number(S.initialValuesHolder.getAttribute("numAdults")),nChildren:Number(S.initialValuesHolder.getAttribute("numChildren")),childrenAges:S.initialValuesHolder.getAttribute("childrenAges")};E(v)}else E({});this.get=function(){return{nAdults:R,nRooms:D,childrenAges:H}},this.fromStore=function(){var n=t.retrieve("guests.rooms.object");this.update({nRooms:n.rooms,nAdults:n.guests,childrenAges:e.deserialize(n.child_rm_ages)})},this.hasStoreValues=function(){return t.has("guests.rooms.object")},this.updateStore=function(){var n=t.retrieve("guests.rooms.object"),i=H.map(function(e){return parseInt(e,10)}),r={guests:R,rooms:D,child_rm_ages:e.serialize(D,i)};return n&&n.guests===r.guests&&n.rooms===r.rooms&&n.child_rm_ages===r.child_rm_ages?null:(t.store("guests.rooms.object",r),r)},this.clear=function(){return this.update({nRooms:a,nAdults:o,nChildren:h})},this.update=function(e){var t,r,s,g,m,M,E=e.nRooms||D,S=e.nAdults||R;if(n.isArray(e.childrenAges)?(r=N(e.childrenAges),t=r.length):"undefined"!=typeof e.nChildren?(t=e.nChildren,r=H.length<t?l(t).map(function(e,n){return n<H.length?H[n]:u}):H.slice(0,t)):(t=H.length,r=H),D===E&&R===S&&H.length===t)return!i.shallowEquals(H,r)&&(H=r,I(H),L.emit(A.CHILDREN_CHANGED,H),!0);var v=_(t)||h;if(E!==D)m=f(E)||a,s=m>S?m:Math.min(E*c,S),g=Math.min(E*d,v);else{var p=C(S)||o,T=Math.ceil(p/c);T=Math.max(T,E);var G=Math.ceil(v/d);m=Math.max(T,G),m=Math.min(m,p),g=Math.min(v,m*d),s=p}M=r.length>g?r.slice(0,g):r;var j=!1;return m!==D&&(b(m),L.emit(A.ROOMS_CHANGED,m),j=!0),s!==R&&(O(s),L.emit(A.ADULTS_CHANGED,s),j=!0),i.shallowEquals(H,M)||(I(M),L.emit(A.CHILDREN_CHANGED,M),j=!0),D=m,R=s,H=M,j},this.updateChildAge=function(e,n){return"string"==typeof n&&(n=parseInt(n,10)),n=M(n),e>=0&&e<H.length&&H[e]!==n&&(H[e]=n,I(H),L.emit(A.CHILDREN_CHANGED,H),!0)},this.cleanMissingChildrenAges=function(){var e=H.filter(function(e){return e>=0});return H=e,I(e),L.emit(A.CHILDREN_CHANGED,e),e},this.hasMissingChildrenAges=function(){for(var e=0;e<H.length;++e)if(H[e]===-1)return!0;return!1},this.on=L.on.bind(L),this.off=L.off.bind(L)};return Object.freeze?(m.EVENTS=Object.freeze(A),m.CONSTANTS=Object.freeze(g)):(m.EVENTS=A,m.CONSTANTS=g),m});
define("overlays/options/blurSourceOnHide",["vanillajs"],function(){"use strict";return function(){var e=this;this.on("hide",function(){e.sourceElement&&e.sourceElement.blur()})}});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"ibex_trip_search_rooms_guests","handlers",["handlers","pickers"]);t(["widget","lib/jquery-amd","common/trackingStreams","ta/Core/TA.Event","ta/Core/TA.Store","ta/page","common/Radio","hotels/RoomsGuests","overlays/Overlay","overlays/styles/popover","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnLegacyOverlay","overlays/options/repositionOnEvent","overlays/options/autoReposition","overlays/options/highlightElement","overlays/options/centerArrowOnSrcElement","overlays/options/blurSourceOnHide","ta/util/LegacyDateShim","pickers"],function(e,t,n,i,o,r,a,s,l,c,u,d,f,v,g,_,p,h,m,k){"use strict";function C(e){e===!0?z.removeClass("disabled"):z.addClass("disabled")}function E(e){e!==ie.get(0)&&(J.fromStore(),A(!1))}function S(){for(var e=ie.parent(),t=0;t<4;++t){var n=e.find(".update_results_button");if(n)return n;e=e.parent()}return null}function y(){var e=ie.attr("class").toLowerCase(),t=e.split(" ").filter(function(e){return 0===e.indexOf("wctx-",0)});if(t.length>0)return t[0].substring(5)}function A(e){X&&X.setInitialState(),R(),N(),e&&J.updateStore()}function x(e){N(e),w()}function T(e){R(e),w()}function b(e){R(void 0,e),w()}function w(){se=!0,C(!0),B(!0)}function O(){Z=y(),ne=ie.hasClass("noAutoHac"),Q=ie.find(".traveler_info_container");var e=ie.find(".initial-values-holder");J=new s({initialValuesHolder:e.get(0)}),J.on(s.EVENTS.ROOMS_CHANGED,x),J.on(s.EVENTS.ADULTS_CHANGED,T),J.on(s.EVENTS.CHILDREN_CHANGED,b),z=S(),D(),J.hasStoreValues()?E():A(!0)}function D(){ae&&($=!z.hasClass("no_change"),z.length>0&&(ee=z.get(0).onclick,z.get(0).onclick=null,z.on("click",M)),te=[G("CHECKIN"),G("CHECKOUT")],r.on("dateSelected",U),i.on("searchFieldsChanged",E))}function G(e){return ie.closest("[data-dateType="+e+"]").get(0)}function H(){t(".ui_overlay.date_picker_modal .ui_close_x").click()}function N(e){var n=e||J.get().nRooms,i=o.retrieve("rgPicker.nRooms"),r=i&&i.length>n?i[n]:"";t(".traveler_info_numeric .room-info").text(n),t(".traveler_info_text .room-info").text(r),t(".rooms-picker .picker-label:visible").text(r)}function R(e,n){var i=J.get(),r=e||i.nAdults,a=(n||i.childrenAges).length,s=r+a;t(".traveler_info_numeric .guest-info").text(s);var l=ie.find(".traveler_info_text .guest-info");if(l.length){var c=o.retrieve("rgPicker.nGuests"),u=c&&c.length>s?c[s]:"";l.text(u)}else{var d=o.retrieve("rgPicker.nAdults"),f=d&&d.length>r?d[r]:"",v=o.retrieve("rgPicker.nChildren"),g=v&&v.length>a?v[a]:"";ie.find(".traveler_info_text .adult-info").text(f),ie.find(".traveler_info_text .child-info").text(g)}}function L(e){var t="guestpicker";ie.parents(".persistent_trip_search_fixed").length&&(t+="_persistent");var i="module",o=e&&e.target&&e.target.className||"";o.indexOf("caret-down")>=0&&(i="caret"),n.trackEvent(t,"click",i)}function I(){R(),N();var e=J.updateStore();e&&(i.fireEvent("onLegacyGuestsChanged",e),m.justUpdateSessionDates())}function P(){X&&!X.verifyAgesOfChildren()?W.show():(I(),se&&V(),se=!1)}function V(){z.is(":hidden")&&a("search").emit("submit")}function Y(){W.hide()}function F(e){if(n.trackEvent("GuestSelector-"+Z||"","menu_open",le,"1",!1),!W||!t.contains(document,W.sourceElement)){var i=ie.find(".popup_content"),o=ie.find(".traveler_info_container").get(0),r="rooms_guests_children no_x no_padding";r+=ie.parents(".responsive_inline").length?" responsive_inline":"",W=new l(o,c(o,"below",r,"",i.get(0)),u.below([],!1,!1,[16]),p(o),d.withoutTouchEvents,f,v(window,["date_bar_docked","date_bar_undocked"]),g,_,h),W.on("hide",P);var a=t(".pickers",W.contentElement);a.removeClass("hidden"),X=new k(J,a),X.on("hide",Y),X.on("roomInfoChanged",I),X.on("markErrors",function(e){Q.parent().toggleClass("error",e)}),X.setInitialState()}!e&&W.isOpen()?(W.hide(),n.trackEvent("GuestSelector-hotelreview","close_click")):(W.show(),n.trackEvent("ATF_HR_Room_Guest_More","click"))}function K(e){n.trackEvent("GuestSelector-"+(Z||""),e,le,"1",!1)}function M(e){e.stopPropagation(),K("update_results_click"),j(!0,e)}function U(e,t){if("STAYDATES"===t)return te.indexOf(e)===-1?(Y(),void B(!1)):void(ne||j(!1))}function j(e,t){if(se||q()){if(Y(),e&&$){var n=r.getDates("STAYDATES");r.onDatesSelected(te[0],"STAYDATES",n,!0)}"function"==typeof ee&&ee.apply(z.get(0),[t]),B(!1),i.fireEvent("searchFieldsChanged",ie.get(0))}}function q(){return!z.hasClass("disabled")}function B(e){ae&&$&&(r.hasDates("STAYDATES")&&(z.text(o.retrieve("common_update_results")),z.removeClass("original"),z.addClass("primary")),e?z.removeClass("hidden"):z.addClass("hidden"))}var z,J,Q,W,X,Z,$,ee,te,ne,ie=t(e.element),oe=!0,re=!1,ae=!1,se=!1,ae="true"===e.element.getAttribute("data-updateButtonHidden"),le="",ce=o.retrieve("tracking.impression.key"),ue=o.retrieve("page.location");ce&&(le="IK:"+ce),ue&&(le+="/L:"+ue);var de=ie.find(".ui_picker .traveler_info_container");de.on("focus",function(){H(),F(!0)}),ie.on("click",function(e){L(e),de.focus(),F(!0)}),O(),a("search").on("loading",function(n){t(e.element).toggleClass("loading",n)}).reply("is-valid",function(){return re||(oe=X?X.verifyAgesOfChildren():!J.hasMissingChildrenAges()),oe||n.trackEvent("GuestSelector-tripsearch","age_validation_error",le,"1",!1),oe})})});
define("hotels/RoomsGuestsUI",["lib/jquery-amd","hotels/RoomsGuests","ta/Core/TA.Dust","mixins/Events","ta/Core/TA.Store","overlays/Overlay","overlays/styles/dropdown","overlays/options/closeOnDocClick","overlays/options/closeOnLegacyOverlay","overlays/options/closeOnTargetEvent","overlays/options/matchWidth","overlays/options/autoReposition","overlays/position"],function(t,e,n,o,i,r,s,a,c,l,f,u){"use strict";var d={VALUE_CHANGED:"valueChanged",WILL_OPEN:"willOpen"},p=function(e,i,p,v,h,g){function k(t){var e=t.attr("data-val");m(e),y(),D.emit(d.VALUE_CHANGED,e)}function m(n){var o=p(n);T?t(T.container).find(".picker-dropdown .picker-label").text(o):e.find(".picker-dropdown .picker-label").text(o),e.find(".picker-inner .picker-label").text(o)}function C(){if(T&&T.container){var e=t(T.container).find(".options-container");e.scrollTop(e.scrollTop()+1),e.scrollTop(e.scrollTop()-1)}}function E(t){T&&(t&&D.emit(d.WILL_OPEN,N),T.isOpen&&(t?T.show():T.hide()))}function y(){var t=!0;T&&(t=!T.isOpen()),E(t)}function b(){T||(T=w()),y(),C()}function w(){var e=x.find(".picker-dropdown"),n=x.get(0);e.removeClass("hidden");var o=new r(n,s(n,"below",[],e.get(0),null,"div"),!g.flexWidth&&f(n),a,c,l(window,["date_bar_docked","date_bar_undocked"],u));return o&&(o.domParent=n),t(o.contentElement).removeClass("hidden"),t(o.container).on("click",".curoption",function(t){t.stopPropagation(),y(),C(e)}),o}function O(t){T&&T.destroy(),t&&x.parent().length?x.parent().remove():x.remove()}function A(t){x.toggleClass("hidden",!t)}function L(t){x.find(".picker-inner").toggleClass("error",t),x.toggleClass("error",t)}function _(t){g.titleClass&&x.find("."+g.titleClass).text(t)}var x,T,V="rooms-guests/desktop/dropdown.dust",D=new o(d.VALUE_CHANGED,d.WILL_OPEN),N=this;g=t.extend({},g),p&&"function"==typeof p||(p=function(t){return t}),e=t(e),this.on=D.on.bind(D),this.off=D.off.bind(D);var P={topClass:i,min:v,max:h+1,titleClass:g.titleClass};n.render(V,P,e.get(0),function(){e.find(".option").on("click",function(e){e.stopPropagation(),k(t(this))}).each(function(){var e=t(this).attr("data-val"),n=parseInt(e,10),o=p(n);t(this).text(o)}),m(v),x=e.find(".unified-picker"),x.on("click",function(t){t.stopPropagation(),b()})}),this.setValue=m,this.hidePopup=function(){E(!1)},this.destroy=O,this.toggleVisible=A,this.toggleError=L,this.setTitle=_},v=function(e,i,r,s,a,c){function l(t){var n=Math.min(Math.max(a,t),c),o=r(n);e.find(".picker-label").text(o),p.toggleClass("inactive",t>=c),v.toggleClass("inactive",t<=a)}function f(t){t&&h.parent().length?h.parent().remove():h.remove()}function u(t){var e=s()+t;l(e),k.emit(d.VALUE_CHANGED,e)}var p,v,h,g="rooms-guests/desktop/ticker.dust",k=new o(d.VALUE_CHANGED);r&&"function"==typeof r||(r=function(t){return t}),s&&"function"==typeof s||(s=function(){return 0}),e=t(e),this.on=k.on.bind(k),this.off=k.off.bind(k);var m={topClass:i};n.render(g,m,e.get(0),function(){p=e.find(".plus-circle"),v=e.find(".minus-circle"),p.on("click",function(){u(1)}),v.on("click",function(){u(-1)}),l(s())}),this.setValue=l,this.destroy=f},h=function(t){var e=i.retrieve(t);return function(t){return e&&e.length>t&&t>=0?e[t]:""}},g={DropDownPicker:p,Ticker:v,createStoreValuesDecorator:h};return Object.freeze?g.EVENTS=Object.freeze(d):g.EVENTS=d,g});
require(["ta/prwidgets"],function(e){var r=e.define.bind(e,"ibex_trip_search_rooms_guests","pickers",["handlers","pickers"]);r(["lib/jquery-amd","ta/Core/TA.Store","hotels/RoomsGuests","hotels/RoomsGuestsUI","mixins/Events","common/trackingStreams"],function(e,r,t,n,o,i){function s(s,c){function a(){function o(e){return"string"==typeof e&&(e=parseInt(e,10),isNaN(e))?C:e<0?C:0===e?"0-1":e.toString()}function i(){for(var e=0;e<p.length;++e)p[e].hidePopup()}function s(s){var c=e("<span/>",{"class":"age-picker"});k.append(c);var a=new n.DropDownPicker(c.get(0),"",o,0,t.CONSTANTS.MAX_CHILD_AGE,{titleClass:"age-of-child",flexWidth:!0});p.push(a),c.css("order",s),a.on(n.EVENTS.VALUE_CHANGED,function(e){T.updateChildAge(s,e),V.emit("roomInfoChanged")}),a.on(n.EVENTS.WILL_OPEN,i);var l=r.retrieve("rgPicker.nAgeOfChildIndex"),g=l&&l.length>s+1?l[s+1]:"";a.setTitle(g)}function c(e,r){k.toggleClass("hidden",0===e.length);for(var t=0;t<e.length;++t)p.length<=t&&s(t),p[t].setValue(e[t]),e[t]>=0?p[t].toggleError(!1):r&&p[t].toggleError(!0);for(;p.length>e.length;)p.pop().destroy(!0)}return{createAgePickersWithAges:c}}function l(){for(var e=T.get().childrenAges,r=!1,t=0;t<e.length;++t)e[t]<0?(r=!0,p[t].toggleError(!0)):p[t].toggleError(!1);return V.emit("markErrors",r),!r}function g(e){E.setValue(e)}function u(e){N.setValue(e)}function d(e){a().createAgePickersWithAges(e),S.setValue(e.length);for(var r=!1,t=0;t<e.length;++t)e[t]<0&&(r=!0);r||V.emit("markErrors",r)}function h(){var e=T.get();E.setValue(e.nRooms),N.setValue(e.nAdults),S&&(S.setValue(e.childrenAges.length),a().createAgePickersWithAges(e.childrenAges))}function f(){l()&&V.emit("hide",!1)}function A(){k=e(".ages-wrap",m);var r=m.find(".childrenPlaceholder"),o=r.length>0;E=new n.Ticker(m.find(".roomsPlaceholder"),"rooms-picker",n.createStoreValuesDecorator("rgPicker.nRooms"),function(){return T.get().nRooms},t.CONSTANTS.MIN_ROOMS,t.CONSTANTS.MAX_ROOMS),E.on(n.EVENTS.VALUE_CHANGED,function(e){i.trackEvent("guestpicker","click","rooms"),T.update({nRooms:e}),V.emit("roomInfoChanged")}),N=new n.Ticker(m.find(".adultsPlaceholder"),"adults-picker",n.createStoreValuesDecorator(o?"rgPicker.nAdults":"rgPicker.nGuests"),function(){return T.get().nAdults},t.CONSTANTS.MIN_ADULTS,t.CONSTANTS.MAX_ADULTS),N.on(n.EVENTS.VALUE_CHANGED,function(e){i.trackEvent("guestpicker","click","adults"),T.update({nAdults:e}),V.emit("roomInfoChanged")}),o&&(C=m.find(".age-translated").text(),S=new n.Ticker(m.find(".childrenPlaceholder"),"children-picker",n.createStoreValuesDecorator("rgPicker.nChildren"),function(){return T.get().childrenAges.length},t.CONSTANTS.MIN_CHILDREN,t.CONSTANTS.MAX_CHILDREN),S.on(n.EVENTS.VALUE_CHANGED,function(e){i.trackEvent("guestpicker","click","children"),T.update({nChildren:e}),V.emit("roomInfoChanged")})),T.on(t.EVENTS.ROOMS_CHANGED,g),T.on(t.EVENTS.ADULTS_CHANGED,u),T.on(t.EVENTS.CHILDREN_CHANGED,d),m.find(".btn_close").on("click",f)}var E,N,S,k,C,T=s,m=c,p=[],V=new o("markErrors","hide");this.on=V.on.bind(V),this.off=V.off.bind(V),A(),this.verifyAgesOfChildren=l,this.setInitialState=h}return s})});
define("ta/util/Qualaroo",["vanillajs","ns-exporter","ta/util/Error","ta/util/Object"],function(k,o,d,j){var f={};var g=["//","while(true);","while(1);","for(;;);"],c="check",e="force";var p=function(s,r){d.record(s,r)};var b=function(v,t){var s,u,r;if(!v||!t){return false}if(t!=="json"&&t!=="jsonp"){return v}for(s=0;s<g.length;s++){u=g[s];r=v.indexOf(u);if(r===0){return v.substring(u.length)}}return v};var a=function(r){if(r){m("/CheckSurvey",h({key:r,action:"init"}))}else{p(null,"_initSurveyKey: No surveyKey to use as token for qualaroo survey display")}};var i=function(r){if(r){m("/CheckSurvey",h({key:r,action:"set"}))}else{p(null,"_setSurveyKey: No surveyKey to use as token for qualaroo survey display")}};var q=function(s,r){if(window._kiq){var t={name:s};if(r){t=j.merge(t,r)}if(ta.has("ta.qualaroo."+s)){t=j.merge(t,ta.retrieve("ta.qualaroo."+s))}window._kiq.push(["set",t])}};var l=function(u,t,v,r,s){return new Promise(function(x,w){if(u&&t&&r){m("/CheckSurvey",h({key:u,action:r,name:t}),function(z){var y=JSON.parse(z),A=y&&y.display==="true";if(A){if(v){window.parent.postMessage("loadQualarooSurvey","*");x()}else{if(window.loadQualarooSurvey){q(t,s);window.loadQualarooSurvey();x()}else{if(window._kiq){q(t,s);x()}else{p(null,"_conditionallyDisplaySurvey: window.loadQualarooSurvey is not defined, can't display survey");w()}}}}})}else{p(null,"_conditionallyDisplaySurvey: No surveyKey or surveyName or checkAction defined for qualaroo survey display");w()}})};var n=function(){if(typeof XMLHttpRequest!=="undefined"){return new XMLHttpRequest()}var r=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];var u=null;for(var s=0;s<r.length;s++){try{u=new ActiveXObject(r[s]);break}catch(t){}}return u};var m=function(s,v,u){var r=null;try{r=n()}catch(t){p(null,"ta.qualaroo._doGet: Unable to make request in _doGet");return}if(!r){p(null,"ta.qualaroo._doGet: Unable to make request in _doGet");return}r.open("GET",s+v,true);r.onreadystatechange=function(){if(r.readyState===4&&u){u(b(r.responseText,"json"))}};r.send(null)};var h=function(t){var s=[];for(var r in t){s.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]))}return"?"+s.join("&")};f.initSurvey=function(r){a(r)};f.cancelSurvey=function(r){i(r)};f.checkAndDisplaySurvey=function(s,r,t){return l(s,r,t,c,null)};f.forceDisplaySurvey=function(s,r,u,t){return l(s,r,u,e,t)};o.exportTo(f,"ta.qualaroo");return f});
require(["ta/p13n/placements"],function(a){var e=a.define.bind(a,"flights_home_qualaroo_surveys","handlers",["handlers"]);e(["placement","ta/util/Qualaroo","lib/jquery-amd","ta"],function(a,e,r,l){"use strict";if(l.qualaroo){var u="flights_home_lander_surveys",n="FLIGHTS_HOME_LANDER_SURVEYS";l.qualaroo.forceDisplaySurvey(u,n)}return{}})});
require(["ta/p13n/placements"],function(a){var e=a.define.bind(a,"qualaroo_survey","handlers",["handlers"]);e(["placement","ta/util/Qualaroo","lib/jquery-amd","ta","ta/Core/TA.Store","ta/Core/TA.LocalStorage","ta/Core/TA.Event","page-model","ta/util/RecordInterruption"],function(a,e,o,r,l,t,i,s,u){"use strict";function n(){if(r.localStorage&&r.localStorage.enabled){var a=r.localStorage.get("qualaroo-session-id"),e=s.session.sessionId;if(a&&a==e){var o=Number(r.localStorage.get("qualaroo-page-views"))+1;r.localStorage.set("qualaroo-page-views",o)}else r.localStorage.set("qualaroo-session-id",e),r.localStorage.set("qualaroo-page-views",1)}}function c(){return 0==Math.floor(2*Math.random())?"A":"B"}if(n(),r.qualaroo&&r.localStorage&&r.localStorage.enabled){var g=Number(r.localStorage.get("qualaroo-page-views"));if(2==g){var d="qualaroo_surveys_tv_ad_viewers",S="TV_AD_VIEWERS_QUALAROO_SURVEYS",v=s.session.uid,p=c();r.qualaroo.forceDisplaySurvey(d,S,!1,{identify:v,group:p}),u.record("popup","Qualaroo_Survey|"+window.pageServlet+"|"+S+"|"+p)}}return{}})});
require(["ta/p13n/placements"],function(n){var e=n.define.bind(n,"attractions_near_you_link","handler",["handler"]);e(["placement","ta/util/Element"],function(n,e){"use strict";e.trackWhenScrolledIntoView("#"+n.id,["rebrand_attractions_lander_near_you","in_view"])})});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"homepage_hero","handlers",["handlers"]);n(["placement"],function(e){"use strict";function n(e,n,r){require(["trjs!ta/Core/TA.Record"],function(t){t.setEvtCookie(window.pageServlet,e,n,0,r)})}return{clicked:n}})});
define("shelves/ShelfItemPricing",["lib/jquery-amd"],function(t){"use strict";function e(e,a,o){this.locationIds=e,this.visit_date=a,this.visit_length=parseInt(o)+1,this.poll_number=-1,this.last_received_seq=-1;var r="/data/1.0/shelves/price",l=require("page-model").JS_SECURITY_TOKEN;this.requestPricings=function(e){var a=function(){this.poll_number+=1,this.poll_number+1>=s||t.ajax({url:r,contentType:"application/json",method:"POST",type:"POST",data:JSON.stringify({data:[{"items":n(this.locationIds),"visit_date":this.visit_date,"visit_length":this.visit_length,"poll_number":this.poll_number}]}),context:this,beforeSend:function(t){t.setRequestHeader("X-Requested-By",l)}}).done(function(s){var n=s.data[0],o=[];t.each(n.items,function(t,e){"IN_PROGRESS"===e.pricing_status&&o.push(e.location_id)}),this.last_received_seq<n.poll_number&&(this.last_received_seq=n.poll_number,this.locationIds=o,e(n,this.last_received_seq)),o.length>0&&setTimeout(a,i)})}.bind(this);a()}}var i=1500,s=10,n=function(e){return t.map(e,function(t){return{"id":t,"location_id":t}})};return e});
require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"homepage_shelves","handlers",["handlers"]);e(["placement","ta","ta/Core/TA.Event","ta/Core/TA.Record","lib/jquery-amd","shelves/ShelfItemPricing"],function(t,e,i,n,a,r){function c(t){return t&&t.getAttribute&&!!t.getAttribute("data-tpp")}function o(t){return c(t)?{"property":t.getAttribute("data-tpp"),"action":t.getAttribute("data-tpact"),"attrib":t.getAttribute("data-tpatt"),"pid":t.getAttribute("data-tpid")}:null}function u(t){return/\/Recent$/.test(t.href)?"/Saves":t.href}function s(t,e){var i=o(e),a=u(e);i&&e.href&&n.setEvtCookie(i.property,i.action,i.attrib,i.pid,a)}function h(){var t=[],e={},i=a(".travel_info"),n=i.data("visitdate"),r=i.data("visitlength");n&&r&&a(".poi.hac_item").each(function(){var i=a(this).data("locationid");e[i]||(t.push(i),e[i]=!0)}),t.length>0&&p(t,n,r)}function p(t,e,i){var n=new r(t,e,i);n.requestPricings(function(t,e){for(var i=t.items,n=0;n<i.length;n++){var r=i[n],c=r.location_id,o=r.pricing_string,u=r.pricing_status;a(".hac_item .hac_"+c).each(function(){"COMPLETED"===u&&(a(this).find("span").html(o+"*"),a(this).show())})}})}i.on("track_shelf_see_all_click_event",function(t,e){s(t,e)}),h()})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"other_hotel_categories","handlers",["handlers"]);a(["placement","lib/jquery-amd"],function(e,a){function t(e){var t=a(e),n=t.find(".ui_icon");n.is(":hidden")||(n.hasClass("caret-down")?(n.removeClass("caret-down").addClass("caret-up"),t.addClass("expanded"),t.nextUntil(".sectionTitle").addClass("expanded")):n.hasClass("caret-up")&&(n.removeClass("caret-up").addClass("caret-down"),t.removeClass("expanded"),t.nextUntil(".sectionTitle").removeClass("expanded")))}return function(){var e=a("h3.filterLanderHeader"),t=e.parent().prev(),n=null;if(t.find("ul.flexCols > li.item").each(function(e,t){var s=a(t);(null===n||s.offset().top>n.offset().top)&&(n=s)}),null!==n){var s=t.offset().top+t.outerHeight()-(n.offset().top+n.outerHeight()),l=46;s>0&&s<=l&&e.css("margin-top","-="+s)}}(),{toggleCollapsible:t}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"popular_cuisines","handlers",["handlers"]);a(["placement","lib/jquery-amd"],function(e,a){function n(e){var n=a(e),s=n.find(".ui_icon");s.is(":hidden")||(s.hasClass("caret-down")?(s.removeClass("caret-down").addClass("caret-up"),n.addClass("expanded"),n.nextUntil(".sectionTitle").addClass("expanded")):s.hasClass("caret-up")&&(s.removeClass("caret-up").addClass("caret-down"),n.removeClass("expanded"),n.nextUntil(".sectionTitle").removeClass("expanded")))}return{toggleCollapsible:n}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"popular_destinations","handlers",["handlers"]);a(["placement","lib/jquery-amd"],function(e,a){"use strict";function n(e,n){var s=a(e),d=s.find(".ui_icon");d.is(":hidden")||(d.hasClass("caret-down")?(d.removeClass("caret-down").addClass("caret-up"),s.addClass("expanded"),n?s.parent().find(".item").addClass("expanded"):s.nextUntil(".sectionTitle").addClass("expanded")):d.hasClass("caret-up")&&(d.removeClass("caret-up").addClass("caret-down"),s.removeClass("expanded"),n?s.parent().find(".item").removeClass("expanded"):s.nextUntil(".sectionTitle").removeClass("expanded")))}function s(e){a(e).parents(".section").toggleClass("expanded")}return{toggleCollapsible:n,toggleMore:s}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"popular_hotels","handlers",["handlers"]);a(["placement","lib/jquery-amd"],function(e,a){function n(e){var n=a(e),s=n.find(".ui_icon");s.is(":hidden")||(s.hasClass("caret-down")?(s.removeClass("caret-down").addClass("caret-up"),n.addClass("expanded"),n.nextUntil(".sectionTitle").addClass("expanded")):s.hasClass("caret-up")&&(s.removeClass("caret-up").addClass("caret-down"),n.removeClass("expanded"),n.nextUntil(".sectionTitle").removeClass("expanded")))}return{toggleCollapsible:n}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"popular_vacation_rentals","handlers",["handlers"]);a(["placement","lib/jquery-amd","ta/Core/TA.Record"],function(e,a,n){function s(e){var n=a(e),s=n.find(".ui_icon");s.is(":hidden")||(s.hasClass("caret-down")?(s.removeClass("caret-down").addClass("caret-up"),n.addClass("expanded"),n.nextUntil(".sectionTitle").addClass("expanded")):s.hasClass("caret-up")&&(s.removeClass("caret-up").addClass("caret-down"),n.removeClass("expanded"),n.nextUntil(".sectionTitle").removeClass("expanded")))}return{toggleCollapsible:s,trackCityClick:n.trackEventOnPage}})});
require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"top_restaurants_near","handlers",["handlers"]);e(["placement","ta","ta/Core/TA.Event","ta/Core/TA.Record"],function(t,e,r,a){function n(t){return t&&t.getAttribute&&!!t.getAttribute("data-tpp")}function i(t){return n(t)?{"property":t.getAttribute("data-tpp"),"action":t.getAttribute("data-tpact"),"attrib":t.getAttribute("data-tpatt"),"pid":t.getAttribute("data-tpid")}:null}function p(t,e){var r=i(e);r&&e.href&&a.setEvtCookie(r.property,r.action,r.attrib,r.pid,e.href)}return{trackShelfSeeAllClick:p}})});
require(["ta/p13n/placements"],function(n){var e=n.define.bind(n,"vr_lander_blog_link","handlers",["handlers"]);e(["placement","ta/Core/TA.Record","vanillajs"],function(n,e,a){return{trackBlogClick:e.trackEventOnPage}})});
require(["ta/p13n/placements"],function(n){var e=n.define.bind(n,"vr_lander_popular_destinations","handlers",["handlers"]);e(["placement","ta/Core/TA.Record","vanillajs"],function(n,e,a){return{trackCardClick:e.trackEventOnPage}})});
define("utils/cookieutils",["vanillajs","utils/ajax"],function(t,o){"use strict";var e=function(t){return"undefined"!=typeof t&&null!==t},n=function(t){return t.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},i=function(){var t=window.location.host.match(/\.tripadvisor\..*/);return null!=t?t=t[0]:null},a=function(t,o,n){if(e(n.doNotEscape)&&n.doNotEscape||(o=encodeURIComponent(o)),o+=n.domain?"; domain="+n.domain:"; domain="+i(),n.path&&(o+="; path="+n.path),n.duration){var a=new Date;a.setTime(a.getTime()+1e3*n.duration),o+="; expires="+a.toGMTString()}n.secure&&(o+="; secure");var r="%1%";e(n.ignoreVersion)&&n.ignoreVersion&&(r=""),document.cookie=t+"="+r+o};return{addPidToCookie:function(t){e(t)&&0!==t.length&&a("NPID",t,{path:"/",duration:5,ignoreVersion:!0})},roybatty:function(){var t,e=i(),n=window.taSecureToken;if(window.taEarlyRoyBattyStatus)window.taEarlyRoyBattyStatus>1&&ta&&ta.trackEventOnPage&&ta.trackEventOnPage("early_roy_batty","confirm","",0,!0);else if(t=this.getCookie("roybatty")){var a=t.split(",");if(a&&2==a.length){var r=parseInt(a[1],10);document.setCookie("roybatty",n+","+r,{domain:e,ignoreVersion:!0,path:"/"})}}else document.setCookie("roybatty",n+",1",{domain:e,ignoreVersion:!0,path:"/"}),o({type:"POST",url:"/CookiePingback"})},getCookie:function(t){var o=document.cookie.match("(?:^|;)\\s*"+n(t)+"=([^;]*)");return o?(o=o[1],0===o.indexOf("%1%")&&(o=o.substring(3)),decodeURIComponent(o)):null},setCookieInSeconds:a}});
define("vr/shared/utility",["ta","utils/cookieutils","utils/ajax","utils/store","utils/objutils","utils/decoder"],function(e,t,o,n,d,a){"use strict";var i=function(){},r=function(t){if(!t)return t;switch(typeof t){case"object":t.puid=e.uid;break;case"string":t+="&puid="+e.uid}return t},l=function(e){var t="VR_",o=e&&e.length>=t.length&&e.substring(0,3)===t;return o?e:t+e},c=function(e,t,o){var d=r({});"/ActionRecord?action="+l(e);return d.action=l(e),"undefined"!=typeof modelGeoId&&null!=modelGeoId&&""!=modelGeoId?d.geo=modelGeoId:n.has("ftl.geoId")&&n.get("ftl.geoId")&&(d.geo=n.get("ftl.geoId")),t&&t>0&&(d.pid=t),o&&o>0?d.detail=o:"undefined"!=typeof modelLocId&&null!=modelLocId&&""!=modelLocId?d.detail=modelLocId:n.has("ftl.locId")&&n.get("ftl.locId")&&(d.detail=n.get("ftl.locId")),d},u=function(e,t,n,d){var a=c(e,t,n);o({url:"/ActionRecord",data:a,method:"GET",success:d?d:i})},s=function(){return document.getElementsByTagName("body")[0].getAttribute("data-partner-tracking-prefix")},y=function(e){if(e){var t=e.innerHTML,o=f(t);if(!o)return!1;e.innerHTML=o,e.style.display="block";var n=document.getElementById("payment-count-vehicle").dataset.content,d=n.replace(t,o);return document.getElementById("payment-count-vehicle").dataset.content=d,!0}return!1},f=function(e){var t=a.base64Decoder(e);return t.split("_")[1]};return{actionRecord:u,actionRecordWithPartner:function(e,t,o,n){var d=s(),a=""!=d&&"undefined"!=typeof d?d+"_"+e:e;u(a,t,o,n)},preventEventBubble:function(e){e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},splitName:function(e){var t=void 0;if("string"==typeof e){var o=e.trim().split(" ");o.length>1&&(t={first:o.slice(0,o.length-1).join(" "),last:o[o.length-1]})}return t},goToUrl:function(e,o,n){e&&e.trim()&&(o&&o>0&&t.addPidToCookie(o),n?window.open(e):window.location=e)},addLocationAsReviewedInMemCachedCookie:function(e,t){var n="WAR_ADD_REVIEWED_LOCATION";o({url:"/VacationRentalsAjax",data:{"a":n,"locationId":e},method:"get",complete:t?t:i})},addPuid:r,identify:function(e,t){var o=0;return e&&e.length?d.each(e,function(e,n){if(!n.getAttribute("id")){do{o++;var d=t+"_"+o}while(null!=document.getElementById(d));n.setAttribute("id",d)}}):e},allowIfNumber:function(){var e={backspace:8,tab:9,pageDown:34,downArrow:40,deleteKey:46,slash:47,colon:58,aKey:65,cKey:67,vKey:86,xKey:88,sleep:95,numPadStar:106};return function(t){e.slash<t.keyCode&&t.keyCode<e.colon&&!t.shiftKey&&!t.altKey||e.sleep<t.keyCode&&t.keyCode<e.numPadStar||t.keyCode==e.backspace||t.keyCode==e.tab||t.keyCode>e.pageDown&&t.keyCode<e.downArrow||t.keyCode==e.aKey&&t.metaKey||t.keyCode==e.cKey&&t.metaKey||t.keyCode==e.vKey&&t.metaKey||t.keyCode==e.xKey&&t.metaKey||t.keyCode==e.deleteKey||t.preventDefault()}}(),unobfuscatePaymentCount:y}});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"vr_list_your_property","handlers",["handlers"]);t(["placement","api-mod","vr/shared/utility","ta/Core/TA.Record","vanillajs"],function(e,t,n,r,i){var a=t.find(".get_listed_button_container"),o=t.retrieve(a,"url");return t.addEvent(a,"click",function(){n.actionRecord("GetListed_Lander","","",n.goToUrl(o))}),{trackListingButtonClick:r.trackEventOnPage}})});
